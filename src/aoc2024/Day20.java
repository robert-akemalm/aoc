package aoc2024;

import java.util.Comparator;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Map.Entry;
import java.util.PriorityQueue;
import java.util.Set;

import aoc2024.Util.Pos;

public class Day20 {
    private static void a(Input input) {
        char[][] map = input.map;
        int minSteps = minStepsToExit(map, input.start);
        int numCheatsBetterThan100 = 0;
        int numCheatsBetterThan10 = 0;
        for (int y = 1; y < map.length - 1; y++) {
            for (int x = 1; x < map.length - 1; x++) {
                if (map[y][x] == '#') {
                    map[y][x] = '.';
                    int cheatSteps = minStepsToExit(map, input.start);
                    map[y][x] = '#';
                    if (minSteps - cheatSteps >= 100) {
                        numCheatsBetterThan100++;
                    }
                    if (minSteps - cheatSteps >= 10) {
                        numCheatsBetterThan10++;
                    }
                }
            }
        }
        System.out.println("10: " + numCheatsBetterThan10);
        System.out.println("100: " + numCheatsBetterThan100);
    }

    private record State(Pos pos, int steps) {}

    private static int minStepsToExit(char[][] map, Pos start) {
        PriorityQueue<State> toExplore = new PriorityQueue<>(Comparator.comparingInt(State::steps));
        toExplore.add(new State(start, 0));
        Set<Pos> seen = new HashSet<>();
        while (!toExplore.isEmpty()) {
            State state = toExplore.poll();
            if (map[state.pos.y()][state.pos.x()] == 'E') {
                return state.steps();
            }
            if (seen.add(state.pos())) {
                state.pos.neighbours().stream()
                         .filter(n -> 0 < n.x() && n.x() < map[0].length)
                         .filter(n -> 0 < n.y() && n.y() < map.length)
                         .filter(n -> map[n.y()][n.x()] != '#')
                         .forEach(n -> toExplore.add(new State(n, state.steps() + 1)));
            }
        }
        return -1;
    }

    private static void b(Input input) {
        char[][] map = input.map;
        Map<Pos, Integer> distanceToEnd = new HashMap<>();
        for (int y = 0; y < map.length; y++) {
            for (int x = 0; x < map[y].length; x++) {
                if (map[y][x] != '#') {
                    Pos pos = new Pos(x, y);
                    distanceToEnd.put(pos, minStepsToExit(map, pos));
                }
            }
        }
        int numCheatsBetterThan50 = 0;
        int numCheatsBetterThan100 = 0;
        for (Entry<Pos, Integer> startOfCheat : distanceToEnd.entrySet()) {
            for (Entry<Pos, Integer> endOfCheat : distanceToEnd.entrySet()) {
                int distance = endOfCheat.getKey().manhattanDistanceTo(startOfCheat.getKey());
                int distanceDiff = startOfCheat.getValue() - endOfCheat.getValue();
                if (distance <= 20 && distanceDiff - distance >= 100) {
                    numCheatsBetterThan100++;
                }
                if (distance <= 20 && distanceDiff - distance >= 50) {
                    numCheatsBetterThan50++;
                }
            }
        }

        System.out.println("50: " + numCheatsBetterThan50);
        System.out.println("100: " + numCheatsBetterThan100);
    }

    record Input(char[][] map, Pos start, Pos end) {
        static Input parse(String input) {
            char[][] map = input.lines().map(String::toCharArray).toArray(char[][]::new);
            Pos start = null;
            Pos end = null;
            for (int y = 0; y < map.length; y++) {
                for (int x = 0; x < map[y].length; x++) {
                    if (map[y][x] == 'S') {
                        start = new Pos(x, y);
                    }
                    if (map[y][x] == 'E') {
                        end = new Pos(x, y);
                    }
                }
            }
            return new Input(map, start, end);
        }

    }

    private static final String TEST_INPUT =   "###############\n"
                                             + "#...#...#.....#\n"
                                             + "#.#.#.#.#.###.#\n"
                                             + "#S#...#.#.#...#\n"
                                             + "#######.#.#.###\n"
                                             + "#######.#.#...#\n"
                                             + "#######.#.###.#\n"
                                             + "###..E#...#...#\n"
                                             + "###.#######.###\n"
                                             + "#...###...#...#\n"
                                             + "#.#####.#.###.#\n"
                                             + "#.#...#.#.#...#\n"
                                             + "#.#.#.#.#.#.###\n"
                                             + "#...#...#...###\n"
                                             + "###############";

    private static final String INPUT =
            "#############################################################################################################################################\n"
            + "#...#...#...#...#...#.....###...###...#...#.....#...#...#...###...#...........#...###.....#...#.........#...#.....#.....#...#.....###...#...#\n"
            + "#.#.#.#.#.#.#.#.#.#.#.###.###.#.###.#.#.#.#.###.#.#.#.#.#.#.###.#.#.#########.#.#.###.###.#.#.#.#######.#.#.#.###.#.###.#.#.#.###.###.#.#.#.#\n"
            + "#.#.#.#.#.#.#.#.#.#.#.#...#...#.....#.#.#.#...#...#.#.#.#.#...#.#.#.#.........#.#...#.#...#.#...#.......#.#.#.#...#...#.#.#.#...#.....#...#.#\n"
            + "#.#.#.#.#.#.#.#.#.#.#.#.###.#########.#.#.###.#####.#.#.#.###.#.#.#.#.#########.###.#.#.###.#####.#######.#.#.#.#####.#.#.#.###.###########.#\n"
            + "#.#...#...#.#.#...#.#.#...#.........#.#.#...#.....#.#.#.#.#...#.#.#.#.###...###.#...#.#...#.#.....#.....#.#.#.#.#####.#.#.#...#.#...........#\n"
            + "#.#########.#.#####.#.###.#########.#.#.###.#####.#.#.#.#.#.###.#.#.#.###.#.###.#.###.###.#.#.#####.###.#.#.#.#.#####.#.#.###.#.#.###########\n"
            + "#.#...#...#.#.#...#.#.#...#...#...#.#.#.#...###...#.#.#...#.#...#.#.#...#.#.#...#...#...#.#.#.#...#...#.#.#.#.#...#...#.#.#...#.#.###...#...#\n"
            + "#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.###.#.#####.#.###.#.###.#.#.#.#####.###.#.#.#.#.#.###.#.#.#.#.###.#.###.#.#.###.#.###.#.#.#.#\n"
            + "#.#.#...#.#.#.#.#...#.#.#...#.#.#.#.#...#.#...#...#.#.....#.#...#...#...#.#...#.....#...#.#.#.#.#.#...#...#.#...#.#...#.#.#.#...#...#.#.#.#.#\n"
            + "#.#.#####.#.#.#.#####.#.#.###.#.#.#.#####.#.#.###.#.#####.#.###.#####.###.#####.#####.###.#.#.#.#.#.#######.###.#.###.#.#.#.#.#####.#.#.#.#.#\n"
            + "#.#.#.....#...#...#...#.#...#.#.#.#.#.....#.#.#...#...#...#...#.....#...#.....#.#...#...#...#.#.#...#.......###.#.#...#...#...#...#...#...#.#\n"
            + "#.#.#.###########.#.###.###.#.#.#.#.#.#####.#.#.#####.#.#####.#####.###.#####.#.#.#.###.#####.#.#####.#########.#.#.###########.#.#########.#\n"
            + "#...#...........#.#.#...#...#...#...#...###.#.#...#...#.....#.#.....#...#.....#.#.#.....#.....#.....#.......#...#.#.#...#...#...#...........#\n"
            + "###############.#.#.#.###.#############.###.#.###.#.#######.#.#.#####.###.#####.#.#######.#########.#######.#.###.#.#.#.#.#.#.###############\n"
            + "#...###.........#.#.#...#.......#.....#.....#.#...#.....#...#.#.....#.###.....#...#.......#...#...#.#.......#...#.#.#.#...#.#...###...#...###\n"
            + "#.#.###.#########.#.###.#######.#.###.#######.#.#######.#.###.#####.#.#######.#####.#######.#.#.#.#.#.#########.#.#.#.#####.###.###.#.#.#.###\n"
            + "#.#...#.........#.#...#.#.....#...###.......#.#.#.......#...#.....#.#...#...#.....#.......#.#.#.#.#.#...#.....#.#...#.....#.....#...#...#...#\n"
            + "#.###.#########.#.###.#.#.###.#############.#.#.#.#########.#####.#.###.#.#.#####.#######.#.#.#.#.#.###.#.###.#.#########.#######.#########.#\n"
            + "#...#.#...#...#.#.###.#.#...#.#...###...#...#...#...#...###.....#...#...#.#...#...#.......#.#...#.#...#.#...#.#...#.......#...#...#.........#\n"
            + "###.#.#.#.#.#.#.#.###.#.###.#.#.#.###.#.#.#########.#.#.#######.#####.###.###.#.###.#######.#####.###.#.###.#.###.#.#######.#.#.###.#########\n"
            + "#...#...#.#.#...#...#.#.#...#.#.#.#...#.#.......#...#.#...#.....#.....###...#...#...#...###.#.....###.#.###.#.#...#.#...###.#.#.#...#...#...#\n"
            + "#.#######.#.#######.#.#.#.###.#.#.#.###.#######.#.###.###.#.#####.#########.#####.###.#.###.#.#######.#.###.#.#.###.#.#.###.#.#.#.###.#.#.#.#\n"
            + "#.#.....#.#.......#...#.#...#.#.#.#.#...#.......#...#.#...#.....#.#.....###...#...#...#.....#.#.....#.#.#...#.#...#...#.#...#...#.....#...#.#\n"
            + "#.#.###.#.#######.#####.###.#.#.#.#.#.###.#########.#.#.#######.#.#.###.#####.#.###.#########.#.###.#.#.#.###.###.#####.#.#################.#\n"
            + "#.#.#...#.....###.....#.###.#.#.#.#.#.###.......#...#.#...#.....#.#.#...#...#.#...#.....#.....#...#.#.#.#...#.#...#.....#.#.........#...#...#\n"
            + "#.#.#.#######.#######.#.###.#.#.#.#.#.#########.#.###.###.#.#####.#.#.###.#.#.###.#####.#.#######.#.#.#.###.#.#.###.#####.#.#######.#.#.#.###\n"
            + "#.#.#.......#.#.....#.#.#...#.#.#.#.#.#...###...#.###.#...#.....#...#...#.#.#.#...#...#.#.#...#...#...#...#.#...#...#.....#.......#.#.#.#...#\n"
            + "#.#.#######.#.#.###.#.#.#.###.#.#.#.#.#.#.###.###.###.#.#######.#######.#.#.#.#.###.#.#.#.#.#.#.#########.#.#####.###.###########.#.#.#.###.#\n"
            + "#.#.###...#.#.#.#...#.#...#...#.#.#.#.#.#.#...#...#...#.#...#...#.......#.#.#.#.###.#.#.#.#.#.#.........#...#...#.....#.....#.....#...#...#.#\n"
            + "#.#.###.#.#.#.#.#.###.#####.###.#.#.#.#.#.#.###.###.###.#.#.#.###.#######.#.#.#.###.#.#.#.#.#.#########.#####.#.#######.###.#.###########.#.#\n"
            + "#.#.#...#...#...#...#.....#.#...#.#.#.#.#.#...#...#.#...#.#...#...#.....#.#.#.#...#.#.#.#.#.#.#.....#...#.....#...#.....###.#...........#...#\n"
            + "#.#.#.#############.#####.#.#.###.#.#.#.#.###.###.#.#.###.#####.###.###.#.#.#.###.#.#.#.#.#.#.#.###.#.###.#######.#.#######.###########.#####\n"
            + "#.#.#...#.......#...#...#.#.#...#.#.#.#.#.###...#.#.#.###.....#.###...#.#.#.#.#...#.#.#.#.#.#.#...#.#...#...#...#...#.....#.#...#.......#...#\n"
            + "#.#.###.#.#####.#.###.#.#.#.###.#.#.#.#.#.#####.#.#.#.#######.#.#####.#.#.#.#.#.###.#.#.#.#.#.###.#.###.###.#.#.#####.###.#.#.#.#.#######.#.#\n"
            + "#.#.###...#.....#.....#...#.....#...#.#.#...#...#.#.#.#...#...#.#...#.#.#.#...#...#.#.#.#.#.#...#.#.#...#...#.#.#...#...#.#...#...#.......#.#\n"
            + "#.#.#######.#########################.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.#######.#.#.#.#.#.###.#.#.#.###.###.#.#.#.###.#.#########.#######.#\n"
            + "#.#.#.......#.....#...#...#.....#...#...###.#.###.#.#.#.#...###.#.#.#.#.#.....#...#.#...#.#.#...#.#.#.###.....#...#.#...#...#.....#...#.....#\n"
            + "#.#.#.#######.###.#.#.#.#.#.###.#.#.#######.#.###.#.#.#.#######.#.#.#.#.#####.#.###.#####.#.#.###.#.#.#############.#.#####.#.###.###.#.#####\n"
            + "#...#.........###...#...#...###...#.......#.#...#.#.#.#.....#...#.#...#.#...#.#...#...#...#.#.....#...#.............#.#.....#.#...#...#.....#\n"
            + "#########################################.#.###.#.#.#.#####.#.###.#####.#.#.#.###.###.#.###.###########.#############.#.#####.#.###.#######.#\n"
            + "#.........................#...............#.....#...#.#.....#...#.....#.#.#.#.#...#...#...#...#.......#...............#...#...#...#.#.......#\n"
            + "#.#######################.#.#########################.#.#######.#####.#.#.#.#.#.###.#####.###.#.#####.###################.#.#####.#.#.#######\n"
            + "#.......#...#...#.......#.#.#.................#.......#.......#.#...#.#.#.#.#.#...#.#...#.#...#.#...#...........#...#...#...#...#...#.......#\n"
            + "#######.#.#.#.#.#.#####.#.#.#.###############.#.#############.#.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.#.###########.#.#.#.#.#####.#.###########.#\n"
            + "#...###...#...#.#.#...#.#.#...#.........#.....#.....#.........#.#.#...#.#.#...#...#...#.#.#...#...#.......#...#...#.#.#.#.....#...........#.#\n"
            + "#.#.###########.#.#.#.#.#.#####.#######.#.#########.#.#########.#.#####.#.#####.#######.#.###.###########.#.#.#####.#.#.#.###############.#.#\n"
            + "#.#.#...#.......#.#.#...#.......#.....#.#.....#.....#.......#...#.#.....#...#...#.....#.#.#...#.....#...#...#.....#.#.#.#.............#...#.#\n"
            + "#.#.#.#.#.#######.#.#############.###.#.#####.#.###########.#.###.#.#######.#.###.###.#.#.#.###.###.#.#.#########.#.#.#.#############.#.###.#\n"
            + "#.#...#.#.........#.#...#.........#...#.......#.....#...#...#.#...#...###E#.#...#...#.#.#...###...#.#.#.....#.....#...#.........#...#.#...#.#\n"
            + "#.#####.###########.#.#.#.#########.###############.#.#.#.###.#.#####.###.#.###.###.#.#.#########.#.#.#####.#.#################.#.#.#.###.#.#\n"
            + "#...#...#...#.......#.#.#.#.........#...#...#...#...#.#.#...#.#.#.....###.#.#...#...#...#...#...#.#...#...#...#...#...#.......#.#.#...###...#\n"
            + "###.#.###.#.#.#######.#.#.#.#########.#.#.#.#.#.#.###.#.###.#.#.#.#######.#.#.###.#######.#.#.#.#.#####.#.#####.#.#.#.#.#####.#.#.###########\n"
            + "#...#.#...#...#.......#.#.#...........#...#...#.#...#.#.#...#.#.#.#...###.#.#...#.#.......#...#...#.....#.......#...#...#.....#.#...........#\n"
            + "#.###.#.#######.#######.#.#####################.###.#.#.#.###.#.#.#.#.###.#.###.#.#.###############.#####################.#####.###########.#\n"
            + "#...#.#.........#...###...#.......#...#.........###.#.#.#.###.#.#...#.###...###...#...#.......#.....#.......#.............###...#.....#.....#\n"
            + "###.#.###########.#.#######.#####.#.#.#.###########.#.#.#.###.#.#####.###############.#.#####.#.#####.#####.#.###############.###.###.#.#####\n"
            + "#...#.#.........#.#.#...###.....#.#.#.#...........#.#.#.#...#.#.#.....#########...###...#...#...#...#.....#...#...###...#...#.....###...#...#\n"
            + "#.###.#.#######.#.#.#.#.#######.#.#.#.###########.#.#.#.###.#.#.#.#############.#.#######.#.#####.#.#####.#####.#.###.#.#.#.#############.#.#\n"
            + "#...#.#...#...#...#.#.#.#.....#.#...#.........#...#...#.#...#.#.#.###########...#...#.....#.......#.....#.......#.....#...#...............#.#\n"
            + "###.#.###.#.#.#####.#.#.#.###.#.#############.#.#######.#.###.#.#.###########.#####.#.#################.###################################.#\n"
            + "#...#...#...#.....#.#.#.#...#.#.............#.#.###...#...#...#.#.###########.....#.#.......#.........#.#.........#.........................#\n"
            + "#.#####.#########.#.#.#.###.#.#############.#.#.###.#.#####.###.#.###############.#.#######.#.#######.#.#.#######.#.#########################\n"
            + "#.#...#...#.......#.#.#.#...#...........#...#.#.....#.....#...#.#.###########.....#...#.....#.###.....#...#...###...#.......#...#...###...###\n"
            + "#.#.#.###.#.#######.#.#.#.#############.#.###.###########.###.#.#.###########.#######.#.#####.###.#########.#.#######.#####.#.#.#.#.###.#.###\n"
            + "#...#...#.#.......#...#...#...........#.#...#.#.....#...#...#.#.#.###########.....#...#.....#...#.#...#...#.#.#.....#.#...#...#...#.....#...#\n"
            + "#######.#.#######.#########.#########.#.###.#.#.###.#.#.###.#.#.#.###############.#.#######.###.#.#.#.#.#.#.#.#.###.#.#.#.#################.#\n"
            + "#...#...#.........#...#...#.#.........#.....#.#...#.#.#.#...#.#.#.#####...........#.....###.....#.#.#...#...#.#.#...#.#.#...........#...#...#\n"
            + "#.#.#.#############.#.#.#.#.#.###############.###.#.#.#.#.###.#.#.#####.###############.#########.#.#########.#.#.###.#.###########.#.#.#.###\n"
            + "#.#.#.....#...#.....#.#.#.#.#.#.............#.#...#...#...###.#.#S#####...............#...#.....#...#...#.....#.#.....#...........#.#.#.#...#\n"
            + "#.#.#####.#.#.#.#####.#.#.#.#.#.###########.#.#.#############.#.#####################.###.#.###.#####.#.#.#####.#################.#.#.#.###.#\n"
            + "#.#.......#.#.#.#.....#.#.#.#.#.#...........#...#...#...#...#...#.....###...###...###...#.#...#.#...#.#...#...#.#.............#...#.#.#...#.#\n"
            + "#.#########.#.#.#.#####.#.#.#.#.#.###############.#.#.#.#.#.#####.###.###.#.###.#.#####.#.###.#.#.#.#.#####.#.#.#.###########.#.###.#.###.#.#\n"
            + "#.........#.#...#.......#...#...#.................#.#.#...#...###...#.#...#.#...#.......#.#...#...#...#.....#...#.#.........#...###...###...#\n"
            + "#########.#.#######################################.#.#######.#####.#.#.###.#.###########.#.###########.#########.#.#######.#################\n"
            + "#...###...#.#...............#...........#...........#.#.......#...#.#.#...#.#.....#.....#.#.............#...#...#...#...#...###...#.........#\n"
            + "#.#.###.###.#.#############.#.#########.#.###########.#.#######.#.#.#.###.#.#####.#.###.#.###############.#.#.#.#####.#.#.#####.#.#.#######.#\n"
            + "#.#.....#...#.....#...#...#...#.....###...#.........#.#.....###.#.#.#.....#...###.#...#.#.......#.........#...#.#.....#...#...#.#.#...#...#.#\n"
            + "#.#######.#######.#.#.#.#.#####.###.#######.#######.#.#####.###.#.#.#########.###.###.#.#######.#.#############.#.#########.#.#.#.###.#.#.#.#\n"
            + "#.#...#...#.......#.#...#.......#...#.......#.....#...#.....#...#...#...#...#.#...#...#...#...#...#...#.....#...#...........#...#.###.#.#...#\n"
            + "#.#.#.#.###.#######.#############.###.#######.###.#####.#####.#######.#.#.#.#.#.###.#####.#.#.#####.#.#.###.#.###################.###.#.#####\n"
            + "#.#.#...###.........#.....#...###...#.#.......###.......#...#.........#...#.#.#.#...#...#...#.#...#.#...#...#.#.....#.......#...#.....#.....#\n"
            + "#.#.#################.###.#.#.#####.#.#.#################.#.###############.#.#.#.###.#.#####.#.#.#.#####.###.#.###.#.#####.#.#.###########.#\n"
            + "#...#.........###...#...#...#.....#...#.............#.....#.#...#...###...#.#.#...###.#...#...#.#.#.#.....###...#...#...###...#.....#.......#\n"
            + "#####.#######.###.#.###.#########.#################.#.#####.#.#.#.#.###.#.#.#.#######.###.#.###.#.#.#.###########.#####.###########.#.#######\n"
            + "#...#.......#.....#.#...#...#...#.#...#...#.........#.#.....#.#.#.#...#.#...#.......#.#...#.....#...#.........###.......#...###...#...###...#\n"
            + "#.#.#######.#######.#.###.#.#.#.#.#.#.#.#.#.#########.#.#####.#.#.###.#.###########.#.#.#####################.###########.#.###.#.#######.#.#\n"
            + "#.#.#...###.......#.#.....#...#.#...#...#...#...#...#.#.#...#.#.#...#.#...#.........#.#.#...#...............#.......#...#.#.#...#...#...#.#.#\n"
            + "#.#.#.#.#########.#.###########.#############.#.#.#.#.#.#.#.#.#.###.#.###.#.#########.#.#.#.#.#############.#######.#.#.#.#.#.#####.#.#.#.#.#\n"
            + "#.#.#.#.#...#...#.#...#.....###...........###.#.#.#.#.#.#.#.#.#...#.#.###.#.....#...#.#.#.#.#.............#.........#.#.#.#.#.#.....#.#...#.#\n"
            + "#.#.#.#.#.#.#.#.#.###.#.###.#############.###.#.#.#.#.#.#.#.#.###.#.#.###.#####.#.#.#.#.#.#.#############.###########.#.#.#.#.#.#####.#####.#\n"
            + "#.#.#.#.#.#.#.#...#...#...#.#.............#...#...#.#.#...#.#.#...#.#.#...#.....#.#.#.#...#...........#...#...#...###.#.#.#...#.......#.....#\n"
            + "#.#.#.#.#.#.#.#####.#####.#.#.#############.#######.#.#####.#.#.###.#.#.###.#####.#.#.###############.#.###.#.#.#.###.#.#.#############.#####\n"
            + "#.#.#.#.#.#.#.....#.#...#.#...#...........#...#...#.#.#...#...#...#.#.#...#.#...#.#.#.#...#.........#.#.....#...#.....#...#...#.........#...#\n"
            + "#.#.#.#.#.#.#####.#.#.#.#.#####.#########.###.#.#.#.#.#.#.#######.#.#.###.#.#.#.#.#.#.#.#.#.#######.#.#####################.#.#.#########.#.#\n"
            + "#.#...#...#.....#.#...#...#...#.###.......#...#.#...#...#.#...#...#.#.#...#.#.#.#.#.#...#...#.....#.#.......................#.#.#.......#.#.#\n"
            + "#.#############.#.#########.#.#.###.#######.###.#########.#.#.#.###.#.#.###.#.#.#.#.#########.###.#.#########################.#.#.#####.#.#.#\n"
            + "#.#...#...#...#...#...#...#.#.#.#...#...###...#...#.....#.#.#...#...#.#...#.#.#...#...#.....#...#.#...............#.........#.#...#.....#.#.#\n"
            + "#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.###.#.#####.###.#.###.#.#.#####.###.###.#.#.#######.#.###.###.#.###############.#.#######.#.#####.#####.#.#\n"
            + "#.#.#.#.#...#.....#.#.#.#.#.#...#.....#.#.....#...#...#.#.#.....#...#.#...#.#.#.......#...#.....#.#.........#...#...#...#...#.#...#.......#.#\n"
            + "#.#.#.#.#########.#.#.#.#.#.###########.#.#####.#####.#.#.#####.###.#.#.###.#.#.#########.#######.#.#######.#.#.#####.#.#.###.#.#.#########.#\n"
            + "#.#.#...#...#.....#.#...#...###.........#...#...###...#.#.#.....#...#.#.#...#.#...#.....#.......#.#.......#...#.......#...#...#.#.#.....#...#\n"
            + "#.#.#####.#.#.#####.###########.###########.#.#####.###.#.#.#####.###.#.#.###.###.#.###.#######.#.#######.#################.###.#.#.###.#.###\n"
            + "#...###...#...#...#.#...........#...#...###.#.#...#...#.#.#.#...#...#.#.#.###.#...#.#...#...###.#.#...###.................#.#...#.#.###.#...#\n"
            + "#######.#######.#.#.#.###########.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.#.###.#.###.#.###.#.###.#.#.#.###################.#.#.###.#.###.###.#\n"
            + "#.......#...#...#...#...#...#.....#.#.#.#...#.#.#.....#.#.#.#.#.#...#.#.#.#...#.#...#...#.#.#...#...#.#.......#...........#...###.#...#.#...#\n"
            + "#.#######.#.#.#########.#.#.#.#####.#.#.#.###.#.#######.#.#.#.#.#.###.#.#.#.###.#.#####.#.#.#.#######.#.#####.#.#################.###.#.#.###\n"
            + "#.#.....#.#.#.#.......#...#...#.....#.#.#.#...#...###...#.#.#.#.#.#...#.#.#...#.#.....#.#.#.#.#.......#.....#.#.............#...#.....#.#...#\n"
            + "#.#.###.#.#.#.#.#####.#########.#####.#.#.#.#####.###.###.#.#.#.#.#.###.#.###.#.#####.#.#.#.#.#.###########.#.#############.#.#.#######.###.#\n"
            + "#...#...#.#...#.....#.........#...#...#.#.#.#...#...#...#.#.#.#...#...#.#.#...#...#...#.#.#...#.#.....#.....#.#...#.......#...#.###...#.....#\n"
            + "#####.###.#########.#########.###.#.###.#.#.#.#.###.###.#.#.#.#######.#.#.#.#####.#.###.#.#####.#.###.#.#####.#.#.#.#####.#####.###.#.#######\n"
            + "###...#...###...###.....#...#.....#.###...#.#.#...#...#.#.#.#...#.....#.#.#.###...#.#...#.#.....#.#...#.....#.#.#.#...###.......#...#...#...#\n"
            + "###.###.#####.#.#######.#.#.#######.#######.#.###.###.#.#.#.###.#.#####.#.#.###.###.#.###.#.#####.#.#######.#.#.#.###.###########.#####.#.#.#\n"
            + "#...#...#...#.#.#.......#.#...#...#.......#.#.#...#...#.#.#.#...#.#...#.#.#.#...#...#.#...#.#...#.#...#.....#.#.#...#.............#...#...#.#\n"
            + "#.###.###.#.#.#.#.#######.###.#.#.#######.#.#.#.###.###.#.#.#.###.#.#.#.#.#.#.###.###.#.###.#.#.#.###.#.#####.#.###.###############.#.#####.#\n"
            + "#...#.#...#...#...#...#...###.#.#.#...#...#.#.#...#...#.#.#.#.###.#.#.#.#.#.#...#.#...#.###...#.#.#...#.....#.#...#...#...#.....#...#.#.....#\n"
            + "###.#.#.###########.#.#.#####.#.#.#.#.#.###.#.###.###.#.#.#.#.###.#.#.#.#.#.###.#.#.###.#######.#.#.#######.#.###.###.#.#.#.###.#.###.#.#####\n"
            + "#...#.#.#...#...#...#.#.#.....#.#.#.#...#...#.#...#...#.#.#.#...#.#.#.#.#.#.#...#.#...#.......#.#.#.#...#...#.....###...#.#...#.#.###.#.....#\n"
            + "#.###.#.#.#.#.#.#.###.#.#.#####.#.#.#####.###.#.###.###.#.#.###.#.#.#.#.#.#.#.###.###.#######.#.#.#.#.#.#.###############.###.#.#.###.#####.#\n"
            + "#...#.#...#.#.#.#...#...#.#...#.#.#.....#.....#...#...#.#.#.#...#...#...#...#.#...#...#.......#...#...#.#.........#.....#.#...#.#...#.#.....#\n"
            + "###.#.#####.#.#.###.#####.#.#.#.#.#####.#########.###.#.#.#.#.###############.#.###.###.###############.#########.#.###.#.#.###.###.#.#.#####\n"
            + "#...#.#.....#.#.#...#.....#.#.#.#.#...#.......#...#...#.#.#.#.#.......#.......#...#...#.....###...###...#.........#.#...#.#...#.#...#.#.....#\n"
            + "#.###.#.#####.#.#.###.#####.#.#.#.#.#.#######.#.###.###.#.#.#.#.#####.#.#########.###.#####.###.#.###.###.#########.#.###.###.#.#.###.#####.#\n"
            + "#.....#.....#.#.#.#...#.....#.#.#.#.#.#.......#...#...#.#.#.#...#.....#.....#...#.###.....#.....#...#...#...#.......#.###.#...#...###.#...#.#\n"
            + "###########.#.#.#.#.###.#####.#.#.#.#.#.#########.###.#.#.#.#####.#########.#.#.#.#######.#########.###.###.#.#######.###.#.#########.#.#.#.#\n"
            + "#.......#...#.#.#.#...#.#.....#.#.#.#.#.........#.#...#.#.#.....#.....###...#.#.#.#.......#.....#...###...#.#.#.....#...#...#.........#.#...#\n"
            + "#.#####.#.###.#.#.###.#.#.#####.#.#.#.#########.#.#.###.#.#####.#####.###.###.#.#.#.#######.###.#.#######.#.#.#.###.###.#####.#########.#####\n"
            + "#.....#.#.....#...#...#.#...#...#...#...#.....#.#.#...#.#.....#.....#.#...#...#.#.#...#...#.###.#...#.....#...#...#...#...###.........#.....#\n"
            + "#####.#.###########.###.###.#.#########.#.###.#.#.###.#.#####.#####.#.#.###.###.#.###.#.#.#.###.###.#.###########.###.###.###########.#####.#\n"
            + "###...#...#...###...#...###.#.#.........#.###...#...#.#...#...###...#.#...#...#.#.#...#.#.#.#...#...#.....#.......###...#...###...###.#.....#\n"
            + "###.#####.#.#.###.###.#####.#.#.#########.#########.#.###.#.#####.###.###.###.#.#.#.###.#.#.#.###.#######.#.###########.###.###.#.###.#.#####\n"
            + "#...#...#...#.....#...#.....#.#.........#.......#...#...#.#.....#...#...#.#...#.#.#...#.#...#.#...#.....#.#...........#...#.....#...#.#.....#\n"
            + "#.###.#.###########.###.#####.#########.#######.#.#####.#.#####.###.###.#.#.###.#.###.#.#####.#.###.###.#.###########.###.#########.#.#####.#\n"
            + "#.....#...#.....#...###...#...#.........#.....#.#.#.....#.....#...#...#.#.#.###...#...#.....#.#...#...#...#.....#...#...#.#.......#.#.#...#.#\n"
            + "#########.#.###.#.#######.#.###.#########.###.#.#.#.#########.###.###.#.#.#.#######.#######.#.###.###.#####.###.#.#.###.#.#.#####.#.#.#.#.#.#\n"
            + "#.........#...#.#.#.......#.###.........#...#.#.#.#.........#.....###.#.#...#...###...#.....#.#...#...#...#...#.#.#.#...#.#.....#.#.#...#.#.#\n"
            + "#.###########.#.#.#.#######.###########.###.#.#.#.#########.#########.#.#####.#.#####.#.#####.#.###.###.#.###.#.#.#.#.###.#####.#.#.#####.#.#\n"
            + "#.#...#...#...#.#.#...#...#.#...........#...#.#.#...#.....#.........#.#.#.....#.......#.....#.#...#...#.#.#...#.#.#.#...#.#...#.#.#.....#.#.#\n"
            + "#.#.#.#.#.#.###.#.###.#.#.#.#.###########.###.#.###.#.###.#########.#.#.#.#################.#.###.###.#.#.#.###.#.#.###.#.#.#.#.#.#####.#.#.#\n"
            + "#...#...#...###...###...#...#.............###...###...###...........#...#...................#.....###...#...###...#.....#...#...#.......#...#\n"
            + "#############################################################################################################################################";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT)));
        Util.time(() -> a(Input.parse(INPUT)));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
