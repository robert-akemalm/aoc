package aoc2025;

import java.util.Arrays;
import java.util.List;

import aoc2025.Util.Pos;

public class Day9 {
    private static void a(Input input) {
        long max = 0;
        for (int i = 0; i < input.red.size() - 1; i++) {
            for (int j = i + 1; j < input.red.size(); j++) {
                Pos a = input.red.get(i);
                Pos b = input.red.get(j);
                long area = ((long) Math.abs(a.x() - b.x()) + 1) * (Math.abs(a.y() - b.y()) + 1);
                max = Math.max(max, area);
            }
        }
        System.out.println(max);
    }

    private static void b(Input input) {
        int maxY = input.red.stream().mapToInt(Pos::y).max().orElseThrow();
        int[] yToMinX = new int[maxY+1];
        Arrays.fill(yToMinX, Integer.MAX_VALUE);
        int[] yToMaxX = new int[maxY+1];
        for (int i = 0; i < input.red.size(); i++) {
            Pos a = input.red.get(i);
            Pos b = input.red.get(i == input.red.size() - 1 ? 0 : i + 1);
            int dx = Integer.compare(b.x(), a.x());
            int dy = Integer.compare(b.y(), a.y());
            for (Pos p = a; !p.equals(b); p = p.move(dx, dy)) {
                yToMinX[p.y()] = Math.min(p.x(), yToMinX[p.y()]);
                yToMaxX[p.y()] = Math.max(p.x(), yToMaxX[p.y()]);
            }
        }
        int maxArea = 0;
        for (int i = 0; i < input.red.size() - 1; i++) {
            Pos a = input.red.get(i);
            for (int j = i + 1; j < input.red.size(); j++) {
                Pos b = input.red.get(j);
                int area = (Math.abs(a.x() - b.x()) + 1) * (Math.abs(a.y() - b.y()) + 1);
                if (area <= maxArea) {
                    continue;
                }

                int minBoxX = Math.min(a.x(), b.x());
                int maxBoxX = Math.max(a.x(), b.x());
                int minBoxY = Math.min(a.y(), b.y());
                int maxBoxY = Math.max(a.y(), b.y());

                boolean inside = true;
                for (int y = minBoxY; y <= maxBoxY; y++) {
                    if (minBoxX < yToMinX[y] || yToMaxX[y] < maxBoxX) {
                        inside = false;
                        break;
                    }
                }

                if (inside) {
                    maxArea = area;
                }
            }
        }
        System.out.println(maxArea);
    }

    record Input(List<Pos> red) {
        static Input parse(String input) {
            return new Input(input.lines().map(Util::extractInts).map(p -> new Pos(p[0], p[1])).toList());
        }
    }

    private static final String TEST_INPUT = "7,1\n"
                                             + "11,1\n"
                                             + "11,7\n"
                                             + "9,7\n"
                                             + "9,5\n"
                                             + "2,5\n"
                                             + "2,3\n"
                                             + "7,3";

    private static final String INPUT = "97994,50070\n"
                                        + "97994,51278\n"
                                        + "97682,51278\n"
                                        + "97682,52505\n"
                                        + "97995,52505\n"
                                        + "97995,53745\n"
                                        + "98244,53745\n"
                                        + "98244,54964\n"
                                        + "98109,54964\n"
                                        + "98109,56103\n"
                                        + "97365,56103\n"
                                        + "97365,57313\n"
                                        + "97276,57313\n"
                                        + "97276,58596\n"
                                        + "97556,58596\n"
                                        + "97556,59830\n"
                                        + "97479,59830\n"
                                        + "97479,60989\n"
                                        + "97039,60989\n"
                                        + "97039,62039\n"
                                        + "96217,62039\n"
                                        + "96217,63145\n"
                                        + "95686,63145\n"
                                        + "95686,64448\n"
                                        + "95814,64448\n"
                                        + "95814,65748\n"
                                        + "95853,65748\n"
                                        + "95853,66647\n"
                                        + "94747,66647\n"
                                        + "94747,67740\n"
                                        + "94221,67740\n"
                                        + "94221,69177\n"
                                        + "94508,69177\n"
                                        + "94508,69966\n"
                                        + "93286,69966\n"
                                        + "93286,71118\n"
                                        + "92891,71118\n"
                                        + "92891,72251\n"
                                        + "92444,72251\n"
                                        + "92444,73132\n"
                                        + "91532,73132\n"
                                        + "91532,74291\n"
                                        + "91126,74291\n"
                                        + "91126,75674\n"
                                        + "91054,75674\n"
                                        + "91054,76263\n"
                                        + "89722,76263\n"
                                        + "89722,77520\n"
                                        + "89415,77520\n"
                                        + "89415,78190\n"
                                        + "88271,78190\n"
                                        + "88271,79203\n"
                                        + "87612,79203\n"
                                        + "87612,80165\n"
                                        + "86883,80165\n"
                                        + "86883,81041\n"
                                        + "86051,81041\n"
                                        + "86051,82014\n"
                                        + "85329,82014\n"
                                        + "85329,83391\n"
                                        + "85024,83391\n"
                                        + "85024,83904\n"
                                        + "83804,83904\n"
                                        + "83804,84522\n"
                                        + "82719,84522\n"
                                        + "82719,85478\n"
                                        + "81958,85478\n"
                                        + "81958,86562\n"
                                        + "81294,86562\n"
                                        + "81294,86931\n"
                                        + "80022,86931\n"
                                        + "80022,88355\n"
                                        + "79598,88355\n"
                                        + "79598,88998\n"
                                        + "78548,88998\n"
                                        + "78548,89076\n"
                                        + "77112,89076\n"
                                        + "77112,89777\n"
                                        + "76131,89777\n"
                                        + "76131,91003\n"
                                        + "75473,91003\n"
                                        + "75473,91653\n"
                                        + "74437,91653\n"
                                        + "74437,91715\n"
                                        + "73073,91715\n"
                                        + "73073,92720\n"
                                        + "72235,92720\n"
                                        + "72235,93032\n"
                                        + "71029,93032\n"
                                        + "71029,93510\n"
                                        + "69913,93510\n"
                                        + "69913,93849\n"
                                        + "68740,93849\n"
                                        + "68740,94361\n"
                                        + "67644,94361\n"
                                        + "67644,94984\n"
                                        + "66584,94984\n"
                                        + "66584,95653\n"
                                        + "65529,95653\n"
                                        + "65529,96098\n"
                                        + "64388,96098\n"
                                        + "64388,96560\n"
                                        + "63248,96560\n"
                                        + "63248,96428\n"
                                        + "61948,96428\n"
                                        + "61948,96495\n"
                                        + "60717,96495\n"
                                        + "60717,96844\n"
                                        + "59554,96844\n"
                                        + "59554,97070\n"
                                        + "58364,97070\n"
                                        + "58364,97854\n"
                                        + "57258,97854\n"
                                        + "57258,98024\n"
                                        + "56044,98024\n"
                                        + "56044,98135\n"
                                        + "54823,98135\n"
                                        + "54823,97727\n"
                                        + "53563,97727\n"
                                        + "53563,97475\n"
                                        + "52337,97475\n"
                                        + "52337,97900\n"
                                        + "51143,97900\n"
                                        + "51143,97724\n"
                                        + "49929,97724\n"
                                        + "49929,98019\n"
                                        + "48712,98019\n"
                                        + "48712,98154\n"
                                        + "47486,98154\n"
                                        + "47486,98236\n"
                                        + "46254,98236\n"
                                        + "46254,98092\n"
                                        + "45037,98092\n"
                                        + "45037,97874\n"
                                        + "43830,97874\n"
                                        + "43830,97381\n"
                                        + "42669,97381\n"
                                        + "42669,97498\n"
                                        + "41414,97498\n"
                                        + "41414,97371\n"
                                        + "40191,97371\n"
                                        + "40191,96505\n"
                                        + "39135,96505\n"
                                        + "39135,96596\n"
                                        + "37861,96596\n"
                                        + "37861,96307\n"
                                        + "36675,96307\n"
                                        + "36675,96011\n"
                                        + "35489,96011\n"
                                        + "35489,95113\n"
                                        + "34505,95113\n"
                                        + "34505,94957\n"
                                        + "33274,94957\n"
                                        + "33274,94735\n"
                                        + "32053,94735\n"
                                        + "32053,94046\n"
                                        + "31020,94046\n"
                                        + "31020,93731\n"
                                        + "29828,93731\n"
                                        + "29828,93348\n"
                                        + "28657,93348\n"
                                        + "28657,92289\n"
                                        + "27829,92289\n"
                                        + "27829,91861\n"
                                        + "26684,91861\n"
                                        + "26684,91469\n"
                                        + "25505,91469\n"
                                        + "25505,90441\n"
                                        + "24709,90441\n"
                                        + "24709,90456\n"
                                        + "23251,90456\n"
                                        + "23251,89722\n"
                                        + "22264,89722\n"
                                        + "22264,88735\n"
                                        + "21468,88735\n"
                                        + "21468,87709\n"
                                        + "20721,87709\n"
                                        + "20721,87366\n"
                                        + "19439,87366\n"
                                        + "19439,86196\n"
                                        + "18833,86196\n"
                                        + "18833,85478\n"
                                        + "17850,85478\n"
                                        + "17850,85024\n"
                                        + "16607,85024\n"
                                        + "16607,83796\n"
                                        + "16103,83796\n"
                                        + "16103,83109\n"
                                        + "15065,83109\n"
                                        + "15065,82305\n"
                                        + "14136,82305\n"
                                        + "14136,81022\n"
                                        + "13755,81022\n"
                                        + "13755,80387\n"
                                        + "12620,80387\n"
                                        + "12620,79261\n"
                                        + "12081,79261\n"
                                        + "12081,78324\n"
                                        + "11307,78324\n"
                                        + "11307,77449\n"
                                        + "10437,77449\n"
                                        + "10437,76125\n"
                                        + "10231,76125\n"
                                        + "10231,75270\n"
                                        + "9324,75270\n"
                                        + "9324,74200\n"
                                        + "8749,74200\n"
                                        + "8749,73000\n"
                                        + "8417,73000\n"
                                        + "8417,72212\n"
                                        + "7323,72212\n"
                                        + "7323,70999\n"
                                        + "7029,70999\n"
                                        + "7029,69923\n"
                                        + "6468,69923\n"
                                        + "6468,69035\n"
                                        + "5460,69035\n"
                                        + "5460,67816\n"
                                        + "5205,67816\n"
                                        + "5205,66499\n"
                                        + "5246,66499\n"
                                        + "5246,65319\n"
                                        + "4964,65319\n"
                                        + "4964,64209\n"
                                        + "4474,64209\n"
                                        + "4474,63212\n"
                                        + "3565,63212\n"
                                        + "3565,61927\n"
                                        + "3651,61927\n"
                                        + "3651,60738\n"
                                        + "3411,60738\n"
                                        + "3411,59645\n"
                                        + "2710,59645\n"
                                        + "2710,58413\n"
                                        + "2657,58413\n"
                                        + "2657,57226\n"
                                        + "2355,57226\n"
                                        + "2355,55990\n"
                                        + "2399,55990\n"
                                        + "2399,54814\n"
                                        + "1949,54814\n"
                                        + "1949,53595\n"
                                        + "1849,53595\n"
                                        + "1849,52341\n"
                                        + "2448,52341\n"
                                        + "2448,51146\n"
                                        + "1944,51146\n"
                                        + "1944,50065\n"
                                        + "94598,50065\n"
                                        + "94598,48717\n"
                                        + "2169,48717\n"
                                        + "2169,47489\n"
                                        + "1906,47489\n"
                                        + "1906,46273\n"
                                        + "1996,46273\n"
                                        + "1996,45076\n"
                                        + "2283,45076\n"
                                        + "2283,43838\n"
                                        + "2187,43838\n"
                                        + "2187,42737\n"
                                        + "3057,42737\n"
                                        + "3057,41440\n"
                                        + "2645,41440\n"
                                        + "2645,40280\n"
                                        + "3055,40280\n"
                                        + "3055,39120\n"
                                        + "3429,39120\n"
                                        + "3429,37828\n"
                                        + "3274,37828\n"
                                        + "3274,36754\n"
                                        + "3965,36754\n"
                                        + "3965,35579\n"
                                        + "4275,35579\n"
                                        + "4275,34377\n"
                                        + "4513,34377\n"
                                        + "4513,33327\n"
                                        + "5185,33327\n"
                                        + "5185,32309\n"
                                        + "5900,32309\n"
                                        + "5900,31151\n"
                                        + "6256,31151\n"
                                        + "6256,29783\n"
                                        + "6170,29783\n"
                                        + "6170,28753\n"
                                        + "6846,28753\n"
                                        + "6846,27522\n"
                                        + "7122,27522\n"
                                        + "7122,26666\n"
                                        + "8107,26666\n"
                                        + "8107,25368\n"
                                        + "8297,25368\n"
                                        + "8297,24548\n"
                                        + "9301,24548\n"
                                        + "9301,23431\n"
                                        + "9815,23431\n"
                                        + "9815,22558\n"
                                        + "10697,22558\n"
                                        + "10697,21334\n"
                                        + "11083,21334\n"
                                        + "11083,20740\n"
                                        + "12314,20740\n"
                                        + "12314,19686\n"
                                        + "12935,19686\n"
                                        + "12935,18704\n"
                                        + "13654,18704\n"
                                        + "13654,17977\n"
                                        + "14661,17977\n"
                                        + "14661,16842\n"
                                        + "15221,16842\n"
                                        + "15221,15856\n"
                                        + "15957,15856\n"
                                        + "15957,15485\n"
                                        + "17288,15485\n"
                                        + "17288,14164\n"
                                        + "17720,14164\n"
                                        + "17720,13794\n"
                                        + "19011,13794\n"
                                        + "19011,12618\n"
                                        + "19611,12618\n"
                                        + "19611,11630\n"
                                        + "20390,11630\n"
                                        + "20390,11270\n"
                                        + "21648,11270\n"
                                        + "21648,10386\n"
                                        + "22514,10386\n"
                                        + "22514,9894\n"
                                        + "23652,9894\n"
                                        + "23652,9053\n"
                                        + "24561,9053\n"
                                        + "24561,8745\n"
                                        + "25796,8745\n"
                                        + "25796,8325\n"
                                        + "26949,8325\n"
                                        + "26949,7285\n"
                                        + "27767,7285\n"
                                        + "27767,7219\n"
                                        + "29093,7219\n"
                                        + "29093,6721\n"
                                        + "30191,6721\n"
                                        + "30191,5999\n"
                                        + "31194,5999\n"
                                        + "31194,5092\n"
                                        + "32138,5092\n"
                                        + "32138,5165\n"
                                        + "33470,5165\n"
                                        + "33470,4821\n"
                                        + "34632,4821\n"
                                        + "34632,4323\n"
                                        + "35742,4323\n"
                                        + "35742,4226\n"
                                        + "36975,4226\n"
                                        + "36975,3808\n"
                                        + "38112,3808\n"
                                        + "38112,3519\n"
                                        + "39286,3519\n"
                                        + "39286,3211\n"
                                        + "40456,3211\n"
                                        + "40456,2462\n"
                                        + "41552,2462\n"
                                        + "41552,2979\n"
                                        + "42867,2979\n"
                                        + "42867,2613\n"
                                        + "44035,2613\n"
                                        + "44035,1875\n"
                                        + "45178,1875\n"
                                        + "45178,2010\n"
                                        + "46416,2010\n"
                                        + "46416,2152\n"
                                        + "47644,2152\n"
                                        + "47644,2087\n"
                                        + "48856,2087\n"
                                        + "48856,2499\n"
                                        + "50070,2499\n"
                                        + "50070,2291\n"
                                        + "51279,2291\n"
                                        + "51279,1773\n"
                                        + "52517,1773\n"
                                        + "52517,2521\n"
                                        + "53686,2521\n"
                                        + "53686,2466\n"
                                        + "54904,2466\n"
                                        + "54904,2421\n"
                                        + "56130,2421\n"
                                        + "56130,2980\n"
                                        + "57274,2980\n"
                                        + "57274,3195\n"
                                        + "58460,3195\n"
                                        + "58460,2978\n"
                                        + "59735,2978\n"
                                        + "59735,3035\n"
                                        + "60971,3035\n"
                                        + "60971,3947\n"
                                        + "61996,3947\n"
                                        + "61996,3800\n"
                                        + "63293,3800\n"
                                        + "63293,3990\n"
                                        + "64510,3990\n"
                                        + "64510,4924\n"
                                        + "65481,4924\n"
                                        + "65481,5179\n"
                                        + "66674,5179\n"
                                        + "66674,5726\n"
                                        + "67760,5726\n"
                                        + "67760,5941\n"
                                        + "68983,5941\n"
                                        + "68983,6523\n"
                                        + "70053,6523\n"
                                        + "70053,6737\n"
                                        + "71300,6737\n"
                                        + "71300,7305\n"
                                        + "72382,7305\n"
                                        + "72382,7710\n"
                                        + "73554,7710\n"
                                        + "73554,8877\n"
                                        + "74289,8877\n"
                                        + "74289,9362\n"
                                        + "75412,9362\n"
                                        + "75412,10309\n"
                                        + "76242,10309\n"
                                        + "76242,10551\n"
                                        + "77543,10551\n"
                                        + "77543,11204\n"
                                        + "78576,11204\n"
                                        + "78576,12164\n"
                                        + "79376,12164\n"
                                        + "79376,12717\n"
                                        + "80491,12717\n"
                                        + "80491,13412\n"
                                        + "81503,13412\n"
                                        + "81503,14593\n"
                                        + "82084,14593\n"
                                        + "82084,15145\n"
                                        + "83229,15145\n"
                                        + "83229,15950\n"
                                        + "84150,15950\n"
                                        + "84150,17034\n"
                                        + "84782,17034\n"
                                        + "84782,17694\n"
                                        + "85863,17694\n"
                                        + "85863,18932\n"
                                        + "86297,18932\n"
                                        + "86297,19445\n"
                                        + "87585,19445\n"
                                        + "87585,20914\n"
                                        + "87690,20914\n"
                                        + "87690,21842\n"
                                        + "88464,21842\n"
                                        + "88464,22561\n"
                                        + "89546,22561\n"
                                        + "89546,23717\n"
                                        + "90007,23717\n"
                                        + "90007,24543\n"
                                        + "90975,24543\n"
                                        + "90975,25513\n"
                                        + "91737,25513\n"
                                        + "91737,26805\n"
                                        + "91934,26805\n"
                                        + "91934,27736\n"
                                        + "92775,27736\n"
                                        + "92775,28815\n"
                                        + "93348,28815\n"
                                        + "93348,30007\n"
                                        + "93680,30007\n"
                                        + "93680,31263\n"
                                        + "93839,31263\n"
                                        + "93839,32086\n"
                                        + "95037,32086\n"
                                        + "95037,33557\n"
                                        + "94598,33557\n"
                                        + "94598,34686\n"
                                        + "95017,34686\n"
                                        + "95017,35644\n"
                                        + "95992,35644\n"
                                        + "95992,36904\n"
                                        + "96023,36904\n"
                                        + "96023,38064\n"
                                        + "96379,38064\n"
                                        + "96379,39183\n"
                                        + "96924,39183\n"
                                        + "96924,40440\n"
                                        + "96868,40440\n"
                                        + "96868,41593\n"
                                        + "97302,41593\n"
                                        + "97302,42850\n"
                                        + "97132,42850\n"
                                        + "97132,43965\n"
                                        + "97949,43965\n"
                                        + "97949,45203\n"
                                        + "97868,45203\n"
                                        + "97868,46434\n"
                                        + "97749,46434\n"
                                        + "97749,47650\n"
                                        + "97724,47650\n"
                                        + "97724,48856\n"
                                        + "97917,48856\n"
                                        + "97917,50070";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT)));
        Util.time(() -> a(Input.parse(INPUT)));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
