package aoc2023;

import java.util.Arrays;
import java.util.List;

public class Day13 {
    private static void a(Input input) {
        ReflectionTester tester = new ReflectionTester();
        long sum = input.patterns.stream().mapToInt(tester::summarize).sum();
        System.out.println(sum);
    }

    private static void b(Input input) {
        ReflectionTester tester = new ReflectionTester();
        long sum = input.patterns.stream().mapToInt(tester::summarizeFixedSmudge).sum();
        System.out.println(sum);
    }

    record Pattern(List<String> points) {}

    record Smudge(int pos, boolean horizontal) {}

    record ReflectionTester(StringBuilder left, StringBuilder right) {
        ReflectionTester() {
            this(new StringBuilder(), new StringBuilder());
        }

        int summarizeFixedSmudge(Pattern p) {
            ReflectionTester tester = new ReflectionTester();
            Smudge smudge = tester.findSmudge(p);
            return smudge.horizontal ? 100 * smudge.pos : smudge.pos;
        }

        Smudge findSmudge(Pattern p) {
            for (int colIx = 1; colIx < p.points.getFirst().length(); colIx++) {
                if (numVerticalMatches(p, colIx) == p.points.size() - 1) {
                    return new Smudge(colIx, false);
                }
            }
            for (int rowIx = 1; rowIx < p.points.size(); rowIx++) {
                if (numHorizontalMatches(p, rowIx) == p.points.getFirst().length() - 1) {
                    return new Smudge(rowIx, true);
                }
            }
            throw new RuntimeException();
        }

        int summarize(Pattern p) {
            int vertical = findVerticalReflection(p);
            int horizontal = findHorizontalReflection(p);
            return horizontal * 100 + vertical;
        }

        int findVerticalReflection(Pattern p) {
            for (int colIx = 1; colIx < p.points.getFirst().length(); colIx++) {
                if (numVerticalMatches(p, colIx) == p.points.size()) {
                    return colIx;
                }
            }
            return 0;
        }

        int numVerticalMatches(Pattern p, int colIx) {
            StringBuilder sb = new StringBuilder();
            int count = 0;
            for (String row : p.points) {
                sb.setLength(0);
                sb.append(row);
                if (isReflection(sb, colIx)) {
                    count++;
                }
            }
            return count;
        }

        int findHorizontalReflection(Pattern p) {
            for (int rowIx = 1; rowIx < p.points.size(); rowIx++) {
                if (numHorizontalMatches(p, rowIx) == p.points.getFirst().length()) {
                    return rowIx;
                }
            }
            return 0;
        }

        int numHorizontalMatches(Pattern p, int rowIx) {
            StringBuilder sb = new StringBuilder();
            int count = 0;
            for (int colIx = 0; colIx < p.points.getFirst().length(); colIx++) {
                sb.setLength(0);
                int finalColIx = colIx;
                p.points.forEach(row -> sb.append(row.charAt(finalColIx)));
                if (isReflection(sb, rowIx)) {
                    count++;
                }
            }
            return count;
        }

        boolean isReflection(CharSequence data, int pos) {
            int length = Math.min(pos, data.length() - pos);
            left.setLength(0);
            left.append(data.subSequence(pos - length, pos));
            right.setLength(0);
            right.append(data.subSequence(pos, pos + length));
            return CharSequence.compare(left, right.reverse()) == 0;
        }
    }

    record Input(List<Pattern> patterns) {
        static Input parse(String input) {
            return new Input(Arrays.stream(input.split("\n\n"))
                                   .map(p -> new Pattern(p.lines().toList()))
                                   .toList());
        }
    }

    private static final String TEST_INPUT = "#.##..##.\n"
                                             + "..#.##.#.\n"
                                             + "##......#\n"
                                             + "##......#\n"
                                             + "..#.##.#.\n"
                                             + "..##..##.\n"
                                             + "#.#.##.#.\n"
                                             + "\n"
                                             + "#...##..#\n"
                                             + "#....#..#\n"
                                             + "..##..###\n"
                                             + "#####.##.\n"
                                             + "#####.##.\n"
                                             + "..##..###\n"
                                             + "#....#..#";

    private static final String INPUT = ".##.##.##....\n"
                                        + "#.######.##..\n"
                                        + "##......###..\n"
                                        + "...####......\n"
                                        + "...####...###\n"
                                        + "..#....#..#..\n"
                                        + ".#.####.#.###\n"
                                        + "..#....#..###\n"
                                        + ".##.##.##....\n"
                                        + "..######..###\n"
                                        + "#.##..##.####\n"
                                        + "#.#.##.#.....\n"
                                        + "##..##..##.##\n"
                                        + ".#..##..#....\n"
                                        + "#.##..##.##..\n"
                                        + "\n"
                                        + ".##.#.##.#.\n"
                                        + "#..##..####\n"
                                        + "#..##..##.#\n"
                                        + ".##.#.##.#.\n"
                                        + "....#.##...\n"
                                        + ".#.###..##.\n"
                                        + "...#.##..##\n"
                                        + ".#....#.###\n"
                                        + ".#....#.###\n"
                                        + "\n"
                                        + "##.#.####.#.####.\n"
                                        + "#..##.##.##..#..#\n"
                                        + "..###....###..###\n"
                                        + ".###.####.###..##\n"
                                        + "..#........#..##.\n"
                                        + "#..###..###..#.##\n"
                                        + "#..###..###..#.##\n"
                                        + "..#........#...#.\n"
                                        + ".###.####.###..##\n"
                                        + "\n"
                                        + ".....####..\n"
                                        + "##...####.#\n"
                                        + "##..#....#.\n"
                                        + ".....####..\n"
                                        + "####.####.#\n"
                                        + "##..#.##.#.\n"
                                        + "##.###..###\n"
                                        + "...#......#\n"
                                        + "..#.######.\n"
                                        + "##.##.##.##\n"
                                        + "..#..#..#..\n"
                                        + "##.#.####.#\n"
                                        + "####..##..#\n"
                                        + "\n"
                                        + "##..##.#.##.#.#\n"
                                        + "..##..#....#...\n"
                                        + "#.#...#.#.###.#\n"
                                        + "####.##..#.#..#\n"
                                        + "#..#....#..####\n"
                                        + "##.#.#..#....##\n"
                                        + "#.#.####.#..###\n"
                                        + "#.#.####.#..###\n"
                                        + "##.#.#..#.#..##\n"
                                        + "##.#.#..#.#..##\n"
                                        + "#.#.####.#..###\n"
                                        + "#.#.####.#..###\n"
                                        + "##.#.#..#....##\n"
                                        + "\n"
                                        + "#..##...#.####.##\n"
                                        + "#..##...#.####.##\n"
                                        + "....###.#..#.###.\n"
                                        + "#####..####..#.##\n"
                                        + "#..#..##...###..#\n"
                                        + ".##.##..#..###...\n"
                                        + ".##.#.#.#...#..#.\n"
                                        + "##.#...#.#.....#.\n"
                                        + "........######.#.\n"
                                        + "....#..#....#..##\n"
                                        + "#######..#.##..#.\n"
                                        + "#..#...#######..#\n"
                                        + "....###..###.##.#\n"
                                        + "\n"
                                        + "#.#..#.##..##\n"
                                        + "##.##.##....#\n"
                                        + "###..##......\n"
                                        + "###..###.##.#\n"
                                        + ".######.#..#.\n"
                                        + "##.##.##....#\n"
                                        + "#......##..##\n"
                                        + "\n"
                                        + "#.#..#.###.....\n"
                                        + "..####..#..#..#\n"
                                        + "#......##..####\n"
                                        + "#..##..#.#.#..#\n"
                                        + "...##....#.#...\n"
                                        + ".######...#....\n"
                                        + "#..##..##.#....\n"
                                        + "\n"
                                        + "..##...\n"
                                        + "..#.#..\n"
                                        + "..#.#..\n"
                                        + "..##...\n"
                                        + ".#..###\n"
                                        + "##....#\n"
                                        + "....#..\n"
                                        + "#..#...\n"
                                        + ".##....\n"
                                        + "...#...\n"
                                        + ".####..\n"
                                        + "\n"
                                        + "##..##..###\n"
                                        + "#.##.######\n"
                                        + "#.##.######\n"
                                        + "##..##..###\n"
                                        + "#######..##\n"
                                        + ".#####..#.#\n"
                                        + ".####....#.\n"
                                        + "\n"
                                        + "#....#...##\n"
                                        + ".####......\n"
                                        + "##.#..#...#\n"
                                        + "...#.#..###\n"
                                        + "...#.#..###\n"
                                        + "##.#..#...#\n"
                                        + ".####......\n"
                                        + "#....#...##\n"
                                        + ".#.##......\n"
                                        + "..##.#.#..#\n"
                                        + "..##.#.#..#\n"
                                        + ".#.##......\n"
                                        + "#....#...##\n"
                                        + ".####...#..\n"
                                        + "##.#..#...#\n"
                                        + "\n"
                                        + "##.#...\n"
                                        + "##.#...\n"
                                        + ".#.#.##\n"
                                        + "#.###.#\n"
                                        + "......#\n"
                                        + "..#.##.\n"
                                        + "#.#..##\n"
                                        + "#.#...#\n"
                                        + "#.#...#\n"
                                        + "#.#..##\n"
                                        + "..#.##.\n"
                                        + "......#\n"
                                        + "#.#.#.#\n"
                                        + ".#.#.##\n"
                                        + "##.#...\n"
                                        + "\n"
                                        + ".#...###.##..\n"
                                        + "#..#.##..#...\n"
                                        + "#.#.#..###.#.\n"
                                        + ".#.#####....#\n"
                                        + "..##..#..#.##\n"
                                        + "..##..#..#.##\n"
                                        + ".#.#####....#\n"
                                        + "#.#.#..###.#.\n"
                                        + "#..#.##..#...\n"
                                        + ".#...###.##..\n"
                                        + ".#...###..#..\n"
                                        + "#..#.##..#...\n"
                                        + "#.#.#..###.#.\n"
                                        + ".#.#####....#\n"
                                        + "..##..#..#.##\n"
                                        + "\n"
                                        + "#..#.#.##...#.#..\n"
                                        + "..##....####.##.#\n"
                                        + ".###.###...#.####\n"
                                        + "###....#.......#.\n"
                                        + ".#.#######..#.###\n"
                                        + "#..#..##..##.#..#\n"
                                        + "#..#..##..##.#..#\n"
                                        + ".#.#######..#.###\n"
                                        + "###....#.......#.\n"
                                        + ".###.###...#.####\n"
                                        + "..##....####.##.#\n"
                                        + "#..#.#.###..#.#..\n"
                                        + "#..#.#.###..#.#..\n"
                                        + "..##....####.##.#\n"
                                        + ".###.###...#.####\n"
                                        + "\n"
                                        + "######....##..##.\n"
                                        + "..#..#####.#.###.\n"
                                        + ".#####...########\n"
                                        + "######...########\n"
                                        + "..#..#####.#.###.\n"
                                        + "######....##..##.\n"
                                        + ".##...#.#....#...\n"
                                        + "##..##.......###.\n"
                                        + ".###..###.###...#\n"
                                        + "....#.##.###.##..\n"
                                        + "..##.#...####...#\n"
                                        + "..##.#...#.###.#.\n"
                                        + "#.#...#.#....##.#\n"
                                        + "##.#.##..#......#\n"
                                        + "##.#.##.##.##..#.\n"
                                        + "...#...#.#.###.##\n"
                                        + "...#...#.#.###.##\n"
                                        + "\n"
                                        + "..#.##..#\n"
                                        + "##.#..###\n"
                                        + "##..#...#\n"
                                        + "###.##.##\n"
                                        + "###.##.##\n"
                                        + "##..#...#\n"
                                        + "##.#..###\n"
                                        + "..#.##..#\n"
                                        + ".##..##.#\n"
                                        + "###.###..\n"
                                        + "#..##....\n"
                                        + "#.#...#..\n"
                                        + "..####..#\n"
                                        + "..####..#\n"
                                        + "#.#...#..\n"
                                        + "#..##....\n"
                                        + "###.###.#\n"
                                        + "\n"
                                        + "..#.##.#.##.#..\n"
                                        + "##..##.#.####.#\n"
                                        + ".....#...#...#.\n"
                                        + ".####....######\n"
                                        + ".####....######\n"
                                        + ".....#...#...#.\n"
                                        + "##..##.#.####.#\n"
                                        + "..#.##.#.##.#..\n"
                                        + "#..#####.#.#.#.\n"
                                        + "####..#.###..#.\n"
                                        + ".....##...##..#\n"
                                        + "..#.#.###..#...\n"
                                        + "#...#.##..#...#\n"
                                        + ".##.##..##.#...\n"
                                        + ".##.##..##.#...\n"
                                        + "....#.##..#...#\n"
                                        + "..#.#.###..#...\n"
                                        + "\n"
                                        + "......#..#.\n"
                                        + ".###.######\n"
                                        + "###...#..#.\n"
                                        + ".#.###.##.#\n"
                                        + "#..##......\n"
                                        + "##..#.#..#.\n"
                                        + "##..#.#..#.\n"
                                        + "#..##......\n"
                                        + ".#.###.##.#\n"
                                        + "###...#..#.\n"
                                        + ".##########\n"
                                        + "......#..#.\n"
                                        + "...###....#\n"
                                        + "..#...####.\n"
                                        + ".#.#.#.##.#\n"
                                        + "\n"
                                        + "#.##..##.##\n"
                                        + "###.##.####\n"
                                        + "#..####..#.\n"
                                        + "#..####..#.\n"
                                        + "###.##.####\n"
                                        + "#.##..##.##\n"
                                        + ".........#.\n"
                                        + "#...##...##\n"
                                        + "###.##.###.\n"
                                        + "....##....#\n"
                                        + "#..####..#.\n"
                                        + "\n"
                                        + ".#.##.....#.##.#.\n"
                                        + ".##...####.####.#\n"
                                        + "......###........\n"
                                        + ".#...##..#......#\n"
                                        + ".#...#.#.##....##\n"
                                        + "#.#.#..###......#\n"
                                        + ".#.##.....######.\n"
                                        + ".#.##.....######.\n"
                                        + "#.#.#...##......#\n"
                                        + "\n"
                                        + "###..##..\n"
                                        + "######..#\n"
                                        + "...##....\n"
                                        + "##.#.#.##\n"
                                        + "###..#...\n"
                                        + "###..#...\n"
                                        + "##.#.#.##\n"
                                        + "...##....\n"
                                        + "###.##..#\n"
                                        + "\n"
                                        + ".....#....#.#\n"
                                        + ".##.#.##.####\n"
                                        + "#####..###..#\n"
                                        + ".##.###.#.##.\n"
                                        + "....#.#.....#\n"
                                        + "#..#..#....#.\n"
                                        + "......##.#...\n"
                                        + "#######..#.##\n"
                                        + "###.###.####.\n"
                                        + "####.##...#.#\n"
                                        + "...........##\n"
                                        + "....#.#.##.#.\n"
                                        + "#####.#.##.#.\n"
                                        + "#####..#.#.#.\n"
                                        + "#..##..####..\n"
                                        + "#..##..####..\n"
                                        + "#####..#.#.#.\n"
                                        + "\n"
                                        + ".#.#....#.###.#\n"
                                        + "####...#..##.##\n"
                                        + "#.#...#..#...##\n"
                                        + "#.####..#.#..#.\n"
                                        + "..#..##.#.#...#\n"
                                        + "##..#..###.####\n"
                                        + "##..#..###.####\n"
                                        + "..#..##.#.#...#\n"
                                        + "#.####..#.#..#.\n"
                                        + "#.#......#...##\n"
                                        + "####...#..##.##\n"
                                        + ".#.#....#.###.#\n"
                                        + ".#.#....#.###.#\n"
                                        + "\n"
                                        + "##..#..#..#\n"
                                        + "##.########\n"
                                        + "###..##..##\n"
                                        + "..###..###.\n"
                                        + "##.######.#\n"
                                        + "##........#\n"
                                        + "..##.##.##.\n"
                                        + "....####...\n"
                                        + "##..####..#\n"
                                        + "...#....#..\n"
                                        + "..##.##.##.\n"
                                        + "\n"
                                        + "##...##.####.\n"
                                        + "#...#..##.##.\n"
                                        + ".##.##.#.#..#\n"
                                        + "..###..#####.\n"
                                        + "..###..#####.\n"
                                        + ".##.##.#.#..#\n"
                                        + "#...#..##.##.\n"
                                        + "##...##.####.\n"
                                        + "##...##.####.\n"
                                        + "#..##..##.##.\n"
                                        + ".##.##.#.#..#\n"
                                        + "\n"
                                        + ".........#.\n"
                                        + "##.#.#..###\n"
                                        + "##.#.#..###\n"
                                        + ".........#.\n"
                                        + "#.#.##.#.#.\n"
                                        + "#.##.#.#..#\n"
                                        + ".##.##.#.#.\n"
                                        + "###.###....\n"
                                        + "#.#.####.##\n"
                                        + "#.#.####.#.\n"
                                        + "###.###....\n"
                                        + ".##.##.#.#.\n"
                                        + "#.##.#.#..#\n"
                                        + "#.#.##.#.#.\n"
                                        + ".........#.\n"
                                        + "\n"
                                        + "###....\n"
                                        + "####.##\n"
                                        + "###..##\n"
                                        + "...##..\n"
                                        + "...####\n"
                                        + "....#.#\n"
                                        + "##.#.##\n"
                                        + "..#..##\n"
                                        + "....###\n"
                                        + "\n"
                                        + ".#..#.###.#\n"
                                        + "..##....###\n"
                                        + "#.##.#..#..\n"
                                        + "##..##.#...\n"
                                        + "##..##.##.#\n"
                                        + "##..####.#.\n"
                                        + "##..####.#.\n"
                                        + "##..##.#..#\n"
                                        + "##..##.#...\n"
                                        + "#.##.#..#..\n"
                                        + "..##....###\n"
                                        + "\n"
                                        + ".##...#\n"
                                        + ".##....\n"
                                        + "####...\n"
                                        + ".##..#.\n"
                                        + "....#.#\n"
                                        + "#####..\n"
                                        + "#..##..\n"
                                        + "....#.#\n"
                                        + ".##..#.\n"
                                        + "\n"
                                        + ".....###..###\n"
                                        + "#..#.########\n"
                                        + "####.#......#\n"
                                        + "#.###########\n"
                                        + "#.###########\n"
                                        + "#.##.#......#\n"
                                        + "#..#.########\n"
                                        + ".....###..###\n"
                                        + ".##.##.####.#\n"
                                        + "..#....#..#..\n"
                                        + "..##.#.####.#\n"
                                        + "#.###........\n"
                                        + "....#.#....#.\n"
                                        + ".#######..###\n"
                                        + ".###.#.####.#\n"
                                        + "#.#.#...##...\n"
                                        + "##...#.####.#\n"
                                        + "\n"
                                        + "#....##.#.##.\n"
                                        + "..#.#..#.#..#\n"
                                        + "..##....#....\n"
                                        + "###..####.##.\n"
                                        + "#..##.....##.\n"
                                        + ".#...#.######\n"
                                        + ".#...#.######\n"
                                        + "#..##.....##.\n"
                                        + "###..###..##.\n"
                                        + "..##....#....\n"
                                        + "..#.#..#.#..#\n"
                                        + "\n"
                                        + ".##....\n"
                                        + "##.####\n"
                                        + "#.#####\n"
                                        + "#..#..#\n"
                                        + ".######\n"
                                        + "...####\n"
                                        + "...####\n"
                                        + "###....\n"
                                        + ".#.####\n"
                                        + "##.....\n"
                                        + "#.#####\n"
                                        + "...####\n"
                                        + "#..####\n"
                                        + "...####\n"
                                        + "#......\n"
                                        + "\n"
                                        + "....###.#\n"
                                        + "#..###...\n"
                                        + "####.##.#\n"
                                        + ".....#..#\n"
                                        + "####...##\n"
                                        + "#..#..#..\n"
                                        + "....##...\n"
                                        + ".....#..#\n"
                                        + ".##....#.\n"
                                        + ".##..#...\n"
                                        + "#####....\n"
                                        + ".##...#.#\n"
                                        + ".##......\n"
                                        + ".##..#...\n"
                                        + ".##...#.#\n"
                                        + "#####....\n"
                                        + ".##..#...\n"
                                        + "\n"
                                        + "###.##.##########\n"
                                        + "...####...#..#...\n"
                                        + ".#.#..#.#......#.\n"
                                        + "##..##..########.\n"
                                        + "#...##...##...#..\n"
                                        + "###.##.##########\n"
                                        + "##......###..###.\n"
                                        + ".##....##......##\n"
                                        + "..######..####..#\n"
                                        + "##.####.###..###.\n"
                                        + ".###..###..##..##\n"
                                        + "....##...........\n"
                                        + "##########....###\n"
                                        + ".#.#..#.#.#..#.#.\n"
                                        + ".#..##..#.#..#.#.\n"
                                        + "..##..##...##...#\n"
                                        + "..#....#........#\n"
                                        + "\n"
                                        + "#..#....#..####\n"
                                        + "....#..#.....#.\n"
                                        + "##.##..##.##.#.\n"
                                        + "...######......\n"
                                        + "#..#....#..#.##\n"
                                        + "#..#....#..#.##\n"
                                        + "...######......\n"
                                        + "##.##..##.##.#.\n"
                                        + "....#..#.....#.\n"
                                        + "#..#....#..##.#\n"
                                        + "..#..##..#....#\n"
                                        + "#...####...###.\n"
                                        + "#.#......#.#..#\n"
                                        + "....#..#....#..\n"
                                        + "...#.##.#....#.\n"
                                        + "\n"
                                        + "##..##..##.\n"
                                        + ".#..#....#.\n"
                                        + "######..###\n"
                                        + ".#..#.##.#.\n"
                                        + "#.##.####.#\n"
                                        + ".####....##\n"
                                        + "#.##.#..#.#\n"
                                        + ".####....##\n"
                                        + ".#..#.##.#.\n"
                                        + "######..###\n"
                                        + "######..###\n"
                                        + "######..###\n"
                                        + "......##...\n"
                                        + ".##.#....#.\n"
                                        + "#.##.####.#\n"
                                        + "\n"
                                        + "#...#.#.#........\n"
                                        + "#.#.####.########\n"
                                        + "####.#.#..##..##.\n"
                                        + "#.#######.######.\n"
                                        + "#.###.###.##..##.\n"
                                        + "#.###.#.#########\n"
                                        + "##.#.############\n"
                                        + ".#.....##........\n"
                                        + "..#.###..########\n"
                                        + "\n"
                                        + "#..##.#...#\n"
                                        + "#...#..###.\n"
                                        + "##...#.####\n"
                                        + ".##.##.#.##\n"
                                        + ".##.##.#.##\n"
                                        + "##...#.####\n"
                                        + "#......###.\n"
                                        + "#..##.#...#\n"
                                        + ".##..#.#.##\n"
                                        + ".##..#.#.##\n"
                                        + "#..##.#...#\n"
                                        + "\n"
                                        + ".###.##.##.\n"
                                        + "#.##..#....\n"
                                        + "#..#.###..#\n"
                                        + "#..#.###..#\n"
                                        + "#.###.#....\n"
                                        + ".###.##.##.\n"
                                        + ".#.#####..#\n"
                                        + "...#.#.....\n"
                                        + "##.....####\n"
                                        + "\n"
                                        + "##..#..#..#\n"
                                        + "##..#..#..#\n"
                                        + "...#..#.#..\n"
                                        + ".#.##..##.#\n"
                                        + "###......##\n"
                                        + "#.###..###.\n"
                                        + "###.####.##\n"
                                        + "###.#..#.##\n"
                                        + "#..#.##.#..\n"
                                        + "##........#\n"
                                        + "..#.####.#.\n"
                                        + "..#..##..#.\n"
                                        + "....#..#...\n"
                                        + "\n"
                                        + "###...####....#\n"
                                        + "..#..#.#.#.##.#\n"
                                        + "..#..#.#.#.##.#\n"
                                        + "###.#.####....#\n"
                                        + "#.#..##........\n"
                                        + "..##.##########\n"
                                        + "##..#..#.......\n"
                                        + "#...#.#.#######\n"
                                        + "#..###.###.##.#\n"
                                        + "##..###########\n"
                                        + "#..#..#.##.##.#\n"
                                        + "#...###..##..##\n"
                                        + ".##....#..####.\n"
                                        + "#.###...#.#..#.\n"
                                        + "###.....#..##..\n"
                                        + "\n"
                                        + "....####.\n"
                                        + ".#.......\n"
                                        + "....####.\n"
                                        + "#........\n"
                                        + "#........\n"
                                        + "....####.\n"
                                        + ".#.......\n"
                                        + ".#..####.\n"
                                        + "#.###..##\n"
                                        + "\n"
                                        + ".#.##.##.....##..\n"
                                        + ".######.#..######\n"
                                        + "#....#..#.##....#\n"
                                        + "..####.###.##..##\n"
                                        + "..#..##..#...###.\n"
                                        + ".##.##.#.....##..\n"
                                        + ".##.##.#.....##..\n"
                                        + "\n"
                                        + "..........#####\n"
                                        + ".#..##..#..#.##\n"
                                        + "#..#..##.##.#..\n"
                                        + "####..####.####\n"
                                        + "#.##..##.##.###\n"
                                        + "...#..#...#..##\n"
                                        + ".#.####.#.#####\n"
                                        + "...#..#...#.#..\n"
                                        + ".#......#......\n"
                                        + "...#..#...#..##\n"
                                        + "#..####..##..##\n"
                                        + "\n"
                                        + "...##.#..\n"
                                        + "##.#...##\n"
                                        + "...#..#.#\n"
                                        + "...#..#.#\n"
                                        + "##.#..###\n"
                                        + "...##.#..\n"
                                        + "..##...##\n"
                                        + "#####.###\n"
                                        + "####.##..\n"
                                        + "..#.#####\n"
                                        + "####..#.#\n"
                                        + "....##...\n"
                                        + "##.###.#.\n"
                                        + "##..###.#\n"
                                        + "####.#.##\n"
                                        + "\n"
                                        + "..#.#.#\n"
                                        + ".##.##.\n"
                                        + "#####..\n"
                                        + "####.#.\n"
                                        + "##.#..#\n"
                                        + "##.#..#\n"
                                        + "####.#.\n"
                                        + "\n"
                                        + "..##..#.##.#.\n"
                                        + "#.###.######.\n"
                                        + "##..##.#..#.#\n"
                                        + ".#.##...##...\n"
                                        + "..####.####.#\n"
                                        + "...#.###..###\n"
                                        + "...#.###..###\n"
                                        + "#.####.####.#\n"
                                        + ".#.##...##...\n"
                                        + "##..##.#..#.#\n"
                                        + "#.###.######.\n"
                                        + "\n"
                                        + "..#####..#.....\n"
                                        + ".##.#.#......##\n"
                                        + ".#####.###..###\n"
                                        + "##......###.#..\n"
                                        + "###..##.#..#.##\n"
                                        + "..##.###....#..\n"
                                        + ".#.##...####...\n"
                                        + ".#.##...###....\n"
                                        + "..##.###....#..\n"
                                        + "###..##.#..#.##\n"
                                        + "##......###.#..\n"
                                        + "\n"
                                        + ".##......##.#....\n"
                                        + "#####..######....\n"
                                        + "##.#....#.####..#\n"
                                        + "..##.##.##..#.##.\n"
                                        + "..#......#..##..#\n"
                                        + "#.#..##..#.######\n"
                                        + "...#....#.....##.\n"
                                        + "...######...#....\n"
                                        + "...##..##....#..#\n"
                                        + "#.###..###.#.....\n"
                                        + ".#...##...#...##.\n"
                                        + "#.#.#..#.#.#.....\n"
                                        + ".#...##...#.##...\n"
                                        + "##...##...###....\n"
                                        + "..#.#..#.#....##.\n"
                                        + "..##.##.##..#####\n"
                                        + ".##.#..#.##.#.##.\n"
                                        + "\n"
                                        + "#....#.#.#..#.#..\n"
                                        + "..####..#.#######\n"
                                        + "..####..#.#######\n"
                                        + "#....#.#.#..#.#..\n"
                                        + ".#.#####..#####..\n"
                                        + "#..###.#..#.##..#\n"
                                        + "#..#.#...###.###.\n"
                                        + "#.#.##.##....##.#\n"
                                        + "#.#.#....##...#..\n"
                                        + "..##.##.......#..\n"
                                        + "..##.##.......#..\n"
                                        + "#.#.#....##...#..\n"
                                        + "###.##.##....##.#\n"
                                        + "#..#.#...###.###.\n"
                                        + "#..###.#..#.##..#\n"
                                        + "\n"
                                        + ".##......##..\n"
                                        + ".##..##..##..\n"
                                        + "#..#.##.#..##\n"
                                        + "#..######..#.\n"
                                        + "#..#....#..##\n"
                                        + ".##.#..#.##..\n"
                                        + ".##.####.##.#\n"
                                        + "##.#....#.###\n"
                                        + "####....#####\n"
                                        + "\n"
                                        + "#..#####.\n"
                                        + ".....#...\n"
                                        + "#..#..#..\n"
                                        + "#..#..#..\n"
                                        + ".....#...\n"
                                        + "#..#####.\n"
                                        + ".####....\n"
                                        + "######.##\n"
                                        + "#..#.#.##\n"
                                        + "....##.#.\n"
                                        + "....##...\n"
                                        + "####.#..#\n"
                                        + "#..#.....\n"
                                        + "######.#.\n"
                                        + ".##.##..#\n"
                                        + "\n"
                                        + "......#\n"
                                        + "#....##\n"
                                        + "....#..\n"
                                        + "##..##.\n"
                                        + "......#\n"
                                        + "##..###\n"
                                        + "......#\n"
                                        + "..##...\n"
                                        + "..##..#\n"
                                        + "#....##\n"
                                        + "#....##\n"
                                        + "\n"
                                        + ".#..####..#..##\n"
                                        + "..#.#..#.#..###\n"
                                        + "##..#..#..##...\n"
                                        + "...#.##.#...###\n"
                                        + "##..####..#####\n"
                                        + ".#...##...#.###\n"
                                        + ".##..##..##.###\n"
                                        + "..#......#..###\n"
                                        + "#.#......#.####\n"
                                        + "############...\n"
                                        + "#.#.##.#.#.#.##\n"
                                        + "#..........####\n"
                                        + "..##.##.##...##\n"
                                        + ".##.####.##.#..\n"
                                        + "#..######..#...\n"
                                        + "\n"
                                        + "##.###..#.###.###\n"
                                        + ".###.##......#.##\n"
                                        + "..#..##..##.##.##\n"
                                        + "..#..##..##.##.##\n"
                                        + ".###.##......#.##\n"
                                        + "##.###..#.###.###\n"
                                        + "..#.#.#..#..###..\n"
                                        + ".#.#.#.#.#.#####.\n"
                                        + ".#.#.#.#.#.#####.\n"
                                        + "..#.#.#..#..###..\n"
                                        + "######..#.###.###\n"
                                        + ".###.##......#.##\n"
                                        + "..#..##..##.##.##\n"
                                        + "\n"
                                        + "##..##..####..#\n"
                                        + ".#.#.....##....\n"
                                        + "..##.#.##..##.#\n"
                                        + ".#..##.##..##.#\n"
                                        + ".###..#.#..#.#.\n"
                                        + "##...###....###\n"
                                        + "#...####....###\n"
                                        + "#..#..#......#.\n"
                                        + "...#..#......#.\n"
                                        + "\n"
                                        + "#.#..#.#.##\n"
                                        + "#########..\n"
                                        + "..####..#..\n"
                                        + "#......#.##\n"
                                        + "#......#...\n"
                                        + "#.####.####\n"
                                        + "..#..#..###\n"
                                        + "#########..\n"
                                        + "..#.....###\n"
                                        + ".#.##.#.###\n"
                                        + "#.#..#.##..\n"
                                        + "\n"
                                        + "####..##.\n"
                                        + "####..##.\n"
                                        + "..###..##\n"
                                        + "#...#...#\n"
                                        + "...#.##..\n"
                                        + "#...#.###\n"
                                        + "#####...#\n"
                                        + "..###.#..\n"
                                        + "..###.#..\n"
                                        + "#####...#\n"
                                        + "#...#.###\n"
                                        + "...#.##..\n"
                                        + "#...#...#\n"
                                        + "..###..##\n"
                                        + "####...#.\n"
                                        + "\n"
                                        + ".######....\n"
                                        + "..#........\n"
                                        + "###.#.#####\n"
                                        + "###..#.#..#\n"
                                        + "##..#.#....\n"
                                        + ".#.###.#..#\n"
                                        + "##.####....\n"
                                        + "#..##..#..#\n"
                                        + ".#..####..#\n"
                                        + "....####..#\n"
                                        + "#..##..#..#\n"
                                        + "##.####....\n"
                                        + ".#.###.#..#\n"
                                        + "##..#.#....\n"
                                        + "###..#.#..#\n"
                                        + "###.#.#####\n"
                                        + "..#........\n"
                                        + "\n"
                                        + "#.####.###..###.#\n"
                                        + "..####..#.......#\n"
                                        + "#.#..#.###..###.#\n"
                                        + "..####...#..#...#\n"
                                        + "########......###\n"
                                        + "##.##.###....###.\n"
                                        + ".##..##..#..#..##\n"
                                        + "..####..#....#..#\n"
                                        + "#......##.##.##..\n"
                                        + "###..#####..#####\n"
                                        + "########.#..#.###\n"
                                        + "\n"
                                        + "#.#.#.#\n"
                                        + "..####.\n"
                                        + "##.####\n"
                                        + "#..##.#\n"
                                        + "#.#..#.\n"
                                        + ".#.....\n"
                                        + "####.##\n"
                                        + ".##.#.#\n"
                                        + ".#..#.#\n"
                                        + "..#####\n"
                                        + "..#####\n"
                                        + ".#..#.#\n"
                                        + ".##.#.#\n"
                                        + "\n"
                                        + "..#....\n"
                                        + "...####\n"
                                        + "..##..#\n"
                                        + "##.#..#\n"
                                        + "...#..#\n"
                                        + "##.....\n"
                                        + "....##.\n"
                                        + ".##....\n"
                                        + "##.....\n"
                                        + "####..#\n"
                                        + "###....\n"
                                        + "\n"
                                        + ".##.##.##..#..#..\n"
                                        + ".........#.#..#.#\n"
                                        + "#...##...##....##\n"
                                        + "#.#....#.#.#..#.#\n"
                                        + "#.######.#.####.#\n"
                                        + "...#..#...######.\n"
                                        + "##......#########\n"
                                        + "\n"
                                        + "..#.###..\n"
                                        + "....####.\n"
                                        + "..#.####.\n"
                                        + "###...##.\n"
                                        + ".....#.##\n"
                                        + "#####.##.\n"
                                        + "###......\n"
                                        + "#.#.#.##.\n"
                                        + "##.#.##..\n"
                                        + "##......#\n"
                                        + "##.#.##..\n"
                                        + "..#.#...#\n"
                                        + "...##...#\n"
                                        + "...##...#\n"
                                        + "..#.#...#\n"
                                        + "\n"
                                        + ".####.#.####.##\n"
                                        + ".##...##.#..#.#\n"
                                        + "#..##.##.###..#\n"
                                        + ".##........####\n"
                                        + "#..##..#.#..##.\n"
                                        + "....##...###...\n"
                                        + ".##...###...###\n"
                                        + ".##...###...###\n"
                                        + "....##...###...\n"
                                        + "\n"
                                        + "..#.#..##.#..##\n"
                                        + "#.#.##.###.##..\n"
                                        + "#.#####.....#.#\n"
                                        + "..#....########\n"
                                        + ".#.#.#.##.#..##\n"
                                        + ".#.#.#.##.#..##\n"
                                        + "..#....########\n"
                                        + "\n"
                                        + "##.#####..#######\n"
                                        + "###..#.#...##..##\n"
                                        + "#....#..#.#......\n"
                                        + "#.#..#...####..##\n"
                                        + "....#.###########\n"
                                        + ".....####..######\n"
                                        + ".#..###.....#..#.\n"
                                        + "##.###.#.#.##..##\n"
                                        + "###.#.##.#.##..##\n"
                                        + "\n"
                                        + "#..#..#...##.\n"
                                        + "#..###...#..#\n"
                                        + "###.##..#####\n"
                                        + ".#..#.#......\n"
                                        + ".####.###.##.\n"
                                        + "#.##..#.#....\n"
                                        + "####..#.#....\n"
                                        + "\n"
                                        + "#.#..####..#.##\n"
                                        + "..#...##...#...\n"
                                        + "#.##########.##\n"
                                        + "..####..####..#\n"
                                        + "#####.##.######\n"
                                        + ".#.##.##.##.#.#\n"
                                        + "##..######..##.\n"
                                        + ".#...#####..#.#\n"
                                        + ".###..##..###.#\n"
                                        + "#.#.#.##.#.#.##\n"
                                        + ".#.#..##..#.#..\n"
                                        + "##..######..##.\n"
                                        + ".#.##.##.##.#..\n"
                                        + ".#..#....#..#.#\n"
                                        + ".#..#....#..#.#\n"
                                        + "\n"
                                        + ".#####...\n"
                                        + "##....#.#\n"
                                        + "#..#.#.#.\n"
                                        + "..#.##...\n"
                                        + "#.#.##...\n"
                                        + "#..#.#.#.\n"
                                        + "##....#.#\n"
                                        + ".#####...\n"
                                        + ".#.###.#.\n"
                                        + "...###...\n"
                                        + "...###...\n"
                                        + "\n"
                                        + "##.######.###\n"
                                        + "####.##.####.\n"
                                        + ".##.####.##..\n"
                                        + "###..##...###\n"
                                        + "#####..#####.\n"
                                        + "###.####.###.\n"
                                        + "#...####...#.\n"
                                        + "##.#.##.#.##.\n"
                                        + ".#.#.##.#.#..\n"
                                        + "##.##..##.###\n"
                                        + "##........###\n"
                                        + "##........###\n"
                                        + "##.##..##.###\n"
                                        + ".#.#.##.#.#..\n"
                                        + "##.#.##.#.##.\n"
                                        + "#...####...#.\n"
                                        + "###.####.###.\n"
                                        + "\n"
                                        + "#.##.##..####.#\n"
                                        + "......##....#..\n"
                                        + "..##..#...##..#\n"
                                        + "......#####....\n"
                                        + "..........#.##.\n"
                                        + "..##..####.####\n"
                                        + ".#....##......#\n"
                                        + "##..##.##..####\n"
                                        + ".......#####...\n"
                                        + "##..####..#.#.#\n"
                                        + ".......#.##.#..\n"
                                        + "..##....##...#.\n"
                                        + ".#..#......####\n"
                                        + "#######.#.##...\n"
                                        + "#######.#.##...\n"
                                        + "\n"
                                        + "#.##.##.#\n"
                                        + "##..#..#.\n"
                                        + ".####..##\n"
                                        + "##..####.\n"
                                        + ".#..#..#.\n"
                                        + "#....##..\n"
                                        + "#.##.##.#\n"
                                        + "\n"
                                        + "##.##.#..\n"
                                        + "##..##.##\n"
                                        + "###.#....\n"
                                        + "##.......\n"
                                        + "##.#..#..\n"
                                        + "..#.###..\n"
                                        + "..#######\n"
                                        + "......#..\n"
                                        + "###.#....\n"
                                        + "....#.###\n"
                                        + "..###..##\n"
                                        + ".......##\n"
                                        + "...######\n"
                                        + "..#....#.\n"
                                        + "..#..#.##\n"
                                        + "\n"
                                        + "##...........\n"
                                        + "......#..#...\n"
                                        + "##...........\n"
                                        + "#..#.#.##.#.#\n"
                                        + "#..#.#.##.#.#\n"
                                        + "##...........\n"
                                        + "......#..#...\n"
                                        + "##...........\n"
                                        + "#.#.##.##.##.\n"
                                        + ".....######..\n"
                                        + "..###......##\n"
                                        + "#.##.#....#.#\n"
                                        + ".##.##.##.##.\n"
                                        + ".....######..\n"
                                        + "####.#.##.#.#\n"
                                        + "#####.####.#.\n"
                                        + "##.###....###\n"
                                        + "\n"
                                        + "#.#..#..#.#\n"
                                        + "..##.##.###\n"
                                        + "..##.##.###\n"
                                        + "#.#..#..#.#\n"
                                        + "##...#.##.#\n"
                                        + "###...#.##.\n"
                                        + "##.###.....\n"
                                        + "#..#.##.#.#\n"
                                        + "#....##.#.#\n"
                                        + "##.###.....\n"
                                        + "###...#.##.\n"
                                        + "\n"
                                        + "####.#.##...#\n"
                                        + ".##...##.####\n"
                                        + "#####...#....\n"
                                        + ".....#.##.###\n"
                                        + "########.#...\n"
                                        + "####.#.##.###\n"
                                        + "....###.####.\n"
                                        + ".....#.##..#.\n"
                                        + "######..##.##\n"
                                        + "\n"
                                        + "..#.##.#.##\n"
                                        + ".#....#....\n"
                                        + "####...##..\n"
                                        + "####...##..\n"
                                        + ".#.........\n"
                                        + "..#.##.#.##\n"
                                        + ".......##..\n"
                                        + "###.#.##.##\n"
                                        + "...#.#.....\n"
                                        + "\n"
                                        + "..#..#.####.#\n"
                                        + "#####.##..###\n"
                                        + "##.#.##.##.##\n"
                                        + "..#..###..###\n"
                                        + "###.###.##.##\n"
                                        + "..#...##..##.\n"
                                        + "###.#........\n"
                                        + "##.#.........\n"
                                        + "####..#....#.\n"
                                        + "...#...#..#..\n"
                                        + "##...##....##\n"
                                        + "...#..#.##.#.\n"
                                        + "....#.######.\n"
                                        + "###.#..#..#..\n"
                                        + "..#...#....#.\n"
                                        + "\n"
                                        + "####.#...\n"
                                        + "....#....\n"
                                        + ".##..#.#.\n"
                                        + ".##..#.#.\n"
                                        + "....#...#\n"
                                        + "####.#...\n"
                                        + "########.\n"
                                        + "\n"
                                        + "..####.#.\n"
                                        + ".#..##...\n"
                                        + ".#..##...\n"
                                        + "..####.#.\n"
                                        + ".###...#.\n"
                                        + "##.#..#.#\n"
                                        + "##.#..#..\n"
                                        + "##.#..#..\n"
                                        + "##.#..#.#\n"
                                        + ".###...#.\n"
                                        + ".#####.#.\n"
                                        + "\n"
                                        + "..######.\n"
                                        + "##.####.#\n"
                                        + "...####..\n"
                                        + "##..##..#\n"
                                        + "####..###\n"
                                        + "###.##.##\n"
                                        + "..#.##.#.\n"
                                        + "##......#\n"
                                        + "..#.##.#.\n"
                                        + "...####..\n"
                                        + "####..###\n"
                                        + "...#..#..\n"
                                        + "###.##.##\n"
                                        + "###.##.##\n"
                                        + "##.####.#\n"
                                        + "...###...\n"
                                        + "###....##\n"
                                        + "\n"
                                        + "#..#..#..#.###...\n"
                                        + ".##....##..####.#\n"
                                        + "...#..#...##..#..\n"
                                        + "####..####..#...#\n"
                                        + ".########..#..#.#\n"
                                        + "###.##.####...#.#\n"
                                        + "...####......#..#\n"
                                        + "##..##..###..#...\n"
                                        + ".#.#..#.#..#.#...\n"
                                        + "#........###.##.#\n"
                                        + "#..#..#..####.###\n"
                                        + ".##.##.##.#..#.#.\n"
                                        + "###....###.##..##\n"
                                        + "###....###.##..##\n"
                                        + ".##.##.##....#.#.\n"
                                        + "#..#..#..####.###\n"
                                        + "#........###.##.#\n"
                                        + "\n"
                                        + "####.#.##\n"
                                        + "#..###.##\n"
                                        + "#..#.####\n"
                                        + ".##.##..#\n"
                                        + ".##...##.\n"
                                        + "####..#..\n"
                                        + "....#.##.\n"
                                        + "#..#..###\n"
                                        + "####.....\n"
                                        + ".....#...\n"
                                        + ".##..##.#\n"
                                        + "....#.#..\n"
                                        + "....#.#..\n"
                                        + ".##..##.#\n"
                                        + ".....#.#.\n"
                                        + "####.....\n"
                                        + "#..#..###\n"
                                        + "\n"
                                        + "###.###\n"
                                        + "##...#.\n"
                                        + "....#.#\n"
                                        + "##.#..#\n"
                                        + "##.#..#\n"
                                        + "....###\n"
                                        + "##...#.\n"
                                        + "###.###\n"
                                        + "....##.\n"
                                        + "..#.###\n"
                                        + "###..##\n"
                                        + "...###.\n"
                                        + "###.#..\n"
                                        + "\n"
                                        + "###....##\n"
                                        + "...#..#..\n"
                                        + "###.##.##\n"
                                        + "##.####.#\n"
                                        + "##.#..#.#\n"
                                        + "...#..#..\n"
                                        + "###....##\n"
                                        + "###....##\n"
                                        + "...#####.\n"
                                        + "####..###\n"
                                        + "##.####.#\n"
                                        + "\n"
                                        + ".#..##.#.##..###.\n"
                                        + ".#...##.#.#.#...#\n"
                                        + ".#...#.#....#.#.#\n"
                                        + "..#..#####...##.#\n"
                                        + "..#..#####...##.#\n"
                                        + ".#...#.#....#.#.#\n"
                                        + ".#...##.#.#.#...#\n"
                                        + ".#..##.#.##..###.\n"
                                        + "##..#.##.#.###..#\n"
                                        + "#...#..###...###.\n"
                                        + "..#..#.#.####.###\n"
                                        + "..##.#.#.##.##...\n"
                                        + "..##.#.#.##.##...\n"
                                        + "..#..###.####.###\n"
                                        + "#...#..###...###.\n"
                                        + "##..#.##.#.###..#\n"
                                        + ".#..##.#.##..###.\n"
                                        + "\n"
                                        + "##.############.#\n"
                                        + "###.#.######.#.##\n"
                                        + "..##.#..##..####.\n"
                                        + "##.#..#.##.#..#.#\n"
                                        + "..#####....#####.\n"
                                        + "##...#..##..#...#\n"
                                        + "..#.#.#....#.#.#.\n"
                                        + "...#..#.##.#..#..\n"
                                        + "..#.##..##..##.#.\n"
                                        + "........##.......\n"
                                        + "###..##.##.##..##\n"
                                        + "##...#.####.#...#\n"
                                        + "..#.##.####.##.#.\n"
                                        + ".....#......#....\n"
                                        + "#####.#....#.####\n"
                                        + "..#..########..#.\n"
                                        + "#####.######.####\n"
                                        + "\n"
                                        + ".###.#.#....#\n"
                                        + "..##.#.#....#\n"
                                        + "#.#.#.##....#\n"
                                        + "###.#.##....#\n"
                                        + ".##.###..##..\n"
                                        + "#.#..#.######\n"
                                        + "#..###.......\n"
                                        + "\n"
                                        + "....##..##...\n"
                                        + "##..#....#..#\n"
                                        + "###.######.##\n"
                                        + "##..##..##..#\n"
                                        + "######..#####\n"
                                        + ".....####....\n"
                                        + "#####....####\n"
                                        + "#...#....#...\n"
                                        + ".....#..#....\n"
                                        + "...#.####.#..\n"
                                        + "##.#..##..#.#\n"
                                        + "\n"
                                        + "..###..####\n"
                                        + "..#..##.###\n"
                                        + ".###..#....\n"
                                        + ".###..#....\n"
                                        + "..#..##.###\n"
                                        + "..####.####\n"
                                        + "#..##.#....\n"
                                        + "\n"
                                        + "##.##...#....\n"
                                        + "###.#.#.##..#\n"
                                        + "........##.#.\n"
                                        + "######....##.\n"
                                        + "#..#.....##..\n"
                                        + "###.##.#.#..#\n"
                                        + "##...#..#..#.\n"
                                        + "##.##..#.#.##\n"
                                        + "##.##..######\n"
                                        + "....#..#####.\n"
                                        + "...#.....###.\n"
                                        + "...#.....###.\n"
                                        + "....#..#####.\n"
                                        + "##.##..######\n"
                                        + "##.##..#.#.##\n"
                                        + "\n"
                                        + "...#...#####.\n"
                                        + "..##.##..##..\n"
                                        + "..##.##..##..\n"
                                        + "...#...#####.\n"
                                        + "##...#.###..#\n"
                                        + "###....#.#...\n"
                                        + "#.###.#..##..\n"
                                        + "#.##.#..#....\n"
                                        + "#.##.#..#.#..\n"
                                        + "\n"
                                        + "#....###..#.#\n"
                                        + "#....###..#.#\n"
                                        + ".####.##.....\n"
                                        + ".####..##.#..\n"
                                        + ".#..#..#.###.\n"
                                        + "..##....#...#\n"
                                        + ".####.#...#..\n"
                                        + "#....#.##...#\n"
                                        + ".........#.##\n"
                                        + "..##..#..#..#\n"
                                        + "........#.#..\n"
                                        + "#.##.#....##.\n"
                                        + "#....#.##.###\n"
                                        + ".####..#.##.#\n"
                                        + ".#..#....##..\n"
                                        + "#.##.##.....#\n"
                                        + "#.#..#..###..\n"
                                        + "\n"
                                        + "...###.\n"
                                        + "..#####\n"
                                        + "...#.##\n"
                                        + "####.##\n"
                                        + "##.###.\n"
                                        + "#.#...#\n"
                                        + "....##.\n"
                                        + "##...##\n"
                                        + "##...##\n"
                                        + "\n"
                                        + "..######.\n"
                                        + "##..##..#\n"
                                        + "##..##..#\n"
                                        + "..#....#.\n"
                                        + "..#.##.#.\n"
                                        + "###.##.##\n"
                                        + "..#....#.\n"
                                        + "....##...\n"
                                        + ".##....##\n"
                                        + "##.#..#.#\n"
                                        + "##.#..#.#\n"
                                        + "###.##.##\n"
                                        + "...#..#..\n"
                                        + "##..##..#\n"
                                        + "..#.##.#.\n"
                                        + "...####..\n"
                                        + "..#....#.\n"
                                        + "\n"
                                        + "####.##..####\n"
                                        + "...#.#.#..#.#\n"
                                        + "##.###.....#.\n"
                                        + "##.###.....#.\n"
                                        + ".....#.#..#.#\n"
                                        + "####.##..####\n"
                                        + "###.#...##.#.\n"
                                        + "\n"
                                        + "#.#............\n"
                                        + "###.#..........\n"
                                        + "...######..####\n"
                                        + "###.#..#.##.#..\n"
                                        + ".#....##.##.##.\n"
                                        + "###...##.##.##.\n"
                                        + "..#.#....##....\n"
                                        + "\n"
                                        + "########.##.#\n"
                                        + "#.####.#####.\n"
                                        + "##########.##\n"
                                        + "######.#.###.\n"
                                        + "..#..#..##...\n"
                                        + "#.#..#.#..###\n"
                                        + "..#..#...###.\n"
                                        + "...##...###..\n"
                                        + "#..##..##...#\n"
                                        + "##.##.###.##.\n"
                                        + "##.##.###.##.\n"
                                        + "\n"
                                        + "###.#####.#\n"
                                        + "###.#####.#\n"
                                        + "#..##.####.\n"
                                        + "####.#...#.\n"
                                        + "#.....#..##\n"
                                        + ".##.#..##.#\n"
                                        + "##.##.#...#\n"
                                        + "##.##.#...#\n"
                                        + ".#..#..##.#\n"
                                        + "#.....#..##\n"
                                        + "####.#...#.";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT)));
        Util.time(() -> a(Input.parse(INPUT)));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
