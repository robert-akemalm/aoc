package aoc2024;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.function.Function;
import java.util.stream.Collectors;

public class Day5 {
    private static void a(Input input) {
        Map<Integer, Set<Integer>> pageToPagesBefore = new HashMap<>();
        for (Rule rule : input.rules) {
            pageToPagesBefore.computeIfAbsent(rule.after, k -> new HashSet<>()).add(rule.before);
        }

        long sum = 0;
        for (Update update : input.updates) {
            if (update.valid(page -> pageToPagesBefore.getOrDefault(page, Set.of()))) {
                sum += update.pages[update.pages.length / 2];
            }
        }
        System.out.println(sum);
    }

    private static void b(Input input) {
        Map<Integer, Set<Integer>> pageToPagesBefore = new HashMap<>();
        for (Rule rule : input.rules) {
            pageToPagesBefore.computeIfAbsent(rule.after, k -> new HashSet<>()).add(rule.before);
        }

        long sum = 0;
        for (Update update : input.updates) {
            if (!update.valid(page -> pageToPagesBefore.getOrDefault(page, Set.of()))) {
                update = update.fix(page -> pageToPagesBefore.getOrDefault(page, Set.of()));;
                sum += update.pages[update.pages.length / 2];
            }
        }
        System.out.println(sum);
    }

    record Rule(int before, int after) {}

    record Update(int[] pages) {
        boolean valid(Function<Integer, Set<Integer>> pageToPagesBefore) {
            for (int i = 0; i < pages.length; i++) {
                int page = pages[i];
                Set<Integer> mustBeBefore = pageToPagesBefore.apply(page);
                for (int j = i + 1; j < pages.length; j++) {
                    int laterPage = pages[j];
                    if (mustBeBefore.contains(laterPage)) {
                        return false;
                    }
                }
            }
            return true;
        }

        Update fix(Function<Integer, Set<Integer>> pageToPagesBefore) {
            List<Integer> fixed = new ArrayList<>();
            Set<Integer> pages = Arrays.stream(pages()).boxed().collect(Collectors.toSet());
            while (fixed.size() < this.pages.length) {
                for (int page : pages) {
                    if (pageToPagesBefore.apply(page).stream().noneMatch(pages::contains)) {
                        fixed.add(page);
                        pages.remove(page);
                        break;
                    }
                }
            }
            return new Update(fixed.stream().mapToInt(Integer::intValue).toArray());
        }
    }

    record Input(List<Rule> rules, List<Update> updates) {
        static Input parse(String input) {
            List<Rule> rules = new ArrayList<>();
            List<Update> updates = new ArrayList<>();
            input.lines().forEach(line -> {
                if (line.contains("|")) {
                    int[] beforeAfter = Util.extractInts(line);
                    int before = beforeAfter[0];
                    int after = beforeAfter[1];
                    rules.add(new Rule(before, after));
                } else if (line.contains(",")) {
                    updates.add(new Update(Util.extractInts(line)));
                }
            });

            return new Input(rules, updates);
        }
    }

    private static final String TEST_INPUT = "47|53\n"
                                             + "97|13\n"
                                             + "97|61\n"
                                             + "97|47\n"
                                             + "75|29\n"
                                             + "61|13\n"
                                             + "75|53\n"
                                             + "29|13\n"
                                             + "97|29\n"
                                             + "53|29\n"
                                             + "61|53\n"
                                             + "97|53\n"
                                             + "61|29\n"
                                             + "47|13\n"
                                             + "75|47\n"
                                             + "97|75\n"
                                             + "47|61\n"
                                             + "75|61\n"
                                             + "47|29\n"
                                             + "75|13\n"
                                             + "53|13\n"
                                             + "\n"
                                             + "75,47,61,53,29\n"
                                             + "97,61,53,29,13\n"
                                             + "75,29,13\n"
                                             + "75,97,47,61,53\n"
                                             + "61,13,29\n"
                                             + "97,13,75,29,47";

    private static final String INPUT = "77|76\n"
                                        + "22|91\n"
                                        + "22|76\n"
                                        + "42|25\n"
                                        + "42|76\n"
                                        + "42|84\n"
                                        + "34|25\n"
                                        + "34|37\n"
                                        + "34|21\n"
                                        + "34|82\n"
                                        + "21|11\n"
                                        + "21|79\n"
                                        + "21|77\n"
                                        + "21|19\n"
                                        + "21|58\n"
                                        + "82|98\n"
                                        + "82|19\n"
                                        + "82|89\n"
                                        + "82|85\n"
                                        + "82|21\n"
                                        + "82|41\n"
                                        + "76|81\n"
                                        + "76|16\n"
                                        + "76|29\n"
                                        + "76|25\n"
                                        + "76|57\n"
                                        + "76|66\n"
                                        + "76|45\n"
                                        + "29|54\n"
                                        + "29|61\n"
                                        + "29|78\n"
                                        + "29|82\n"
                                        + "29|75\n"
                                        + "29|98\n"
                                        + "29|89\n"
                                        + "29|46\n"
                                        + "63|42\n"
                                        + "63|11\n"
                                        + "63|83\n"
                                        + "63|57\n"
                                        + "63|79\n"
                                        + "63|91\n"
                                        + "63|22\n"
                                        + "63|69\n"
                                        + "63|53\n"
                                        + "75|49\n"
                                        + "75|79\n"
                                        + "75|28\n"
                                        + "75|77\n"
                                        + "75|11\n"
                                        + "75|63\n"
                                        + "75|22\n"
                                        + "75|74\n"
                                        + "75|83\n"
                                        + "75|71\n"
                                        + "35|53\n"
                                        + "35|17\n"
                                        + "35|12\n"
                                        + "35|42\n"
                                        + "35|15\n"
                                        + "35|41\n"
                                        + "35|63\n"
                                        + "35|34\n"
                                        + "35|31\n"
                                        + "35|79\n"
                                        + "35|83\n"
                                        + "85|99\n"
                                        + "85|63\n"
                                        + "85|41\n"
                                        + "85|28\n"
                                        + "85|19\n"
                                        + "85|77\n"
                                        + "85|35\n"
                                        + "85|71\n"
                                        + "85|65\n"
                                        + "85|11\n"
                                        + "85|79\n"
                                        + "85|56\n"
                                        + "37|82\n"
                                        + "37|71\n"
                                        + "37|41\n"
                                        + "37|99\n"
                                        + "37|75\n"
                                        + "37|85\n"
                                        + "37|16\n"
                                        + "37|79\n"
                                        + "37|46\n"
                                        + "37|98\n"
                                        + "37|28\n"
                                        + "37|77\n"
                                        + "37|19\n"
                                        + "99|79\n"
                                        + "99|17\n"
                                        + "99|12\n"
                                        + "99|28\n"
                                        + "99|42\n"
                                        + "99|11\n"
                                        + "99|56\n"
                                        + "99|15\n"
                                        + "99|83\n"
                                        + "99|77\n"
                                        + "99|35\n"
                                        + "99|23\n"
                                        + "99|53\n"
                                        + "99|63\n"
                                        + "65|75\n"
                                        + "65|15\n"
                                        + "65|31\n"
                                        + "65|77\n"
                                        + "65|22\n"
                                        + "65|71\n"
                                        + "65|58\n"
                                        + "65|56\n"
                                        + "65|17\n"
                                        + "65|63\n"
                                        + "65|28\n"
                                        + "65|74\n"
                                        + "65|79\n"
                                        + "65|83\n"
                                        + "65|41\n"
                                        + "16|78\n"
                                        + "16|98\n"
                                        + "16|42\n"
                                        + "16|49\n"
                                        + "16|28\n"
                                        + "16|79\n"
                                        + "16|77\n"
                                        + "16|85\n"
                                        + "16|35\n"
                                        + "16|56\n"
                                        + "16|41\n"
                                        + "16|75\n"
                                        + "16|22\n"
                                        + "16|46\n"
                                        + "16|58\n"
                                        + "16|12\n"
                                        + "66|82\n"
                                        + "66|19\n"
                                        + "66|63\n"
                                        + "66|85\n"
                                        + "66|41\n"
                                        + "66|75\n"
                                        + "66|71\n"
                                        + "66|77\n"
                                        + "66|17\n"
                                        + "66|28\n"
                                        + "66|54\n"
                                        + "66|46\n"
                                        + "66|78\n"
                                        + "66|98\n"
                                        + "66|89\n"
                                        + "66|21\n"
                                        + "66|65\n"
                                        + "45|65\n"
                                        + "45|41\n"
                                        + "45|78\n"
                                        + "45|63\n"
                                        + "45|56\n"
                                        + "45|71\n"
                                        + "45|99\n"
                                        + "45|75\n"
                                        + "45|35\n"
                                        + "45|21\n"
                                        + "45|85\n"
                                        + "45|17\n"
                                        + "45|46\n"
                                        + "45|79\n"
                                        + "45|98\n"
                                        + "45|66\n"
                                        + "45|89\n"
                                        + "45|54\n"
                                        + "17|81\n"
                                        + "17|23\n"
                                        + "17|53\n"
                                        + "17|15\n"
                                        + "17|74\n"
                                        + "17|61\n"
                                        + "17|11\n"
                                        + "17|76\n"
                                        + "17|29\n"
                                        + "17|94\n"
                                        + "17|25\n"
                                        + "17|84\n"
                                        + "17|31\n"
                                        + "17|83\n"
                                        + "17|34\n"
                                        + "17|91\n"
                                        + "17|69\n"
                                        + "17|37\n"
                                        + "17|86\n"
                                        + "54|65\n"
                                        + "54|16\n"
                                        + "54|78\n"
                                        + "54|77\n"
                                        + "54|11\n"
                                        + "54|56\n"
                                        + "54|46\n"
                                        + "54|35\n"
                                        + "54|63\n"
                                        + "54|99\n"
                                        + "54|19\n"
                                        + "54|71\n"
                                        + "54|41\n"
                                        + "54|42\n"
                                        + "54|17\n"
                                        + "54|21\n"
                                        + "54|28\n"
                                        + "54|79\n"
                                        + "54|75\n"
                                        + "54|98\n"
                                        + "91|78\n"
                                        + "91|16\n"
                                        + "91|81\n"
                                        + "91|89\n"
                                        + "91|99\n"
                                        + "91|46\n"
                                        + "91|45\n"
                                        + "91|61\n"
                                        + "91|84\n"
                                        + "91|25\n"
                                        + "91|21\n"
                                        + "91|85\n"
                                        + "91|35\n"
                                        + "91|65\n"
                                        + "91|69\n"
                                        + "91|66\n"
                                        + "91|37\n"
                                        + "91|57\n"
                                        + "91|29\n"
                                        + "91|54\n"
                                        + "91|76\n"
                                        + "11|76\n"
                                        + "11|57\n"
                                        + "11|34\n"
                                        + "11|69\n"
                                        + "11|81\n"
                                        + "11|37\n"
                                        + "11|25\n"
                                        + "11|94\n"
                                        + "11|61\n"
                                        + "11|15\n"
                                        + "11|53\n"
                                        + "11|74\n"
                                        + "11|23\n"
                                        + "11|29\n"
                                        + "11|31\n"
                                        + "11|42\n"
                                        + "11|83\n"
                                        + "11|84\n"
                                        + "11|45\n"
                                        + "11|91\n"
                                        + "11|22\n"
                                        + "11|86\n"
                                        + "31|45\n"
                                        + "31|57\n"
                                        + "31|37\n"
                                        + "31|78\n"
                                        + "31|54\n"
                                        + "31|34\n"
                                        + "31|66\n"
                                        + "31|16\n"
                                        + "31|85\n"
                                        + "31|69\n"
                                        + "31|21\n"
                                        + "31|25\n"
                                        + "31|94\n"
                                        + "31|46\n"
                                        + "31|61\n"
                                        + "31|99\n"
                                        + "31|86\n"
                                        + "31|29\n"
                                        + "31|82\n"
                                        + "31|76\n"
                                        + "31|84\n"
                                        + "31|91\n"
                                        + "31|81\n"
                                        + "46|23\n"
                                        + "46|11\n"
                                        + "46|42\n"
                                        + "46|41\n"
                                        + "46|77\n"
                                        + "46|75\n"
                                        + "46|15\n"
                                        + "46|78\n"
                                        + "46|17\n"
                                        + "46|28\n"
                                        + "46|79\n"
                                        + "46|35\n"
                                        + "46|65\n"
                                        + "46|19\n"
                                        + "46|56\n"
                                        + "46|98\n"
                                        + "46|22\n"
                                        + "46|63\n"
                                        + "46|89\n"
                                        + "46|58\n"
                                        + "46|12\n"
                                        + "46|49\n"
                                        + "46|99\n"
                                        + "46|71\n"
                                        + "71|23\n"
                                        + "71|11\n"
                                        + "71|91\n"
                                        + "71|29\n"
                                        + "71|31\n"
                                        + "71|17\n"
                                        + "71|12\n"
                                        + "71|74\n"
                                        + "71|57\n"
                                        + "71|86\n"
                                        + "71|81\n"
                                        + "71|83\n"
                                        + "71|28\n"
                                        + "71|69\n"
                                        + "71|58\n"
                                        + "71|25\n"
                                        + "71|15\n"
                                        + "71|42\n"
                                        + "71|34\n"
                                        + "71|22\n"
                                        + "71|76\n"
                                        + "71|53\n"
                                        + "71|49\n"
                                        + "71|94\n"
                                        + "86|25\n"
                                        + "86|78\n"
                                        + "86|69\n"
                                        + "86|85\n"
                                        + "86|75\n"
                                        + "86|82\n"
                                        + "86|65\n"
                                        + "86|54\n"
                                        + "86|77\n"
                                        + "86|16\n"
                                        + "86|89\n"
                                        + "86|84\n"
                                        + "86|57\n"
                                        + "86|46\n"
                                        + "86|99\n"
                                        + "86|37\n"
                                        + "86|45\n"
                                        + "86|81\n"
                                        + "86|19\n"
                                        + "86|98\n"
                                        + "86|35\n"
                                        + "86|66\n"
                                        + "86|21\n"
                                        + "86|61\n"
                                        + "94|85\n"
                                        + "94|57\n"
                                        + "94|76\n"
                                        + "94|99\n"
                                        + "94|25\n"
                                        + "94|81\n"
                                        + "94|61\n"
                                        + "94|21\n"
                                        + "94|37\n"
                                        + "94|66\n"
                                        + "94|82\n"
                                        + "94|54\n"
                                        + "94|69\n"
                                        + "94|34\n"
                                        + "94|86\n"
                                        + "94|84\n"
                                        + "94|45\n"
                                        + "94|29\n"
                                        + "94|78\n"
                                        + "94|89\n"
                                        + "94|98\n"
                                        + "94|16\n"
                                        + "94|91\n"
                                        + "94|46\n"
                                        + "23|86\n"
                                        + "23|53\n"
                                        + "23|34\n"
                                        + "23|16\n"
                                        + "23|82\n"
                                        + "23|61\n"
                                        + "23|91\n"
                                        + "23|29\n"
                                        + "23|66\n"
                                        + "23|37\n"
                                        + "23|84\n"
                                        + "23|74\n"
                                        + "23|85\n"
                                        + "23|45\n"
                                        + "23|94\n"
                                        + "23|76\n"
                                        + "23|81\n"
                                        + "23|21\n"
                                        + "23|57\n"
                                        + "23|25\n"
                                        + "23|54\n"
                                        + "23|83\n"
                                        + "23|31\n"
                                        + "23|69\n"
                                        + "58|45\n"
                                        + "58|22\n"
                                        + "58|91\n"
                                        + "58|31\n"
                                        + "58|86\n"
                                        + "58|25\n"
                                        + "58|81\n"
                                        + "58|84\n"
                                        + "58|76\n"
                                        + "58|15\n"
                                        + "58|34\n"
                                        + "58|94\n"
                                        + "58|66\n"
                                        + "58|83\n"
                                        + "58|74\n"
                                        + "58|69\n"
                                        + "58|54\n"
                                        + "58|37\n"
                                        + "58|23\n"
                                        + "58|61\n"
                                        + "58|57\n"
                                        + "58|29\n"
                                        + "58|53\n"
                                        + "58|82\n"
                                        + "81|35\n"
                                        + "81|16\n"
                                        + "81|65\n"
                                        + "81|19\n"
                                        + "81|82\n"
                                        + "81|41\n"
                                        + "81|61\n"
                                        + "81|99\n"
                                        + "81|21\n"
                                        + "81|45\n"
                                        + "81|89\n"
                                        + "81|75\n"
                                        + "81|66\n"
                                        + "81|78\n"
                                        + "81|37\n"
                                        + "81|56\n"
                                        + "81|84\n"
                                        + "81|77\n"
                                        + "81|98\n"
                                        + "81|85\n"
                                        + "81|54\n"
                                        + "81|46\n"
                                        + "81|63\n"
                                        + "81|25\n"
                                        + "56|42\n"
                                        + "56|94\n"
                                        + "56|22\n"
                                        + "56|34\n"
                                        + "56|17\n"
                                        + "56|86\n"
                                        + "56|15\n"
                                        + "56|76\n"
                                        + "56|29\n"
                                        + "56|23\n"
                                        + "56|83\n"
                                        + "56|91\n"
                                        + "56|71\n"
                                        + "56|31\n"
                                        + "56|28\n"
                                        + "56|63\n"
                                        + "56|53\n"
                                        + "56|11\n"
                                        + "56|69\n"
                                        + "56|74\n"
                                        + "56|12\n"
                                        + "56|49\n"
                                        + "56|79\n"
                                        + "56|58\n"
                                        + "84|66\n"
                                        + "84|19\n"
                                        + "84|65\n"
                                        + "84|41\n"
                                        + "84|21\n"
                                        + "84|56\n"
                                        + "84|98\n"
                                        + "84|71\n"
                                        + "84|79\n"
                                        + "84|35\n"
                                        + "84|12\n"
                                        + "84|28\n"
                                        + "84|89\n"
                                        + "84|82\n"
                                        + "84|99\n"
                                        + "84|16\n"
                                        + "84|46\n"
                                        + "84|85\n"
                                        + "84|75\n"
                                        + "84|45\n"
                                        + "84|78\n"
                                        + "84|77\n"
                                        + "84|63\n"
                                        + "84|54\n"
                                        + "69|81\n"
                                        + "69|75\n"
                                        + "69|65\n"
                                        + "69|78\n"
                                        + "69|19\n"
                                        + "69|16\n"
                                        + "69|46\n"
                                        + "69|54\n"
                                        + "69|84\n"
                                        + "69|82\n"
                                        + "69|45\n"
                                        + "69|66\n"
                                        + "69|21\n"
                                        + "69|25\n"
                                        + "69|89\n"
                                        + "69|35\n"
                                        + "69|77\n"
                                        + "69|37\n"
                                        + "69|85\n"
                                        + "69|41\n"
                                        + "69|98\n"
                                        + "69|57\n"
                                        + "69|99\n"
                                        + "69|61\n"
                                        + "41|86\n"
                                        + "41|12\n"
                                        + "41|28\n"
                                        + "41|74\n"
                                        + "41|56\n"
                                        + "41|29\n"
                                        + "41|63\n"
                                        + "41|31\n"
                                        + "41|23\n"
                                        + "41|91\n"
                                        + "41|22\n"
                                        + "41|17\n"
                                        + "41|83\n"
                                        + "41|11\n"
                                        + "41|42\n"
                                        + "41|94\n"
                                        + "41|53\n"
                                        + "41|58\n"
                                        + "41|76\n"
                                        + "41|71\n"
                                        + "41|49\n"
                                        + "41|79\n"
                                        + "41|34\n"
                                        + "41|15\n"
                                        + "53|83\n"
                                        + "53|21\n"
                                        + "53|54\n"
                                        + "53|34\n"
                                        + "53|69\n"
                                        + "53|16\n"
                                        + "53|61\n"
                                        + "53|81\n"
                                        + "53|76\n"
                                        + "53|57\n"
                                        + "53|37\n"
                                        + "53|66\n"
                                        + "53|46\n"
                                        + "53|45\n"
                                        + "53|84\n"
                                        + "53|74\n"
                                        + "53|85\n"
                                        + "53|91\n"
                                        + "53|31\n"
                                        + "53|94\n"
                                        + "53|82\n"
                                        + "53|86\n"
                                        + "53|25\n"
                                        + "53|29\n"
                                        + "83|74\n"
                                        + "83|81\n"
                                        + "83|25\n"
                                        + "83|76\n"
                                        + "83|91\n"
                                        + "83|37\n"
                                        + "83|86\n"
                                        + "83|66\n"
                                        + "83|85\n"
                                        + "83|34\n"
                                        + "83|31\n"
                                        + "83|61\n"
                                        + "83|46\n"
                                        + "83|16\n"
                                        + "83|69\n"
                                        + "83|21\n"
                                        + "83|94\n"
                                        + "83|54\n"
                                        + "83|45\n"
                                        + "83|57\n"
                                        + "83|29\n"
                                        + "83|84\n"
                                        + "83|82\n"
                                        + "83|98\n"
                                        + "61|21\n"
                                        + "61|82\n"
                                        + "61|99\n"
                                        + "61|65\n"
                                        + "61|46\n"
                                        + "61|85\n"
                                        + "61|79\n"
                                        + "61|19\n"
                                        + "61|84\n"
                                        + "61|71\n"
                                        + "61|89\n"
                                        + "61|56\n"
                                        + "61|16\n"
                                        + "61|63\n"
                                        + "61|54\n"
                                        + "61|35\n"
                                        + "61|98\n"
                                        + "61|37\n"
                                        + "61|41\n"
                                        + "61|78\n"
                                        + "61|66\n"
                                        + "61|45\n"
                                        + "61|77\n"
                                        + "61|75\n"
                                        + "12|11\n"
                                        + "12|53\n"
                                        + "12|23\n"
                                        + "12|81\n"
                                        + "12|91\n"
                                        + "12|94\n"
                                        + "12|69\n"
                                        + "12|86\n"
                                        + "12|15\n"
                                        + "12|34\n"
                                        + "12|74\n"
                                        + "12|22\n"
                                        + "12|17\n"
                                        + "12|76\n"
                                        + "12|25\n"
                                        + "12|31\n"
                                        + "12|58\n"
                                        + "12|29\n"
                                        + "12|42\n"
                                        + "12|49\n"
                                        + "12|83\n"
                                        + "12|61\n"
                                        + "12|37\n"
                                        + "12|57\n"
                                        + "15|16\n"
                                        + "15|84\n"
                                        + "15|53\n"
                                        + "15|29\n"
                                        + "15|83\n"
                                        + "15|25\n"
                                        + "15|76\n"
                                        + "15|82\n"
                                        + "15|21\n"
                                        + "15|61\n"
                                        + "15|66\n"
                                        + "15|45\n"
                                        + "15|37\n"
                                        + "15|31\n"
                                        + "15|54\n"
                                        + "15|74\n"
                                        + "15|23\n"
                                        + "15|91\n"
                                        + "15|86\n"
                                        + "15|69\n"
                                        + "15|81\n"
                                        + "15|57\n"
                                        + "15|34\n"
                                        + "15|94\n"
                                        + "78|79\n"
                                        + "78|53\n"
                                        + "78|56\n"
                                        + "78|71\n"
                                        + "78|23\n"
                                        + "78|83\n"
                                        + "78|89\n"
                                        + "78|74\n"
                                        + "78|15\n"
                                        + "78|41\n"
                                        + "78|28\n"
                                        + "78|63\n"
                                        + "78|77\n"
                                        + "78|17\n"
                                        + "78|58\n"
                                        + "78|49\n"
                                        + "78|19\n"
                                        + "78|12\n"
                                        + "78|11\n"
                                        + "78|42\n"
                                        + "78|75\n"
                                        + "78|35\n"
                                        + "78|22\n"
                                        + "78|65\n"
                                        + "89|83\n"
                                        + "89|31\n"
                                        + "89|53\n"
                                        + "89|42\n"
                                        + "89|75\n"
                                        + "89|15\n"
                                        + "89|63\n"
                                        + "89|74\n"
                                        + "89|71\n"
                                        + "89|41\n"
                                        + "89|17\n"
                                        + "89|58\n"
                                        + "89|79\n"
                                        + "89|23\n"
                                        + "89|49\n"
                                        + "89|12\n"
                                        + "89|19\n"
                                        + "89|28\n"
                                        + "89|65\n"
                                        + "89|56\n"
                                        + "89|11\n"
                                        + "89|22\n"
                                        + "89|77\n"
                                        + "89|35\n"
                                        + "98|71\n"
                                        + "98|19\n"
                                        + "98|79\n"
                                        + "98|12\n"
                                        + "98|65\n"
                                        + "98|41\n"
                                        + "98|23\n"
                                        + "98|89\n"
                                        + "98|53\n"
                                        + "98|75\n"
                                        + "98|77\n"
                                        + "98|28\n"
                                        + "98|56\n"
                                        + "98|17\n"
                                        + "98|49\n"
                                        + "98|35\n"
                                        + "98|99\n"
                                        + "98|11\n"
                                        + "98|22\n"
                                        + "98|15\n"
                                        + "98|58\n"
                                        + "98|63\n"
                                        + "98|42\n"
                                        + "98|78\n"
                                        + "57|25\n"
                                        + "57|37\n"
                                        + "57|89\n"
                                        + "57|56\n"
                                        + "57|66\n"
                                        + "57|81\n"
                                        + "57|77\n"
                                        + "57|35\n"
                                        + "57|41\n"
                                        + "57|21\n"
                                        + "57|46\n"
                                        + "57|84\n"
                                        + "57|75\n"
                                        + "57|98\n"
                                        + "57|78\n"
                                        + "57|99\n"
                                        + "57|54\n"
                                        + "57|16\n"
                                        + "57|61\n"
                                        + "57|85\n"
                                        + "57|19\n"
                                        + "57|82\n"
                                        + "57|45\n"
                                        + "57|65\n"
                                        + "49|61\n"
                                        + "49|34\n"
                                        + "49|37\n"
                                        + "49|53\n"
                                        + "49|84\n"
                                        + "49|42\n"
                                        + "49|22\n"
                                        + "49|45\n"
                                        + "49|76\n"
                                        + "49|25\n"
                                        + "49|91\n"
                                        + "49|29\n"
                                        + "49|83\n"
                                        + "49|94\n"
                                        + "49|58\n"
                                        + "49|23\n"
                                        + "49|74\n"
                                        + "49|81\n"
                                        + "49|86\n"
                                        + "49|15\n"
                                        + "49|11\n"
                                        + "49|57\n"
                                        + "49|69\n"
                                        + "49|31\n"
                                        + "28|53\n"
                                        + "28|42\n"
                                        + "28|58\n"
                                        + "28|49\n"
                                        + "28|17\n"
                                        + "28|91\n"
                                        + "28|74\n"
                                        + "28|15\n"
                                        + "28|31\n"
                                        + "28|23\n"
                                        + "28|25\n"
                                        + "28|57\n"
                                        + "28|94\n"
                                        + "28|29\n"
                                        + "28|34\n"
                                        + "28|22\n"
                                        + "28|12\n"
                                        + "28|86\n"
                                        + "28|61\n"
                                        + "28|11\n"
                                        + "28|83\n"
                                        + "28|76\n"
                                        + "28|81\n"
                                        + "28|69\n"
                                        + "79|29\n"
                                        + "79|91\n"
                                        + "79|17\n"
                                        + "79|34\n"
                                        + "79|28\n"
                                        + "79|69\n"
                                        + "79|83\n"
                                        + "79|86\n"
                                        + "79|58\n"
                                        + "79|71\n"
                                        + "79|31\n"
                                        + "79|22\n"
                                        + "79|42\n"
                                        + "79|11\n"
                                        + "79|15\n"
                                        + "79|81\n"
                                        + "79|94\n"
                                        + "79|23\n"
                                        + "79|76\n"
                                        + "79|57\n"
                                        + "79|49\n"
                                        + "79|12\n"
                                        + "79|53\n"
                                        + "79|74\n"
                                        + "19|77\n"
                                        + "19|76\n"
                                        + "19|15\n"
                                        + "19|31\n"
                                        + "19|42\n"
                                        + "19|83\n"
                                        + "19|91\n"
                                        + "19|49\n"
                                        + "19|74\n"
                                        + "19|94\n"
                                        + "19|41\n"
                                        + "19|17\n"
                                        + "19|12\n"
                                        + "19|56\n"
                                        + "19|11\n"
                                        + "19|71\n"
                                        + "19|23\n"
                                        + "19|79\n"
                                        + "19|53\n"
                                        + "19|22\n"
                                        + "19|58\n"
                                        + "19|34\n"
                                        + "19|28\n"
                                        + "19|63\n"
                                        + "74|46\n"
                                        + "74|84\n"
                                        + "74|21\n"
                                        + "74|16\n"
                                        + "74|99\n"
                                        + "74|34\n"
                                        + "74|94\n"
                                        + "74|31\n"
                                        + "74|45\n"
                                        + "74|66\n"
                                        + "74|25\n"
                                        + "74|86\n"
                                        + "74|81\n"
                                        + "74|57\n"
                                        + "74|29\n"
                                        + "74|54\n"
                                        + "74|61\n"
                                        + "74|82\n"
                                        + "74|69\n"
                                        + "74|37\n"
                                        + "74|91\n"
                                        + "74|98\n"
                                        + "74|76\n"
                                        + "74|85\n"
                                        + "25|89\n"
                                        + "25|99\n"
                                        + "25|41\n"
                                        + "25|61\n"
                                        + "25|37\n"
                                        + "25|35\n"
                                        + "25|45\n"
                                        + "25|77\n"
                                        + "25|82\n"
                                        + "25|54\n"
                                        + "25|84\n"
                                        + "25|85\n"
                                        + "25|46\n"
                                        + "25|21\n"
                                        + "25|63\n"
                                        + "25|66\n"
                                        + "25|98\n"
                                        + "25|79\n"
                                        + "25|19\n"
                                        + "25|65\n"
                                        + "25|75\n"
                                        + "25|78\n"
                                        + "25|16\n"
                                        + "25|56\n"
                                        + "77|74\n"
                                        + "77|11\n"
                                        + "77|79\n"
                                        + "77|42\n"
                                        + "77|28\n"
                                        + "77|17\n"
                                        + "77|12\n"
                                        + "77|94\n"
                                        + "77|34\n"
                                        + "77|83\n"
                                        + "77|29\n"
                                        + "77|58\n"
                                        + "77|41\n"
                                        + "77|91\n"
                                        + "77|15\n"
                                        + "77|22\n"
                                        + "77|23\n"
                                        + "77|49\n"
                                        + "77|56\n"
                                        + "77|63\n"
                                        + "77|31\n"
                                        + "77|53\n"
                                        + "77|71\n"
                                        + "22|15\n"
                                        + "22|86\n"
                                        + "22|23\n"
                                        + "22|84\n"
                                        + "22|25\n"
                                        + "22|31\n"
                                        + "22|29\n"
                                        + "22|81\n"
                                        + "22|66\n"
                                        + "22|21\n"
                                        + "22|83\n"
                                        + "22|54\n"
                                        + "22|57\n"
                                        + "22|53\n"
                                        + "22|37\n"
                                        + "22|74\n"
                                        + "22|61\n"
                                        + "22|82\n"
                                        + "22|69\n"
                                        + "22|45\n"
                                        + "22|34\n"
                                        + "22|94\n"
                                        + "42|37\n"
                                        + "42|53\n"
                                        + "42|15\n"
                                        + "42|57\n"
                                        + "42|31\n"
                                        + "42|94\n"
                                        + "42|29\n"
                                        + "42|86\n"
                                        + "42|83\n"
                                        + "42|22\n"
                                        + "42|74\n"
                                        + "42|23\n"
                                        + "42|61\n"
                                        + "42|69\n"
                                        + "42|58\n"
                                        + "42|81\n"
                                        + "42|91\n"
                                        + "42|66\n"
                                        + "42|34\n"
                                        + "42|45\n"
                                        + "42|82\n"
                                        + "34|86\n"
                                        + "34|61\n"
                                        + "34|99\n"
                                        + "34|46\n"
                                        + "34|84\n"
                                        + "34|66\n"
                                        + "34|91\n"
                                        + "34|45\n"
                                        + "34|89\n"
                                        + "34|76\n"
                                        + "34|81\n"
                                        + "34|98\n"
                                        + "34|69\n"
                                        + "34|57\n"
                                        + "34|16\n"
                                        + "34|54\n"
                                        + "34|29\n"
                                        + "34|85\n"
                                        + "34|78\n"
                                        + "34|65\n"
                                        + "21|89\n"
                                        + "21|71\n"
                                        + "21|17\n"
                                        + "21|78\n"
                                        + "21|65\n"
                                        + "21|12\n"
                                        + "21|56\n"
                                        + "21|46\n"
                                        + "21|75\n"
                                        + "21|28\n"
                                        + "21|98\n"
                                        + "21|85\n"
                                        + "21|99\n"
                                        + "21|35\n"
                                        + "21|42\n"
                                        + "21|49\n"
                                        + "21|63\n"
                                        + "21|16\n"
                                        + "21|41\n"
                                        + "82|56\n"
                                        + "82|11\n"
                                        + "82|71\n"
                                        + "82|99\n"
                                        + "82|49\n"
                                        + "82|77\n"
                                        + "82|35\n"
                                        + "82|63\n"
                                        + "82|17\n"
                                        + "82|79\n"
                                        + "82|78\n"
                                        + "82|54\n"
                                        + "82|16\n"
                                        + "82|12\n"
                                        + "82|28\n"
                                        + "82|65\n"
                                        + "82|75\n"
                                        + "82|46\n"
                                        + "76|85\n"
                                        + "76|35\n"
                                        + "76|82\n"
                                        + "76|46\n"
                                        + "76|54\n"
                                        + "76|89\n"
                                        + "76|78\n"
                                        + "76|37\n"
                                        + "76|61\n"
                                        + "76|99\n"
                                        + "76|86\n"
                                        + "76|84\n"
                                        + "76|98\n"
                                        + "76|65\n"
                                        + "76|21\n"
                                        + "76|69\n"
                                        + "76|75\n"
                                        + "29|37\n"
                                        + "29|35\n"
                                        + "29|99\n"
                                        + "29|57\n"
                                        + "29|25\n"
                                        + "29|84\n"
                                        + "29|66\n"
                                        + "29|69\n"
                                        + "29|81\n"
                                        + "29|85\n"
                                        + "29|65\n"
                                        + "29|45\n"
                                        + "29|86\n"
                                        + "29|19\n"
                                        + "29|16\n"
                                        + "29|21\n"
                                        + "63|86\n"
                                        + "63|74\n"
                                        + "63|12\n"
                                        + "63|71\n"
                                        + "63|15\n"
                                        + "63|49\n"
                                        + "63|58\n"
                                        + "63|28\n"
                                        + "63|17\n"
                                        + "63|23\n"
                                        + "63|94\n"
                                        + "63|34\n"
                                        + "63|29\n"
                                        + "63|76\n"
                                        + "63|31\n"
                                        + "75|12\n"
                                        + "75|56\n"
                                        + "75|94\n"
                                        + "75|53\n"
                                        + "75|34\n"
                                        + "75|91\n"
                                        + "75|58\n"
                                        + "75|42\n"
                                        + "75|17\n"
                                        + "75|31\n"
                                        + "75|15\n"
                                        + "75|19\n"
                                        + "75|23\n"
                                        + "75|41\n"
                                        + "35|23\n"
                                        + "35|75\n"
                                        + "35|94\n"
                                        + "35|28\n"
                                        + "35|74\n"
                                        + "35|56\n"
                                        + "35|71\n"
                                        + "35|19\n"
                                        + "35|49\n"
                                        + "35|11\n"
                                        + "35|77\n"
                                        + "35|22\n"
                                        + "35|58\n"
                                        + "85|58\n"
                                        + "85|42\n"
                                        + "85|89\n"
                                        + "85|49\n"
                                        + "85|78\n"
                                        + "85|15\n"
                                        + "85|75\n"
                                        + "85|98\n"
                                        + "85|17\n"
                                        + "85|46\n"
                                        + "85|22\n"
                                        + "85|12\n"
                                        + "37|66\n"
                                        + "37|21\n"
                                        + "37|89\n"
                                        + "37|35\n"
                                        + "37|78\n"
                                        + "37|63\n"
                                        + "37|56\n"
                                        + "37|65\n"
                                        + "37|45\n"
                                        + "37|84\n"
                                        + "37|54\n"
                                        + "99|22\n"
                                        + "99|75\n"
                                        + "99|71\n"
                                        + "99|49\n"
                                        + "99|41\n"
                                        + "99|78\n"
                                        + "99|19\n"
                                        + "99|65\n"
                                        + "99|89\n"
                                        + "99|58\n"
                                        + "65|19\n"
                                        + "65|94\n"
                                        + "65|11\n"
                                        + "65|23\n"
                                        + "65|35\n"
                                        + "65|12\n"
                                        + "65|49\n"
                                        + "65|42\n"
                                        + "65|53\n"
                                        + "16|71\n"
                                        + "16|65\n"
                                        + "16|19\n"
                                        + "16|89\n"
                                        + "16|17\n"
                                        + "16|63\n"
                                        + "16|11\n"
                                        + "16|99\n"
                                        + "66|56\n"
                                        + "66|79\n"
                                        + "66|35\n"
                                        + "66|12\n"
                                        + "66|99\n"
                                        + "66|49\n"
                                        + "66|16\n"
                                        + "45|77\n"
                                        + "45|12\n"
                                        + "45|16\n"
                                        + "45|82\n"
                                        + "45|19\n"
                                        + "45|28\n"
                                        + "17|58\n"
                                        + "17|22\n"
                                        + "17|42\n"
                                        + "17|49\n"
                                        + "17|57\n"
                                        + "54|85\n"
                                        + "54|89\n"
                                        + "54|12\n"
                                        + "54|49\n"
                                        + "91|98\n"
                                        + "91|82\n"
                                        + "91|86\n"
                                        + "11|58\n"
                                        + "11|66\n"
                                        + "31|98\n"
                                        + "\n"
                                        + "91,76,94,81,45,78,21\n"
                                        + "34,76,63,42,31,41,83,56,15,53,23,28,79,71,94,77,91,49,74\n"
                                        + "61,66,21,46,98,65,75\n"
                                        + "56,71,28,12,17,58,53,31,94,34,86\n"
                                        + "81,25,45,82,54,21,99,35,75\n"
                                        + "83,31,76,29,69,57,25,37,45,66,16,85,46\n"
                                        + "57,25,69,86,61,37,29,74,94,45,53,84,83,21,91,34,76,16,66,85,82\n"
                                        + "91,57,98,86,21,85,78,54,34,82,76,29,45,84,99,46,61,16,66,25,89\n"
                                        + "79,99,58,49,22,78,89,35,63,19,12,28,11,71,65,53,17\n"
                                        + "12,23,61,74,91,34,53\n"
                                        + "58,15,74,94,91,76,29,57,81,25,82\n"
                                        + "15,23,53,81,37,82,21\n"
                                        + "82,21,16,85,46,98,99,78,65,35,77,63,79,71,12,17,49\n"
                                        + "76,53,17,49,79,63,56,15,28,91,58,34,22,74,77\n"
                                        + "86,69,57,25,61,37,84,45,66,16,46,98,99,78,89,65,35,75,19\n"
                                        + "41,91,15,31,79,29,83,58,94,17,56,76,63\n"
                                        + "41,63,54,65,84,66,99,78,28,85,89,46,35,45,79,82,77\n"
                                        + "81,61,84,45,82,54,98,78,89\n"
                                        + "23,35,58,98,49,12,11\n"
                                        + "61,37,84,66,54,21,85,99,78,35,77,41,56,63,79\n"
                                        + "84,56,41,46,28,98,79\n"
                                        + "49,11,23,83,29,37,84\n"
                                        + "57,84,82,21,65,35,41\n"
                                        + "83,74,31,94,34,29,86,69,81,25,37,45,82,21,16,85,46\n"
                                        + "84,76,23,53,25\n"
                                        + "81,66,54,16,85,46,98,99,65,35,19,77,56\n"
                                        + "16,77,75,41,12,11,42,58,89\n"
                                        + "22,53,74,94,34,91,76,29,86,69,57,81,25,61,37,45,54\n"
                                        + "12,17,49,11,58,22,15,23,53,83,74,31,94,34,91,76,29,86,69,57,81,25,61\n"
                                        + "46,82,84,16,41,65,45,98,56,78,99\n"
                                        + "54,71,77,35,11,41,89,16,65,21,46,85,49,56,79\n"
                                        + "42,15,23,53,74,31,94,34,91,76,29,86,69,61,37,45,66\n"
                                        + "75,63,12,17,42,58,31,94,34\n"
                                        + "15,35,79,78,41,89,28,49,77,56,71,17,19,75,98\n"
                                        + "21,16,85,98,99,78,89,65,35,75,19,77,41,56,63,79,71,28,12,17,49,11,42\n"
                                        + "22,23,53,83,74,31,94,34,76,29,57,81,25,37,84,45,66\n"
                                        + "83,74,94,34,91,76,29,86,69,57,25,61,37,84,45,66,82,21,16,85,46\n"
                                        + "57,76,37,17,83,91,81,49,86,58,69,74,11,15,22,31,61,94,25\n"
                                        + "46,65,25,98,99,61,45,82,89,81,85,69,21,37,35,54,78,86,76\n"
                                        + "89,12,83,74,11,77,28,15,71,63,35,19,79\n"
                                        + "85,46,98,99,78,89,65,35,75,19,77,41,56,63,79,71,12,17,49,11,42,58,22\n"
                                        + "12,19,28,23,74,89,77\n"
                                        + "98,85,77,37,99,41,25,35,19,16,65,81,66,89,61,57,75,84,21,46,82\n"
                                        + "86,69,66,98,99,78,35\n"
                                        + "71,28,12,49,11,42,83,74,94,76,29,86,81\n"
                                        + "84,98,78,19,41\n"
                                        + "21,16,46,98,99,78,89,65,35,75,19,77,41,56,63,79,71,28,12,17,49,11,42\n"
                                        + "25,61,66,82,75,77,63\n"
                                        + "11,49,91,94,76,15,23,31,34,71,28,79,42,17,63,69,22\n"
                                        + "99,78,75,77,63,79,49,22,15\n"
                                        + "53,83,31,94,34,91,29,86,57,81,25,61,37,84,45,66,82,54,85\n"
                                        + "23,94,74,91,31,69,25,53,15,81,22\n"
                                        + "75,85,98,37,63\n"
                                        + "78,54,37,82,41,16,46,71,99,66,75,56,21,84,65\n"
                                        + "84,45,66,54,21,85,46,99,78,89,65,77,41,63,79,71,28\n"
                                        + "34,53,71,58,86,81,57\n"
                                        + "76,69,57,81,25,61,45,66,82,54,21,16,98,99,89\n"
                                        + "21,46,98,99,78,35,19,77,41,56,63,79,71,17,49,11,42\n"
                                        + "45,66,82,54,21,16,85,46,98,99,78,65,35,75,77,41,56,63,71,28,12\n"
                                        + "85,19,77,82,98,56,49,75,41,89,71,17,12,79,35\n"
                                        + "23,22,37,76,15,31,86,94,82,61,74,58,57\n"
                                        + "56,17,49,58,23,83,31\n"
                                        + "22,45,91,25,42,83,15,61,66\n"
                                        + "82,21,85,98,75,63,49\n"
                                        + "35,25,45,57,75\n"
                                        + "81,75,77,46,25,37,84,85,89,16,78,19,66,69,98,35,21,82,61,57,65\n"
                                        + "77,41,56,79,71,28,17,49,11,42,58,15,23,83,74,31,94,34,76\n"
                                        + "58,41,77,15,42,71,12,35,53,83,19,74,63,75,22,89,79\n"
                                        + "11,23,49,19,42,94,34,56,75,53,22,83,28,15,31,71,17\n"
                                        + "35,53,17,22,77,12,75,83,11,41,71,23,56\n"
                                        + "41,85,79,11,65,49,77,75,17,42,99,28,71,35,89,63,78,22,19\n"
                                        + "45,85,35,66,75,63,98,84,89,21,78,54,82,25,77,16,19,41,99\n"
                                        + "53,74,25,83,23,54,29,81,86,82,22,57,61,94,76,91,69,34,31\n"
                                        + "65,75,16,78,99,35,98\n"
                                        + "86,91,11,57,53,29,23,69,83,81,31,17,71\n"
                                        + "71,17,42,63,41,74,58,22,53,56,28,83,79,91,34,15,19,23,94\n"
                                        + "65,41,56,71,28,49,22,15,23,74,31\n"
                                        + "29,69,57,61,37,84,45,82,21,46,98,78,75\n"
                                        + "16,65,75,19,56,63,71,12,49,42,58\n"
                                        + "86,69,57,81,25,61,37,84,45,66,54,21,16,85,46,98,78,89,35,75,19\n"
                                        + "79,71,12,17,49,42,58,22,15,23,31,94,34,91,29,86,57\n"
                                        + "34,37,23,29,54,57,94,61,84,45,22,69,83\n"
                                        + "91,76,29,86,69,57,81,61,37,84,45,66,82,54,21,16,85,46,98,99,78,89,65\n"
                                        + "21,79,12,98,42,16,78,11,28\n"
                                        + "28,49,86,58,81,69,53,74,17,57,12,91,11,23,25,22,42,76,83,29,31,94,34\n"
                                        + "42,58,22,15,23,53,83,31,94,34,91,76,29,86,69,57,81,25,61,37,84,45,66\n"
                                        + "84,78,75,35,19,65,69,21,85,81,66,25,99,16,77,98,45\n"
                                        + "66,82,54,21,16,85,46,98,99,78,89,65,35,19,77,56,63,71,28,12,17\n"
                                        + "77,94,28,49,31\n"
                                        + "11,58,74,83,41,34,19,75,42,49,12,23,15,71,94,53,22\n"
                                        + "16,46,98,99,78,89,65,35,75,19,77,41,56,79,71,28,12,17,49,11,58\n"
                                        + "86,74,49,71,28,22,63,83,15,34,17,58,91,23,53,69,12,31,11,76,42\n"
                                        + "98,85,75,99,63,35,16,65,71,37,77,82,79,41,19,54,89,66,21,78,84,45,56\n"
                                        + "19,77,41,56,79,28,12,49,42,58,22,23,53,83,74,31,94,34,91\n"
                                        + "79,71,28,17,11,42,58,22,23,53,83,74,31,94,91,76,29,69,57\n"
                                        + "29,45,85,91,94,78,81\n"
                                        + "56,19,46,15,35,22,71\n"
                                        + "46,66,29,61,16,65,57,54,76,89,98,21,25,91,45,85,99,78,37\n"
                                        + "76,31,94,84,15,61,83,57,58,91,25,34,37,53,66,81,22\n"
                                        + "94,29,61,74,69,34,31,91,37,84,86,25,15,83,23,81,21\n"
                                        + "74,25,12,58,29,69,61,94,53,42,57,49,11,86,23\n"
                                        + "61,37,84,45,66,82,54,21,85,46,98,99,89,65,35,75,19,41,56,63,79\n"
                                        + "16,85,46,98,99,78,89,65,35,75,77,41,56,63,79,71,12,17,11,42,58\n"
                                        + "12,49,42,58,15,83,74,31,94,34,91,76,29,57,25\n"
                                        + "41,84,85,78,45,21,99,35,75,57,54,77,66\n"
                                        + "74,31,34,76,29,69,81,61,37,84,45,82,21,46,98\n"
                                        + "83,74,31,94,34,76,29,86,69,81,25,61,37,84,45,82,54,21,16,85,46\n"
                                        + "79,56,89,77,78\n"
                                        + "91,31,66,81,69,46,76,16,82,25,29,21,84,98,85,45,61,74,54\n"
                                        + "77,78,17,28,54,35,16,82,99,65,41,89,71,12,63,98,19,46,66,56,79\n"
                                        + "54,21,75,63,79,49,11\n"
                                        + "49,53,23,69,74\n"
                                        + "22,17,41,65,77,31,83,79,19,49,53\n"
                                        + "99,78,65,56,79,71,17,11,42,15,53\n"
                                        + "77,15,23,17,12,22,42,65,79,71,75,11,89,49,41\n"
                                        + "86,81,37,84,82,16,85,46,99,78,89,65,35\n"
                                        + "82,21,16,99,65,35,19,77,41,71,12\n"
                                        + "78,89,65,35,75,19,77,41,56,63,79,28,12,17,49,11,42,58,22,15,23,53,83\n"
                                        + "65,79,58,22,53,74,31\n"
                                        + "31,94,34,86,57,81,61,84,66,54,21,46,98\n"
                                        + "79,12,17,49,58,53,57\n"
                                        + "17,28,77,65,12,71,79,75,31\n"
                                        + "99,81,45,21,82,84,57,54,86,78,66,29,25\n"
                                        + "22,69,83,31,71,76,17,79,94,86,34,42,63,53,12\n"
                                        + "89,65,35,75,41,63,79,15,53\n"
                                        + "75,61,69,84,46,16,19,45,35,86,78,54,25,21,82,85,57\n"
                                        + "46,98,99,78,65,63,79,12,11,22,15\n"
                                        + "79,17,11,58,22,15,74,34,91,29,57\n"
                                        + "57,58,23,53,83,42,94,76,61,15,22,45,34,31,29,81,86,37,25,84,66\n"
                                        + "99,81,57,69,82,45,89,85,46,61,86,21,78,16,37,76,66,34,29\n"
                                        + "83,53,74,41,22,11,58,12,77,79,71,56,65,17,35,49,75,42,19,15,28,89,23\n"
                                        + "21,16,46,98,89,65,35,75,19,77,41,56,63,79,71,28,12,17,49,11,42\n"
                                        + "56,58,49,83,11,17,71,42,53,76,77,15,63,12,31,79,74,91,41\n"
                                        + "25,61,37,84,45,66,82,54,21,16,85,46,98,78,35,75,19,77,41,56,63\n"
                                        + "69,23,34,29,66,82,16,25,31,21,57,91,81,54,74,86,94,84,61,45,83,53,37\n"
                                        + "45,85,46,21,75,54,63,77,79,56,82,41,71\n"
                                        + "16,85,46,98,99,78,89,65,35,75,19,77,41,56,63,79,71,12,17,49,11,42,58\n"
                                        + "56,82,46,54,98,99,65,19,35,45,85,41,84,25,16,89,78,37,63\n"
                                        + "37,84,82,54,21,46,98,99,78,65,35,75,19,77,41,56,63,79,71\n"
                                        + "75,19,77,56,49,11,42,58,22,53,83,31,34\n"
                                        + "19,71,42,46,12,85,63,89,56,49,79,41,99,11,77\n"
                                        + "74,31,34,91,76,29,86,69,81,25,61,37,84,45,66,82,54,21,16,46,98\n"
                                        + "37,84,45,66,82,54,16,85,98,78,89,65,35,75,77,41,56,79,71\n"
                                        + "99,65,35,19,77,79,71,49,42,58,22,15,53\n"
                                        + "11,42,58,22,15,23,83,74,31,94,34,91,76,29,69,57,25,61,37,84,45\n"
                                        + "85,77,78,99,61,41,75,89,57,37,65,25,54\n"
                                        + "54,66,57,69,21,78,25,85,81,29,86,61,65,99,37,98,16,89,46,76,45\n"
                                        + "99,66,57,89,41,65,16\n"
                                        + "37,82,54,21,98,19,63,79,71\n"
                                        + "42,35,17,19,28,11,15,74,94,77,71,22,75,83,53\n"
                                        + "83,74,31,94,34,91,76,86,69,57,81,25,61,37,84,45,66,82,54,21,16,85,46\n"
                                        + "46,29,57,65,45,86,81,61,84,78,98,66,35,69,25,37,82,21,85,89,76,16,99\n"
                                        + "23,53,83,74,94,34,81,37,84,45,16\n"
                                        + "58,56,31,22,75,15,77,34,11,79,19,17,49,23,71,28,63,12,53,74,83\n"
                                        + "41,42,99,65,12\n"
                                        + "71,28,12,17,49,11,58,22,15,23,53,74,94,91,76,29,86,69,57\n"
                                        + "21,37,16,99,31,82,81,61,85,34,86,29,76,45,57\n"
                                        + "45,66,82,54,21,16,85,99,78,89,35,75,41,56,63,79,71,28,12\n"
                                        + "22,28,75,74,63,41,65,56,89,15,79\n"
                                        + "65,19,63,35,98,12,85,28,21,75,78,17,89,77,46,54,99,16,11\n"
                                        + "65,35,75,19,77,41,63,71,49,11,42,58,22,15,23,53,31\n"
                                        + "78,35,41,17,49,11,23,53,83\n"
                                        + "56,63,79,71,28,12,17,49,11,42,58,22,15,23,53,83,74,94,34,91,76,29,86\n"
                                        + "42,49,71,23,76,94,53\n"
                                        + "22,23,83,74,94,34,29,69,57,61,37,84,45,82,54\n"
                                        + "17,49,11,58,22,23,53,83,31,34,91,29,69,81,25,61,37\n"
                                        + "29,86,69,57,81,25,61,37,82,21,16,85,46,99,78,89,65,35,75\n"
                                        + "25,84,45,82,54,21,16,46,99,65,35,75,19,56,63\n"
                                        + "49,11,42,22,53,83,31,94,34,91,29,57,84\n"
                                        + "49,63,76,53,15,28,42,83,58,71,29,11,34,22,94,74,69,31,79,23,12,86,17\n"
                                        + "56,63,28,12,17,49,11,58,22,15,23,53,83,74,31,94,34,91,76,29,86\n"
                                        + "82,56,45,19,21,79,61,99,89,63,77,85,54\n"
                                        + "83,49,74,12,75,77,58,35,53,79,94,17,56\n"
                                        + "41,79,71,28,12,17,49,11,42,58,22,15,23,53,83,74,94,34,91,76,29\n"
                                        + "63,79,71,28,12,17,49,11,42,22,23,53,83,74,31,94,34,91,76,29,69\n"
                                        + "12,49,11,42,22,15,23,53,83,74,31,94,34,91,76,29,86,69,57,81,25";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT)));
        Util.time(() -> a(Input.parse(INPUT)));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
