package aoc2018;

import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Objects;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class Day13 {
    public static void main(String[] args) {
        String input = INPUT;
        a(input);
        b(input);
    }

    private static void b(String input) {
        String[] lines = Util.parseStrings(input);
        RailWay railWay = RailWay.parse(lines);
        while(railWay.carts.size() > 1) {
            railWay.tick();
            System.out.println();
        }
//        railWay.tick();
        Cart cart = railWay.carts.get(0);
        System.out.println(cart.x + "," + cart.y);

    }

    private static void a(String input) {
        String[] lines = Util.parseStrings(input);
        RailWay railWay = RailWay.parse(lines);
        int[] crash = null;
        while(crash == null) {
            crash = railWay.tick();
        }
        System.out.println(crash[0] + "," + crash[1]);
    }

    private static class RailWay {
        final Rail[][] rails;
        List<Cart> carts;
        final Set<Integer> cartPositions = new HashSet<>();

        private RailWay(Rail[][] rails, List<Cart> carts) {
            this.rails = rails;
            this.carts = carts;
            for (Cart cart : carts) {
                cartPositions.add(toPos(cart));
            }
        }

        static int toPos(Cart cart) {
            return cart.y * 100_000 + cart.x;
        }

        int[] tick() {
            int[] firstCrash = null;
            Collections.sort(carts);
            Cart[] iterable = this.carts.toArray(new Cart[0]);
            for (int i = 0; i < iterable.length; i++) {
                Cart cart = iterable[i];
                if (!move(cart)) {
                    for (int j = 0; j < iterable.length; j++) {
                        if (iterable[j] != null && iterable[j].compareTo(cart) == 0) {
                            iterable[j] = null;
                            cartPositions.remove(toPos(cart));
                        }
                    }
                    if (firstCrash == null) {
                        firstCrash = new int[] {cart.x, cart.y};;
                    }
                }
            }
            carts = Stream.of(iterable).filter(Objects::nonNull).collect(Collectors.toList());
            return firstCrash;
        }

        private boolean move(Cart cart) {
            if (cart == null) {
                return true;
            }
            int pos = toPos(cart);
            cartPositions.remove(pos);
            Rail rail;
            switch (cart.direction) {
            case UP:
                cart.y--;
                rail = rails[cart.y][cart.x];
                if (rail == Rail.FORWARD_CORNER) {
                    cart.direction = Direction.RIGHT;
                } else if (rail == Rail.BACK_CORNER) {
                    cart.direction = Direction.LEFT;
                } else if (rail == Rail.INTERSECTION) {
                    switch (cart.nextTurn) {
                    case LEFT:
                        cart.direction = Direction.LEFT;
                        cart.nextTurn = NextTurn.STRAIGHT;
                        break;
                    case STRAIGHT:
                        cart.nextTurn = NextTurn.RIGHT;
                        break;
                    case RIGHT:
                        cart.direction = Direction.RIGHT;
                        cart.nextTurn = NextTurn.LEFT;
                        break;
                    }
                }
                break;
            case DOWN:
                cart.y++;
                rail = rails[cart.y][cart.x];
                if (rail == Rail.FORWARD_CORNER) {
                    cart.direction = Direction.LEFT;
                } else if (rail == Rail.BACK_CORNER) {
                    cart.direction = Direction.RIGHT;
                } else if (rail == Rail.INTERSECTION) {
                    switch (cart.nextTurn) {
                    case LEFT:
                        cart.direction = Direction.RIGHT;
                        cart.nextTurn = NextTurn.STRAIGHT;
                        break;
                    case STRAIGHT:
                        cart.nextTurn = NextTurn.RIGHT;
                        break;
                    case RIGHT:
                        cart.direction = Direction.LEFT;
                        cart.nextTurn = NextTurn.LEFT;
                        break;
                    }
                }
                break;
            case LEFT:
                cart.x--;
                rail = rails[cart.y][cart.x];
                if (rail == Rail.FORWARD_CORNER) {
                    cart.direction = Direction.DOWN;
                } else if (rail == Rail.BACK_CORNER) {
                    cart.direction = Direction.UP;
                } else if (rail == Rail.INTERSECTION) {
                    switch (cart.nextTurn) {
                    case LEFT:
                        cart.direction = Direction.DOWN;
                        cart.nextTurn = NextTurn.STRAIGHT;
                        break;
                    case STRAIGHT:
                        cart.nextTurn = NextTurn.RIGHT;
                        break;
                    case RIGHT:
                        cart.direction = Direction.UP;
                        cart.nextTurn = NextTurn.LEFT;
                        break;
                    }
                }
                break;
            case RIGHT:
                cart.x++;
                rail = rails[cart.y][cart.x];
                if (rail == Rail.FORWARD_CORNER) {
                    cart.direction = Direction.UP;
                } else if (rail == Rail.BACK_CORNER) {
                    cart.direction = Direction.DOWN;
                } else if (rail == Rail.INTERSECTION) {
                    switch (cart.nextTurn) {
                    case LEFT:
                        cart.direction = Direction.UP;
                        cart.nextTurn = NextTurn.STRAIGHT;
                        break;
                    case STRAIGHT:
                        cart.nextTurn = NextTurn.RIGHT;
                        break;
                    case RIGHT:
                        cart.direction = Direction.DOWN;
                        cart.nextTurn = NextTurn.LEFT;
                        break;
                    }
                }
                break;
            }
            return cartPositions.add(toPos(cart));
        }

        static RailWay parse(String[] data) {
            List<Cart> carts = new ArrayList<>();
            Rail[][] rails = new Rail[data.length][];
            for (int y = 0; y < data.length; y++) {
                String row = data[y];
                rails[y] = new Rail[row.length()];
                for (int x = 0; x < row.length(); x++) {
                    char c = row.charAt(x);
                    if (c == '>') {
                        rails[y][x] = Rail.VERTICAL;
                        carts.add(new Cart(x, y, Direction.RIGHT));
                    } else if (c == 'v') {
                        rails[y][x] = Rail.HORIZONTAL;
                        carts.add(new Cart(x, y, Direction.DOWN));
                    } else if (c == '<') {
                        rails[y][x] = Rail.VERTICAL;
                        carts.add(new Cart(x, y, Direction.LEFT));
                    } else if (c == '^') {
                        rails[y][x] = Rail.HORIZONTAL;
                        carts.add(new Cart(x, y, Direction.UP));
                    } else if (c == '|') {
                        rails[y][x] = Rail.VERTICAL;
                    } else if (c == '-') {
                        rails[y][x] = Rail.HORIZONTAL;
                    } else if (c == '/') {
                        rails[y][x] = Rail.FORWARD_CORNER;
                    } else if (c == '\\') {
                        rails[y][x] = Rail.BACK_CORNER;
                    } else if (c == '+') {
                        rails[y][x] = Rail.INTERSECTION;
                    }
                }
            }
            return new RailWay(rails, carts);
        }
    }

    private static class Cart implements Comparable<Cart> {
        int x;
        int y;
        Direction direction;
        NextTurn nextTurn = NextTurn.LEFT;

        public Cart(int x, int y, Direction direction) {
            this.x = x;
            this.y = y;
            this.direction = direction;
        }

        @Override
        public int compareTo(Cart that) {
            int cmp = Integer.compare(this.y, that.y);
            return cmp != 0 ? cmp : Integer.compare(this.x, that.x);
        }
    }

    private enum NextTurn {
        LEFT, STRAIGHT, RIGHT;
    }

    private enum Direction {
        UP, DOWN, LEFT, RIGHT
    }

    private enum Rail {
        HORIZONTAL, VERTICAL, FORWARD_CORNER, BACK_CORNER, INTERSECTION
    }

    //7, 3
    private static final String TEST_INPUT = "/->-\\        \n"
                                             + "|   |  /----\\\n"
                                             + "| /-+--+-\\  |\n"
                                             + "| | |  | v  |\n"
                                             + "\\-+-/  \\-+--/\n"
                                             + "  \\------/   ";

    private static final String TEST_INPUT_B = "/>-<\\  \n"
                                               + "|   |  \n"
                                               + "| /<+-\\\n"
                                               + "| | | v\n"
                                               + "\\>+</ |\n"
                                               + "  |   ^\n"
                                               + "  \\<->/";

    private static final String INPUT =
            "                                                                                                             /----------------------------\\           \n"
            + "            /-------------------------------------------------------------\\                                  |                            |           \n"
            + "            |                               /-------------------\\         |                    /-------------+---------------\\            |           \n"
            + "            |                               |     /-------------+---------+--------------------+------\\      |              /+------------+---------\\ \n"
            + "            |                               |     |         /---+---------+--------------------+------+------+--------------++---\\        |         | \n"
            + "/-----------+-\\                             |     |         |   |   /-----+--------------------+------+----\\ |              ||   |        |         | \n"
            + "|           | |                   /---------+-----+---------+---+---+-----+--------------------+------+----+-+------\\       ||   |        |         | \n"
            + "|        /--+-+-------------------+---------+-----+---------+---+---+-----+------\\             |      |    | |      |       ||   |        |         | \n"
            + "|        |  | |                   |         |     |         |   |   |     |      |             |   /--+----+-+---\\  |       ||   |        |         | \n"
            + "|        |/-+-+-------------------+-------\\ |     |     /---+---+---+-----+------+-------------+---+--+----+-+---+--+-------++---+--------+---\\     | \n"
            + "|        || | |                   |       | | /---+-----+---+---+---+\\    |      |  /----------+---+--+----+-+---+--+------\\||   |        |   |     | \n"
            + "|        || | |                   |       | | |   |     |   |   |   ||/---+------+--+----------+---+\\ |    | |   |  |      |||   |        |   |     | \n"
            + "|    /---++-+-+------->------\\    |       | | |   |     |   |   |   |||   |      |  |   /------+---++-+----+-+---+--+-\\    |||   |        |   |     | \n"
            + "|    |   || | |              |    |       | | |   |     |   |   |   |||   |      |  |   |      |   || |    | |   |  | |    |||   |        |   |     | \n"
            + "\\----+---++-+-/              |    |       |/+-+---+-----+---+---+---+++---+------+--+---+------+---++-+----+-+---+--+-+----+++---+--------+\\  |     | \n"
            + "  /--+---++-+--------------\\ |/---+-------+++-+---+-----+---+---+---+++--\\|      |  |   |      |   || |    | \\---+--+-+----+++---+--------/|  |     | \n"
            + "  |  |   || |              | ||/--+-------+++-+---+-----+---+---+---+++--++------+--+---+------+--\\|| |    |     |  | |    |||   |         |  |     | \n"
            + "  |  |   || |/------->----\\| |||  |       ||| |  /+-----+---+---+---+++--++------+--+---+------+--+++-+----+-----+--+-+----+++---+-----\\   |  |     | \n"
            + "  |  |   || ||            || |||  |       ||| |  ||     |   |  /+---+++--++------+--+-\\ |      |  ||| |    |     |  | |    |||   |     |   |  |     | \n"
            + "  |  |   || ||            || |||  |       ||| |  ||     |   |  ||   |||  ||      |  | | |      | /+++-+----+-----+--+-+----+++---+-\\   |   |  |     | \n"
            + "  |  |   || ||            || |||/-+-------+++-+--++-----+---+--++---+++--++------+--+-+-+------+-++++-+----+-----+--+-+----+++---+-+\\  |   |  |     | \n"
            + "  |  |   || ||            || |||| |       ||| |  ||     \\---+--++---+++--++------+--+-+-+------+-++++-+----+-----+--+-+----+++---+-++--+---+--/     | \n"
            + "  |  |   || ||            || |||| |       ||| |  ||         |/-++---+++--++------+--+-+-+------+-++++-+----+-----+--+-+----+++-\\ | ||  |   |        | \n"
            + "  |  |   || ||            ||/++++-+-------+++-+--++---------++-++---+++--++------+--+-+-+------+-++++-+----+\\/---+--+-+----+++-+-+\\||  |   |        | \n"
            + "  |  |   || ||            ||||||| |       |\\+-+--++---------++-++---+++--++------+--+-+-+------+-++++-+----+++---+--+-+----+++-+-++++--+---/        | \n"
            + "  |  |   || ||            ||||||| |       | | |  ||    /----++-++---+++--++------+--+-+-+------+-++++-+----+++---+--+-+----+++-+\\||||  |            | \n"
            + "  |  |   || ||            |||||||/+-------+-+-+--++----+----++-++---+++--++------+--+-+-+------+-++++-+----+++---+--+\\|    ||| ||||||  |            | \n"
            + "  |  |   || ||            |||||||||       | | |  ||    |    || ||/--+++--++------+--+-+-+----\\ | |||| |    |||   |  |||    ||| ||||||  |            | \n"
            + "  |  |   || ||       /----+++++++++\\      | | |  ||    |  /-++-+++--+++--++------+--+-+-+\\   | | |||| |    |||   |  |||    ||| ||||||  |            | \n"
            + "/-+--+---++-++-------+----++++++++++--\\   | | |  ||  /-+--+-++-+++--+++--++------+--+-+-++---+-+-++++-+----+++---+--+++----+++-++++++--+----\\       | \n"
            + "| |  |   \\+-++-------+----++++++++++--+---+-+-+--++--+-+--+-++-+++--+++--++------/  | | ||   | |/++++-+---\\|||   |  |||    ||| ||||||  |    |       | \n"
            + "| |  |    | ||       |    ||||||||||  |   | | |  ||  | |  | || |||  v||  ||         | | ||   |/++++++-+---++++---+--+++----+++-++++++--+--\\ |       | \n"
            + "| |  |    | ||       |    ||||||||||  |   | | |  ||  | |  | || |||  |||  ||         | | ||   |||||||| |   ||||   |  |||    ||| ||||||  |  | |       | \n"
            + "| |  |  /-+-++-------+----++++++++++--+---+-+-+--++--+-+--+-++-+++--+++--++-------\\ | | ||   |||||||| |   ||||   |  |||    ||| ||||||  |  | |       | \n"
            + "| |  |  | | ||       |    ||||||||||  |   | |/+--++--+-+--+-++-+++--+++--++--\\    | | | ||   |||||||| |   ||||   |  |||    ||| ||||||  |  | |       | \n"
            + "| |  |  | | ||       |    ||||^|||||  |   | ||\\--++--+-+--+-++-+++--+/|  ||  |    | | | ||   |||||||| |   ||||   |  |||   /+++-++++++--+--+-+\\      | \n"
            + "| |  |  | | ||       |/---++++++++++--+---+\\\\+---++--+-+--+-++-+/|  | |  ||  |    | | | \\+---++++++++-+---++++---+--++/   |||| ||||||  |  | ||      | \n"
            + "| |  |  | | ||       ||   ||||||||||  |  /++-+---++--+-+--+-++-+-+--+-+--++--+----+\\| |  |   |||||||| |   ||||   |  ||    |||| ||||||  |  | |v      | \n"
            + "| |  |  | | ||      /++---++++++++++--+--+++-+\\  ||/-+-+--+-++-+-+--+-+--++--+--\\ ||| |  |   |||||||| |   ||||   |  ||    |||| ||||||  |  | ||      | \n"
            + "|/+--+--+-+-++------+++---++++++++++--+--+++\\||  ||| | |  | \\+-+-+--+-+--++--+--+-+++-+--+---++++++++-+---++++---+--++----++++-++/|||  |  | ||      | \n"
            + "\\++--+--+-+-++------+++---++++++++++--/ /++++++--+++-+-+--+--+-+-+--+-+--++--+--+-+++-+--+---++++++++-+---++++\\  |  ||    |||| || |||  | /+-++------+\\\n"
            + " ||  |  | | ||      |||   ||||||||||    |||||||  ||| | |  |  | | |/-+-+--++--+--+-+++-+--+---++++++++-+---+++++--+--++----++++-++-+++\\ | || ||      ||\n"
            + " ||/-+--+-+-++------+++---++++++++++----+++++++--+++-+-+--+--+-+-++-+-+--++--+--+-+++\\|  |   |||||||| |   |||\\+--+--++----++++-++-/||| | || ||      ||\n"
            + " ||| |  | | ||      |||   ||||||||||/---+++++++--+++\\| |  |  | \\-++-+-+--++--+--+-++++/  |   |||||||| |   ||| |  |  ||    |||| ||  ||| | || ||      ||\n"
            + " ||| |  | | ||      |||   |||||||||||   |||||||  ||||| |  |  |   || | |  ||  |  | ||||   |   |||||||| |/--+++-+--+--++----++++-++-\\||| | || ||      ||\n"
            + "/+++-+--+-+-++------+++---+++++++++++---+++++++--+++++-+--+--+---++-+-+--++--+--+-++++---+\\  |||||||| ||  ||| |  |  ||    |||| || |||| | || ||      ||\n"
            + "||||/+--+-+-++------+++---+++++++++++---+++++++-\\||||| |  |  |   || | |  ||  |  | ||||   ||/-++++++++-++--+++-+--+-\\||    |||| || |||| | || ||      ||\n"
            + "||||||  | | ||      \\++---+++++++++++---++++++/ |||||| |  | /+---++-+-+--++--+--+-++++---+++-++++++++-++--+++-+--+-+++----++++-++-++++-+-++-++---\\  ||\n"
            + "||||||  | | ||       ||   |||||||||||   ||||||  ||\\+++-+--+-++---++-+-+--++--+--+-++++---+++-++++++++-/|  ||| |  | |||    |||| || |||| | || ||   |  ||\n"
            + "||||||  | | || /-----++---+++++++++++---++++++--++-+++-+--+-++---++-+-+--++\\ |  | ||||   ||| ||||||||  |  ||| ^  | |||    |||| || |||| | || ||   |  ||\n"
            + "||||||  | | || |     ||/--+++++++++++---++++++--++-+++-+--+-++---++-+-+--+++-+--+-++++---+++-++++++++\\ |  ||| |  | |||    |||| || |||| | || ||   |  ||\n"
            + "||||||  | | || |     |||  |||||||||||   ||||||  || ||| |  | ||/--++-+-+--+++-+--+-++++--\\||| |\\+++++++-+--+++-+--+-+++----++++-++-++++-+-+/ ||   |  ||\n"
            + "||||||  | | || |     |||  |||||||||||   ||||||  || ||| |/-+-+++--++-+-+--+++-+--+-++++--++++\\| ||||||| |  ||| |  | |||    |||| || |||| | |  ||   |  ||\n"
            + "||||||  | | || |     |||  |||||||||||   ||||||  || ||| || | ^||  || | \\--+++-+--+-++++--++++++-+++++/| |  ||| |  | |||    |||| || |||| | |  ||   |  ||\n"
            + "|||||\\--+-+-++-+-----+++--+++/|||||||   ||||||  || ||| || | |||  || |    ||| |  | ||||  |||||| ||||| | |  ||| |  | |||    |||| || |||| | |  ||   |  ||\n"
            + "|||||   | |/++-+-----+++--+++-+++++++---++++++--++-+++-++-+-+++--++-+----+++-+--+-++++-\\|||||| ||||| | |  ||| |  | |||    |||| || |||| | |  ||   |  ||\n"
            + "|||||   | |||| |     |||  ||| |||||||   ||||||  || ||| || | |||  || |    ||| |/-+-++++-+++++++-+++++-+-+--+++-+--+-+++---\\|||| || |||| | |  ||   |  ||\n"
            + "|||||   |/++++-+-----+++--+++-+++++++---++++++--++-+++-++-+-+++--++-+----+++-++-+-++++-+++++++-+++++-+-+--+++-+\\ | |||   ||||| || |||| | |  ||   |  ||\n"
            + "|||||   |||||| |     |||  ||| |||||||   ||||||  || ||| || | |||/-++-+----+++-++-+-++++-+++++++-+++++-+-+--+++-++-+-+++---+++++-++\\|||| | |  ||   |  ||\n"
            + "|||||   |||||| |     |||  ||| |||||||   ||||||  || ||| || | ||||/++-+----+++-++-+-++++-+++++++-+++++-+-+--+++-++-+-+++---+++++-+++++++-+-+--++---+\\ ||\n"
            + "||||\\---++++++-+-----+++--+++-+++++++---++++++--/| ||| || | ||||||| |    ||| || | |||| ||||||| ||||| | |  ||| || | |||   ||||| ||||||| | |  ||   || ||\n"
            + "||||    |||||| |/----+++--+++-+++++++---++++++---+\\||| || | ||v|||| |    ||| || | |||| ||||||| ||||| | |  ||| || | |||   ||||| ||||||| | |  ||   || ||\n"
            + "||||    |||||| ||/---+++--+++-+++++++---++++++--\\||||| || | ||||||| |    ||| || | ||||/+++++++-+++++-+-+--+++-++-+\\|||   ||||| ||||||| | |  ||   || ||\n"
            + "||||    ||||||/+++---+++--+++-+++++++--\\||||||  |||||| || | ||||||| |    ||| || | |||||||||||| ||||\\-+-+--+++-++-/||||   ||||| ||||||| | |  ||   || ||\n"
            + "||||    ||||||||||   |||  ||| |||||||  |||||||  |||||| || | ||||||\\-+----+++-++-+-++++++++++++-++++--+-+--+++-++--++++---+++++-++++++/ | |  ||   || ||\n"
            + "||||   /++++++++++---+++\\ ||| |||||||  |||||||  |||||| || | ||||||  |    ||| || | |||||||||||| ||||  | |  ||| ||  ||||  /+++++-++++++--+-+--++---++\\||\n"
            + "||||   |||||||||||   ||\\+-+++-+++++++--+++++++--++++++-++-+-++++++--+----+++-++-+-++++++++++++-++++--/ |  ||| ||  ||||  |||||| ||||||  | |  ||   |||||\n"
            + "||||   |||||||||||   || | ||| |||||||  |||||||  |||\\++-++-+-++++++--+----+++-++-/ |||||||||||| ||||    |  ||| ||  ||||  |||||| ||||||  | |  ||   |||||\n"
            + "||\\+---+++++++++++---++-+-+/| |||||||  |||||||  ||| || || | ||||||  |    ||| ||   |||||||||||| ||||    |  ||| ||  ||||  |||||| ||||||  | |  ||   |||||\n"
            + "|| |   ||\\++++++++---++-+-+-+-+++++++--+++++++--+++-++-++-+-++++++--+----+++-++---++++++++++++-++++----+--+++-+/  ||||  |||||| ||||||  | |  ||   |||||\n"
            + "|| |   || ||||||||   || | | | |||||||  |||||||  ||| || || | ||||||  |    ||| ||   |||||||||||| ||||    |  ||| |   ||||  |||||| ||||||  | |  ||   |||||\n"
            + "|| |   || ||||||||   || | | | |||||||  |||||||  ||| || || | ||||||  |    ^|| ||   |||||||||||| ||||    |  ||| |   ||||  ||||\\+-++++++--+-+--++---+++/|\n"
            + "|| |   || ||||\\+++---++-+-+-+-+++++++--/||||||  |\\+-++-++-+-++++++--+----+++-++---++++++++++++-++++-->-+--+++-+---++++--++++-+-++++++--/ |  ||   ||| |\n"
            + "|| |   || |||| \\++---++-+-+-+-+++++++---++++++--+-+-++-++-+-++++++--+----++/ ||   |||||||||||| ||||    |  ||| |   ||||  |||| | ||||||    |  ||   ||| |\n"
            + "|| |   || ||||  ||   \\+-+-+-+-+++++/|   ||||||  | | || || | ||||||  |    ||  ||   ||\\+++++++++-++++----+--+++-+---++++--+++/ | ||||||    |  ||   ||| |\n"
            + "|| |   || ||||  ||    | | | | ||||| |   ||||||  | | || || | ||||||  |    ||  ||   || |||||||||/++++->--+--+++-+---++++--+++--+-++++++----+--++\\  ||| |\n"
            + "|| |   || ||||  ||    | | | | ||||| |   ||||||  | | || || | ||||||  |    ||  ||   || ||||||||||||||/---+--+++-+---++++--+++--+-++++++----+--+++\\ ||| |\n"
            + "||/+---++-++++--++----+-+-+-+-+++++-+---++++++--+-+\\|| || | ||||||  |    ||  ||   || |||||||||||||||   |  ||| |   ||||  |||  | ||||||    |  |||| ||| |\n"
            + "||||   || ||||  ||    | | | | |||\\+-+---++++++--+-++++-++-+-++++++--+----++--++---++-+++++++++++++++---+--+++-+---+++/  |||  | ||||||    |  |||| ||| |\n"
            + "||||   || ||||  ||    | | | | |||/+-+---++++++--+-++++-++-+-++++++--+----++--++---++-+++++++++++++++---+--+++-+---+++-\\ |||  | ||||||    |  |||| ||| |\n"
            + "||||   || ||||  ||    | | | | ||||| | /-++++++--+-++++-++-+-++++++--+----++--++---++-+++++++++++++++---+--+++-+---+++-+-+++\\ | ||||||    |  |||| ||| |\n"
            + "||||   || ||||/-++----+-+-+-+-+++++\\| | ||||||  | |||| || | ||||||  |    ||  ||   || |\\+++++++++++++---+--+++-+---/|| | |||| | ||||||    |  |||| ||| |\n"
            + "||||   || ||||| ||    | | | | ||||||| | ||||||  | |||| || | ||||||  |    ||  |v   || | |||||||||||||   |  |||/+----++-+-++++-+\\||||||    |  |||| ||| |\n"
            + "||||   || ||||v ||    | | | | ||||||| | ||||||  | |||| || |/++++++--+----++--++---++-+-+++++++++++++---+--+++++----++-+\\|||| ||||||||    |  |||| ||| |\n"
            + "\\+++---++-+++++-++----+-+-+-+-+++++++-+-++++++--+-++++-++-++++++++--+----++--++---++-+-+++/|||||||||   |  |||||    || |||||| ||||||||    |  |||| ||| |\n"
            + " |||   || ||||| ||    \\-+-+-+-+++++++-+-+++/||  | |||| || |||||||\\--+----++--++---++-+-+++-++/||||||   |  |||||/---++-++++++-++++++++----+\\ |||| ||| |\n"
            + " |||   || ||||| ||      | | | ||||||| | ||| ||  | |||| || |||||||   |    ||  ||   || | ||| || ||\\+++---+--/|||||   || |||||| ||||||||    || |||| ||| |\n"
            + " |||   || ||||| ||      | | | ||||||| | ||| ||  | |||| || \\++++++---+----++--++---++-+-++/ \\+-++-+++---+---+++++---/| |||||| ||||||||    \\+-++++-+++-/\n"
            + " |||   || v|||| ||     /+-+-+-+++++++-+-+++-++--+-++++-++--++++++---+----++--++---++-+-++---+-++-+++\\  |   |||||   /+-++++++-++++++++----\\| |||| |||  \n"
            + " |||   || ||||| ||     || | | ||||||| | ||| ||  | |||| \\+--++++++---+----++--++---++-+-++---+-++-++++--+---+++++---++-++++++-+++/||||    || |||| |||  \n"
            + " |\\+---++-+++++-++-----++-+-+-+++++++-+-+++-++--+-+/||  |  |\\++++---+----++--++---++-+-++---+-++-++++--+---+++++---++-++++++-+++-++++----++-++++-/||  \n"
            + " | |   || ||||| ||     || | | ||||||| | ||| ||  | | ||  |  | ||||   |    ||  |\\---++-+-++---+-++-++++--+---+++++---++-+++/|| ||| ||||    || ||||  ||  \n"
            + " | |   || ||||| ||   /-++-+-+-+++++++-+-+++-++--+-+-++--+-\\| ||||   |/---++--+----++-+-++---+-++-++++-\\|   |||||   || ||| || ||| ||||    || ||||  ||  \n"
            + " | |   || ||||| ||   | || | | ||||\\++-+-+++-++--+-+-++--+-++-++++---++---++--+----++-+-++---+-++-++++-++---+++++---+/ ||| || ||| ||||    || ||||  ||  \n"
            + "/+-+---++-+++++-++---+-++-+-+-++++-++-+-+++-++--+-+-++--+-++-++++\\  ||   ||  |    || | ||   | || |||| ||   |||||   |  ||| || ||| ||||    || ||||  ||  \n"
            + "|| |   || ||||| ||   | || | | |||| || | ||| ||  | | ||  |/++-+++++--++---++-\\|    || | ||   | || |||| ||   |||||   |  ||| || ||| ||||    || ||||  ||  \n"
            + "|| |   || ||||| ||   | || | | |||| || | ||| ||  | | ||  ||||/+++++--++---++-++----++-+-++---+-++-++++-++-\\ |||||   |  ||| || ||| ||||    || ||||  ||  \n"
            + "|| |   || \\++++-++---+-++-+-+-++++-++-+-++/ ||  | | ||/-++++++++++--++---++-++----++-+-++--\\| || |||| || | |||||   |  ||| || ||| ||||    || ||||  ||  \n"
            + "|| |   ||  |||| ||   | || | | |||| || | ||  |\\--+-+-+++-++++++++++--++---++-+/    || | ||  || || |||| || | ||||\\---+--+++-++-+++-++++----+/ ||||  ||  \n"
            + "|| |   ||  |||| ||   | || | | |||| || | ||  |   | | ||| ||||||||||  ||   || |     || | ||  || || |||| || | ||||    |  ||| || ||| ||||    |  ||||  ||  \n"
            + "|| |   ||  |\\++-++---+-++-+-+-++++-++-+-++--+---+-+-+++-++++++++++--++---+/ |     || | ||  || || |||| || | ||||    |  ||| || ||| ||||    |  ||||  ||  \n"
            + "|| |   ||  | || ||   | || | | |||| || | ||  |   | | ||| |||||\\++++--++---+--+-----++-+-++--++-++-++++-++-+-++++----+--+++-++-++/ ||||    |  ||||  ||  \n"
            + "|| |   ||  | || ||   | || | | |||| || | ||  |   | | ||| ||||| ||||  ||   |  |     || | ||  || |\\-++++-++-+-++++----+--+++-++-/|  ||||/---+--++++--++\\ \n"
            + "|| |   ||  | || || /-+-++-+-+-++++-++-+-++--+---+-+-+++-+++++-++++--++---+--+-----++-+-++--++-+--++++-++-+-++++-\\  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | | || | | |\\++-++-+-++--+---+-+-+++-+++++-++++--++---+--+-----++-+-++--++-+--+/|| || | |||| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | | || |/+-+-++-++-+-++--+---+-+-+++-+++++-++++--++---+\\ |     || | ||  || |  | || || | |||| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | | || ||| | || || | ||  |   | | ||| ||||| ||||  ||   || |     || | ||  || |  | || || | |||| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | |/++-+++-+-++\\|| | ||  |   | | ||| |\\+++-++++--++---++-/     || | ||  || |  | || || | ||v| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | ||\\+-+++-+-+++++-+-++--+---+-+-+++-+-+++-++++--++---++-------++-+-++--++-+--+-+/ || | |||| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | || || | || | ||| \\-+++++-+-++--+---+-+-+++-+-+++-++++--++---/|       || | ||  || |  | |  || | |||| |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | |\\-++-+-++-+-+++---+++/| | \\+--+---+-+-+++-+-+++-++++--++----+-------++-+-++--++-+--+-+--++-+-+++/ |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | ^  || | || | |||   ||| | |  |  |   | | ||| | ||| ||||  ||    |       || | ||  || |  | |  || | |||  |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | |  || | || | |||   ||| | |  |  |   | | ||| | ||| ||||  \\+----+-------++-+-++--++-+--+-+--++-+-/||  |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | |  || | || | ||| /-+++-+-+--+--+---+-+-+++-+-+++\\||||   |    |       || | ||  || |  | |  || |  ||  |  |  ||| ||  |  |||||   |  ||||  ||| \n"
            + "|| |   ||  | |  || | || | |||/+-+++-+-+--+\\ |   | | ||| | ||||||||   |    |       || | ||  || |  | |  || |  ||  |  |  ||| \\+--+--+++++---+--+/||  ||| \n"
            + "|| | /-++--+-+--++-+-++-+-+++++\\||| | |  || |   | | ||| | ||||||||   |    |       || | ||  || |  | |  || |  ||  |  |  |||  |  |  |||||   |  | ||  ||| \n"
            + "|| | | ||  | |  || | || | ||||||\\++-+-+--++-+---+-+-+++-+-++++++++---+----+-------++-+-++--++-+--+-+--++-+--++--+--+--+++--+--+--+++/|   |  | ||  ||| \n"
            + "|\\-+-+-++--+-+--++-+-++-+-++++++-++-+-+--++-/   | | ||| | ||||||||   |    |       || | ||  || |  | |  || |/-++--+--+--+++--+--+--+++-+---+\\ | ||  ||| \n"
            + "|  | | ||  | |  || | || | |||||| \\+-+-+--++-----+-+-+++-+-++++++++---+----+-------++-+-++--++-+--+-+--++-++-++--+--+--/||  |  |  ||| |   || | ||  ||| \n"
            + "|  | | ||  | |  || | || | ||||||  | | |  ||     | | ||| | ||||||||   |  /-+-------++-+-++--++-+\\ \\-+--++-++-++--+--+---++--+--+--++/ |   || | ||  ||| \n"
            + "|  | | ||  | |  || | || | ||||||  | | |  ||     | | ||| | ||||||||   |  | |       || | ||  || ||   |  || || ||  |  |   ||  |  |  ||  |   || | ||  ||| \n"
            + "|  | | ||  | |  || | || | ||||||  | | |  ||     | | ||| | ||||||||   \\--+-+-------++-+-++--++-++---+--/| || ||  |  |   ||  |  |  ||  |   || | ||  ||| \n"
            + "|  | | ||  | |  || | || | ||||||  | | |  ||     | | ||| | ||||||||      | |       || | ||  || ||   |   | || ||  |  |   ||  |  |  ||  |   || | ||  ||| \n"
            + "|  |/+-++--+-+--++-+-++-+-++++++--+-+-+--++-----+-+\\||| | ||||||||      | |       || | ||  || ||   |   | || ||  |  |   ||  |  |  ||  \\---++-+-++--++/ \n"
            + "|  ||| ||  | \\--++-+-++-+-/|||\\+--+-+-+--++-----+-+++++-+-+++/||||      | |       || | ||/-++-++---+---+-++-++--+--+---++--+\\ |  ||      || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  ||| |  | | |  \\+-----+-+++++-+-+++-++++------+-+-------+/ | ||| || ||   |   | || ||  |  |   ||  || |  ||      || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  ||| |  | | |   |     | ||||| | ||| ||||      | |       |  | ||| || ||   |   \\-++-++--+--+---++--++-+--+/      || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  ||| |  | | |   |     | ||||| | ||| ||||      | |       |  | ||| || ||   |     || ||  |  |   ||  || |  |       || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  |\\+-+--+-+-+---+-----+-+++++-+-+++-++++------+-+-------+--+-+++-++-++---+-----++-/|  |  |   ||  || |  |       || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  | | |  | | |   |     | ||||| | ||| ||||      | |       |  | ||| |v ||   |     ||  |  |  |   ||  || |  |       || | ||  ||  \n"
            + "|  ||| ||  |    || | || |  | | |  | | |   |     | ||||| \\-+++-++++------+-+-------+--+-+++-+/ ||   |     ||  |  |  |   ||  || |  |       || | ||  ||  \n"
            + "|  \\++-++--+----++-+-++-+--+-+-+--+-+-+---+-----+-+++++---+++-++++------+-+-------+--/ ||| |  \\+---+-----++--+--+--+---++--++-+--+-------++-+-/|  ||  \n"
            + "|   || ||  |    || | |\\-+--+-+-+--/ | |   |     | |||\\+---+++-++++------+-+-------+----+++-+---+---+-----++--+--+--+---++--++-+--+-------++-/  |  ||  \n"
            + "|   |\\-++--+----++-+-+--+--+-+-/    | |   |     | ||| |   ||| ||||      | |       |    ||| |   |   |     |\\--+--+--+---++--++-+--+-------+/    |  ||  \n"
            + "|   |  ||  |    || | |  |  | |      | |   |     | ||| |   ||| ||||      | |       |    ||| |   |   |     |   |  |  |   ||  || |  |       |     |  ||  \n"
            + "\\---+--++--+----++-+-+--+--+-+------+-+---+-----+-+++-+---+++-+++/      | |       |    ||\\-+---+---+-----+---+--+--+---++--+/ |  |       |     |  ||  \n"
            + "    |  ||  |    |\\-+-+--+--+-+------+-+---+-----/ ||| |   ||| |||       \\-+-------+----++--+---/   \\-----+---+--+--+---++--+--+--+-------+-----/  ||  \n"
            + "    |  ||  |    |  | |  |  | |      | |   |       ||| |   ||| |\\+---------+-------+----++--+-------------+---+--+--+---++--+--+--/       |        ||  \n"
            + "    |  ||  |    |  | \\--+--+-+------+-+---+-------+++-+---/|| \\-+---------+-------+----+/  |             |   |  |  |   ||  |  |          |        ||  \n"
            + "    |  |\\--+----+--+----+--+-+------+-+---+-------+++-+----++---+---------+-------/    |   |             |   \\--+--+---++--+--/          |        ||  \n"
            + "    |  \\---+----+--+----/  | |      | |   |       ||| |    \\+---+---------+------------+---+-------------+------+--+---/|  |             |        ||  \n"
            + "    |      |    |  |       | |      \\-+---+-------++/ |     |   |         |            |   |             |      |  |    \\--+-------------+--------+/  \n"
            + "    |      |    |  |       | |        |   |       ||  |     \\---+---------+------------+---+-------------/      |  |       |             |        |   \n"
            + "    |      \\----+--+-------+-+--------+---+-------++--+---------+---------+------------/   |                    |  |       |             |        |   \n"
            + "    |           |  |       | \\--------+---/       ||  |         |         |                |                    |  |       |             |        |   \n"
            + "    |           |  |       \\----------+-----------++--+---------+---------/                |                    |  \\-------+-------------/        |   \n"
            + "    |           |  \\------------------+-----------++--+---------+--------------------------+--------------------/          |                      |   \n"
            + "    \\-----------+---------------------+-----------+/  |         \\--------------------------+-------------------------------+----------------------/   \n"
            + "                |                     \\-----------+---+------------------------------------+-------------------------------/                          \n"
            + "                \\---------------------------------/   \\------------------------------------/                                                          ";
}
