package aoc2025;

import java.util.ArrayList;
import java.util.Comparator;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

public class Day8 {
    private static void a(Input input, int connectionLimit) {
        List<Pair> pairs = closestPairs(input.boxes).subList(0, connectionLimit);
        Map<Pos, Set<Pos>> circuits = new HashMap<>();
        for (Pair pair : pairs) {
            Set<Pos> combined = new HashSet<>(circuits.getOrDefault(pair.a, Set.of(pair.a)));
            combined.addAll(circuits.getOrDefault(pair.b, Set.of(pair.b)));
            combined.forEach(p -> circuits.put(p, combined));
        }
        System.out.println(circuits.values()
                                   .stream()
                                   .distinct()
                                   .sorted(Comparator.comparingInt(c -> -c.size()))
                                   .limit(3)
                                   .mapToLong(Set::size)
                                   .reduce((a, b) -> a * b).orElseThrow());
    }

    private static void b(Input input) {
        List<Pair> pairs = closestPairs(input.boxes);
        Map<Pos, Set<Pos>> circuits = new HashMap<>();
        for (Pair pair : pairs) {
            Set<Pos> combined = new HashSet<>(circuits.getOrDefault(pair.a, Set.of(pair.a)));
            combined.addAll(circuits.getOrDefault(pair.b, Set.of(pair.b)));
            combined.forEach(p -> circuits.put(p, combined));
            if (combined.size() == input.boxes.size()) {
                System.out.println(pair.a.x * pair.b.x);
                return;
            }
        }
    }

    private static List<Pair> closestPairs(List<Pos> boxes) {
        List<Pair> pairs = new ArrayList<>();
        for (int i = 0; i < boxes.size() - 1; i++) {
            for (int j = i + 1; j < boxes.size(); j++) {
                pairs.add(new Pair(boxes.get(i), boxes.get(j)));
            }
        }
        pairs.sort(Comparator.comparingDouble(Pair::distance));
        return pairs;
    }

    record Pair(Pos a, Pos b) {
        double distance() {
            return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2) + Math.pow(a.z - b.z, 2));
        }
    }

    record Pos(int x, int y, int z) {}

    record Input(List<Pos> boxes) {
        static Input parse(String input) {
            return new Input(input.lines().map(Util::extractInts).map(c -> new Pos(c[0], c[1], c[2])).toList());
        }
    }

    private static final String TEST_INPUT = "162,817,812\n"
                                             + "57,618,57\n"
                                             + "906,360,560\n"
                                             + "592,479,940\n"
                                             + "352,342,300\n"
                                             + "466,668,158\n"
                                             + "542,29,236\n"
                                             + "431,825,988\n"
                                             + "739,650,466\n"
                                             + "52,470,668\n"
                                             + "216,146,977\n"
                                             + "819,987,18\n"
                                             + "117,168,530\n"
                                             + "805,96,715\n"
                                             + "346,949,466\n"
                                             + "970,615,88\n"
                                             + "941,993,340\n"
                                             + "862,61,35\n"
                                             + "984,92,344\n"
                                             + "425,690,689";

    private static final String INPUT = "62481,24370,53899\n"
                                        + "66340,66361,12487\n"
                                        + "82829,41567,50460\n"
                                        + "88731,67035,17931\n"
                                        + "59963,32380,72202\n"
                                        + "11358,27461,47584\n"
                                        + "78416,48279,4367\n"
                                        + "15462,94871,83068\n"
                                        + "98060,13169,1863\n"
                                        + "93577,72041,53914\n"
                                        + "76379,23626,79660\n"
                                        + "81956,8460,69098\n"
                                        + "28582,84473,42115\n"
                                        + "72971,68167,22168\n"
                                        + "20656,90572,68545\n"
                                        + "98099,95318,60866\n"
                                        + "13911,71960,77341\n"
                                        + "12311,67335,28531\n"
                                        + "6461,96900,16383\n"
                                        + "44940,47885,76474\n"
                                        + "72381,93419,60162\n"
                                        + "38365,48424,13181\n"
                                        + "38389,39144,66773\n"
                                        + "86766,91440,25862\n"
                                        + "63175,39621,64401\n"
                                        + "63128,38989,24676\n"
                                        + "44377,64945,20408\n"
                                        + "61457,60895,44891\n"
                                        + "83451,27725,3152\n"
                                        + "23558,92768,84103\n"
                                        + "62555,73552,38406\n"
                                        + "82768,77938,9681\n"
                                        + "77017,31285,15201\n"
                                        + "3613,39964,64576\n"
                                        + "76297,91351,40548\n"
                                        + "11017,72680,59851\n"
                                        + "34150,13408,54455\n"
                                        + "22091,79222,99498\n"
                                        + "92623,82807,42405\n"
                                        + "58520,22272,38782\n"
                                        + "49045,15364,69144\n"
                                        + "66307,20227,49524\n"
                                        + "70709,6187,61184\n"
                                        + "55250,30943,34702\n"
                                        + "83510,7646,1256\n"
                                        + "92500,97589,88344\n"
                                        + "89184,56782,2611\n"
                                        + "37145,63044,73781\n"
                                        + "12701,62298,41130\n"
                                        + "95801,80302,43509\n"
                                        + "45269,81540,35702\n"
                                        + "55867,22710,50573\n"
                                        + "36510,89494,30067\n"
                                        + "27441,77314,24621\n"
                                        + "56029,51336,20069\n"
                                        + "82702,84129,61802\n"
                                        + "75301,25267,56295\n"
                                        + "35860,55763,29092\n"
                                        + "56112,48471,83647\n"
                                        + "71377,46704,46244\n"
                                        + "13494,5671,51289\n"
                                        + "67642,21821,68758\n"
                                        + "79549,54890,55669\n"
                                        + "2606,74922,90329\n"
                                        + "52554,2216,77139\n"
                                        + "49345,78782,60048\n"
                                        + "71469,3453,49286\n"
                                        + "97116,87075,80036\n"
                                        + "15609,78239,37995\n"
                                        + "2857,47660,58969\n"
                                        + "93008,2320,5601\n"
                                        + "10779,57086,13138\n"
                                        + "49461,2124,34224\n"
                                        + "24876,72760,60405\n"
                                        + "77055,37710,61869\n"
                                        + "14730,65207,10161\n"
                                        + "72658,84284,65384\n"
                                        + "90363,10115,71282\n"
                                        + "29832,59416,83252\n"
                                        + "81449,75106,10402\n"
                                        + "57418,96325,33857\n"
                                        + "54725,17760,78951\n"
                                        + "93256,17472,2504\n"
                                        + "3322,74166,23627\n"
                                        + "32081,55213,85496\n"
                                        + "19321,2056,81231\n"
                                        + "23483,38023,84160\n"
                                        + "39191,11693,45961\n"
                                        + "83140,77996,75262\n"
                                        + "58405,78104,2168\n"
                                        + "63487,47133,68921\n"
                                        + "34899,25063,86893\n"
                                        + "92050,15350,66805\n"
                                        + "56409,39933,58714\n"
                                        + "1864,98120,45471\n"
                                        + "80911,99735,94959\n"
                                        + "92708,79549,65668\n"
                                        + "75707,8993,56732\n"
                                        + "99401,60739,37763\n"
                                        + "31494,56174,93879\n"
                                        + "97778,85785,70179\n"
                                        + "24702,99685,10427\n"
                                        + "11369,48725,18145\n"
                                        + "10000,60035,34719\n"
                                        + "43589,8775,74614\n"
                                        + "61647,56316,95371\n"
                                        + "41756,9930,54146\n"
                                        + "541,74141,48769\n"
                                        + "8097,20212,21510\n"
                                        + "93577,36155,51584\n"
                                        + "89789,74369,48704\n"
                                        + "81641,98420,20706\n"
                                        + "88888,59900,18455\n"
                                        + "83836,33148,56774\n"
                                        + "15770,48634,30366\n"
                                        + "88598,11876,42242\n"
                                        + "99259,14526,76904\n"
                                        + "92741,12276,40265\n"
                                        + "88251,88296,17848\n"
                                        + "11566,47145,7834\n"
                                        + "71435,35592,12621\n"
                                        + "50253,97430,21660\n"
                                        + "26681,56280,9473\n"
                                        + "1428,24,60322\n"
                                        + "4644,41500,58899\n"
                                        + "8070,78856,43800\n"
                                        + "20173,47151,5607\n"
                                        + "88080,33579,25090\n"
                                        + "80428,80036,72689\n"
                                        + "82182,68448,52795\n"
                                        + "55025,92193,45293\n"
                                        + "30710,57926,4977\n"
                                        + "92644,5634,71511\n"
                                        + "70959,82194,26985\n"
                                        + "89964,55043,46952\n"
                                        + "49215,4261,68603\n"
                                        + "20461,71796,85600\n"
                                        + "93295,4443,6865\n"
                                        + "71752,34093,68135\n"
                                        + "4372,15946,4919\n"
                                        + "60536,91542,78250\n"
                                        + "16288,35074,56720\n"
                                        + "25748,37278,7880\n"
                                        + "43146,24237,44791\n"
                                        + "41635,58058,9596\n"
                                        + "41414,20574,40562\n"
                                        + "839,23234,44946\n"
                                        + "38489,83895,53761\n"
                                        + "69451,91823,50322\n"
                                        + "56799,66858,6830\n"
                                        + "8840,75892,49988\n"
                                        + "80804,10418,71078\n"
                                        + "310,29126,95523\n"
                                        + "84436,54938,2132\n"
                                        + "11467,17732,4156\n"
                                        + "14181,79981,30720\n"
                                        + "64855,47326,62302\n"
                                        + "3895,70448,20329\n"
                                        + "58087,70303,61428\n"
                                        + "14653,43286,26953\n"
                                        + "62681,33739,53127\n"
                                        + "96211,90925,2789\n"
                                        + "23074,44009,78704\n"
                                        + "32662,31277,36531\n"
                                        + "18015,14083,29433\n"
                                        + "56296,87814,44350\n"
                                        + "89334,16942,13844\n"
                                        + "37104,33861,42735\n"
                                        + "27947,21778,13729\n"
                                        + "81863,16514,71\n"
                                        + "54750,34035,25947\n"
                                        + "15818,50187,14036\n"
                                        + "86932,86909,44487\n"
                                        + "78916,21580,95198\n"
                                        + "29385,91717,58517\n"
                                        + "85890,2165,17475\n"
                                        + "34230,71349,65488\n"
                                        + "75100,45351,97130\n"
                                        + "45460,43169,10171\n"
                                        + "18158,81704,19105\n"
                                        + "30111,59730,82758\n"
                                        + "4565,27847,37683\n"
                                        + "19791,68429,461\n"
                                        + "71924,49748,70713\n"
                                        + "18764,12037,58930\n"
                                        + "2524,40595,68330\n"
                                        + "13483,59923,82399\n"
                                        + "98948,3455,63115\n"
                                        + "13222,87227,1292\n"
                                        + "10689,34976,73891\n"
                                        + "98617,14962,86519\n"
                                        + "7779,81958,55664\n"
                                        + "33972,95249,98942\n"
                                        + "61726,70457,62214\n"
                                        + "12208,44836,62937\n"
                                        + "70597,44622,63150\n"
                                        + "27375,31188,62826\n"
                                        + "52410,44473,32001\n"
                                        + "98053,77174,12802\n"
                                        + "11904,55643,93445\n"
                                        + "73164,86131,54754\n"
                                        + "81204,84266,8050\n"
                                        + "75089,70894,24807\n"
                                        + "91025,70799,10415\n"
                                        + "88178,28196,66228\n"
                                        + "71455,3436,25491\n"
                                        + "42302,87800,97888\n"
                                        + "95021,94907,29531\n"
                                        + "33478,59431,31624\n"
                                        + "10632,29610,61595\n"
                                        + "25072,82592,90760\n"
                                        + "3784,59625,1022\n"
                                        + "7144,2901,63299\n"
                                        + "48352,93184,17289\n"
                                        + "73673,24532,81217\n"
                                        + "889,31278,64452\n"
                                        + "39501,73989,57025\n"
                                        + "30018,34716,69574\n"
                                        + "53193,44694,92996\n"
                                        + "50111,66815,66405\n"
                                        + "21214,73044,86904\n"
                                        + "22395,55743,71920\n"
                                        + "75087,87617,90946\n"
                                        + "73688,85294,71035\n"
                                        + "68688,77165,40111\n"
                                        + "65577,55731,10604\n"
                                        + "47344,15165,2985\n"
                                        + "81884,53717,93036\n"
                                        + "32321,48816,7214\n"
                                        + "70363,78798,11627\n"
                                        + "94451,72902,82308\n"
                                        + "58816,14066,80108\n"
                                        + "59222,51580,66043\n"
                                        + "58820,35913,82886\n"
                                        + "75310,49473,19013\n"
                                        + "93586,16044,32942\n"
                                        + "46868,19795,71674\n"
                                        + "10895,80510,9730\n"
                                        + "10419,81157,76097\n"
                                        + "12634,3704,95574\n"
                                        + "42425,61938,86475\n"
                                        + "53456,43000,55961\n"
                                        + "96239,25618,1080\n"
                                        + "64965,18715,77716\n"
                                        + "14874,47845,69913\n"
                                        + "86619,78274,56146\n"
                                        + "10027,28857,27404\n"
                                        + "31,86852,88182\n"
                                        + "25084,89487,64095\n"
                                        + "42131,42116,85157\n"
                                        + "91564,70712,66726\n"
                                        + "63926,3975,99273\n"
                                        + "50288,43817,97353\n"
                                        + "70849,90055,16020\n"
                                        + "76503,9290,27095\n"
                                        + "96186,13635,15020\n"
                                        + "52274,55842,22549\n"
                                        + "51845,24580,3119\n"
                                        + "70196,70848,7156\n"
                                        + "1552,99033,50558\n"
                                        + "67573,99731,70665\n"
                                        + "49554,3352,72836\n"
                                        + "10281,95909,82756\n"
                                        + "80947,99390,18937\n"
                                        + "8288,36412,43419\n"
                                        + "43082,47834,52847\n"
                                        + "13428,56229,50716\n"
                                        + "57716,5423,68705\n"
                                        + "95137,76369,74486\n"
                                        + "42797,55147,2171\n"
                                        + "27815,82310,41944\n"
                                        + "20524,14459,78578\n"
                                        + "62196,46604,39150\n"
                                        + "53247,48460,11226\n"
                                        + "82537,73165,90310\n"
                                        + "6893,5095,31870\n"
                                        + "23594,8757,91952\n"
                                        + "52515,96377,61373\n"
                                        + "1255,14998,8565\n"
                                        + "71995,70021,5588\n"
                                        + "35411,51258,14863\n"
                                        + "29958,68839,70772\n"
                                        + "16436,83545,2796\n"
                                        + "69078,68018,88994\n"
                                        + "16025,89059,91646\n"
                                        + "55674,66501,4058\n"
                                        + "17373,96351,63076\n"
                                        + "21157,89695,20806\n"
                                        + "61233,99401,12990\n"
                                        + "74053,88542,656\n"
                                        + "98005,70774,21666\n"
                                        + "90593,92574,9223\n"
                                        + "48564,17681,10405\n"
                                        + "3331,77677,36131\n"
                                        + "46340,15706,28942\n"
                                        + "73750,39042,85926\n"
                                        + "20979,22488,12475\n"
                                        + "45855,73847,95562\n"
                                        + "65905,78921,79532\n"
                                        + "23679,53536,84498\n"
                                        + "62591,79139,85257\n"
                                        + "37007,3866,22416\n"
                                        + "20027,6440,31379\n"
                                        + "63948,14595,21037\n"
                                        + "77661,54663,28999\n"
                                        + "93640,68943,13961\n"
                                        + "22291,72747,65061\n"
                                        + "94698,99368,48371\n"
                                        + "94059,87827,29568\n"
                                        + "25472,26287,69923\n"
                                        + "22193,70250,1900\n"
                                        + "86535,38401,34260\n"
                                        + "17038,91468,95940\n"
                                        + "49596,42364,29122\n"
                                        + "4493,64801,13137\n"
                                        + "7333,75555,6412\n"
                                        + "43308,18571,52027\n"
                                        + "21983,16739,73717\n"
                                        + "57083,82018,3551\n"
                                        + "41957,68008,80819\n"
                                        + "35260,77503,28478\n"
                                        + "90486,58663,26555\n"
                                        + "49043,44141,25033\n"
                                        + "71606,38502,80120\n"
                                        + "71249,93192,13142\n"
                                        + "90046,15524,27638\n"
                                        + "52993,22156,38931\n"
                                        + "22095,97030,84326\n"
                                        + "10499,42051,77219\n"
                                        + "26336,57880,60984\n"
                                        + "95491,10908,96214\n"
                                        + "54297,10684,81187\n"
                                        + "27507,60392,63410\n"
                                        + "16804,73541,48528\n"
                                        + "66411,30591,32766\n"
                                        + "16930,93506,77172\n"
                                        + "70849,13977,30643\n"
                                        + "27617,94579,41699\n"
                                        + "3114,60753,87562\n"
                                        + "33388,60813,51631\n"
                                        + "35974,48083,11929\n"
                                        + "16312,64484,53743\n"
                                        + "19771,35323,71804\n"
                                        + "70796,69304,6672\n"
                                        + "76306,69009,22472\n"
                                        + "24567,93297,86429\n"
                                        + "94425,88486,94146\n"
                                        + "10741,27662,85922\n"
                                        + "85181,4597,25671\n"
                                        + "73124,71547,99125\n"
                                        + "41590,84116,82749\n"
                                        + "38383,36419,6864\n"
                                        + "66046,54411,13358\n"
                                        + "74963,49019,42941\n"
                                        + "63803,77050,20237\n"
                                        + "6639,92250,97983\n"
                                        + "27970,31898,14135\n"
                                        + "84964,91205,70238\n"
                                        + "86230,7350,8883\n"
                                        + "42664,54167,25829\n"
                                        + "35265,69258,7769\n"
                                        + "49819,18934,23764\n"
                                        + "70888,81748,26133\n"
                                        + "8870,18249,83960\n"
                                        + "46409,60017,84198\n"
                                        + "64306,8970,89299\n"
                                        + "85449,36237,85350\n"
                                        + "34670,26610,40136\n"
                                        + "70201,49413,49912\n"
                                        + "6421,83883,51515\n"
                                        + "62020,34992,33538\n"
                                        + "8952,55508,67320\n"
                                        + "73146,4605,1641\n"
                                        + "39675,76363,50763\n"
                                        + "37102,51958,51479\n"
                                        + "88289,89319,34619\n"
                                        + "97439,47359,73923\n"
                                        + "85081,99417,86185\n"
                                        + "70805,9046,56833\n"
                                        + "89767,11131,95326\n"
                                        + "5026,64029,31871\n"
                                        + "75274,52030,20837\n"
                                        + "23991,39324,86249\n"
                                        + "18483,88783,69125\n"
                                        + "90397,10077,49237\n"
                                        + "79725,7219,1590\n"
                                        + "41253,83312,67469\n"
                                        + "32551,36336,85363\n"
                                        + "98789,48920,52783\n"
                                        + "2290,62976,30487\n"
                                        + "77807,63679,10158\n"
                                        + "88328,6246,94235\n"
                                        + "22093,42991,62154\n"
                                        + "93053,37962,95833\n"
                                        + "93552,68683,98090\n"
                                        + "86622,55586,95828\n"
                                        + "2088,95279,37448\n"
                                        + "26766,94375,57565\n"
                                        + "59454,81581,63222\n"
                                        + "69263,10726,15134\n"
                                        + "58857,4771,9128\n"
                                        + "94589,6259,60210\n"
                                        + "13610,44290,51631\n"
                                        + "92637,77050,19474\n"
                                        + "45736,92555,93526\n"
                                        + "47439,28178,31713\n"
                                        + "17783,34622,44776\n"
                                        + "39659,43214,36901\n"
                                        + "54587,6347,46090\n"
                                        + "54276,77371,92356\n"
                                        + "92849,61708,98737\n"
                                        + "69361,70451,67078\n"
                                        + "5335,60031,19810\n"
                                        + "82227,21976,5533\n"
                                        + "13863,61349,85906\n"
                                        + "49572,35726,55475\n"
                                        + "29469,88047,41394\n"
                                        + "25568,73735,22822\n"
                                        + "74614,68249,24281\n"
                                        + "65086,79676,26246\n"
                                        + "31824,28877,98198\n"
                                        + "64280,50117,17281\n"
                                        + "57361,94807,20068\n"
                                        + "782,21071,17549\n"
                                        + "115,87102,29345\n"
                                        + "77612,94426,20552\n"
                                        + "37801,53290,43890\n"
                                        + "51457,32980,81739\n"
                                        + "27594,19035,23925\n"
                                        + "95487,92587,21387\n"
                                        + "23782,30341,47608\n"
                                        + "76453,23770,38861\n"
                                        + "51149,69248,40214\n"
                                        + "65415,41019,20935\n"
                                        + "63084,26130,91594\n"
                                        + "45922,79342,65969\n"
                                        + "58122,18028,8909\n"
                                        + "23156,72550,93541\n"
                                        + "30224,82378,36193\n"
                                        + "24495,99352,8496\n"
                                        + "24577,90652,77000\n"
                                        + "13941,88363,23391\n"
                                        + "75426,69700,30575\n"
                                        + "42955,58407,41887\n"
                                        + "39185,75481,66343\n"
                                        + "45625,533,14874\n"
                                        + "72460,3682,53301\n"
                                        + "93246,89560,79143\n"
                                        + "25553,82507,57747\n"
                                        + "96084,34582,68057\n"
                                        + "27320,47873,97361\n"
                                        + "76820,66080,24236\n"
                                        + "69647,58517,32553\n"
                                        + "21852,96376,77515\n"
                                        + "65147,71947,51957\n"
                                        + "78559,98771,56614\n"
                                        + "83957,12590,74394\n"
                                        + "54399,50414,7563\n"
                                        + "902,67669,82582\n"
                                        + "16388,42523,28620\n"
                                        + "79947,81564,77041\n"
                                        + "48133,91494,99788\n"
                                        + "20792,79396,90570\n"
                                        + "14619,74702,85123\n"
                                        + "64715,90222,72735\n"
                                        + "68678,16159,42366\n"
                                        + "29348,2458,73378\n"
                                        + "6294,87967,35093\n"
                                        + "14493,76112,77923\n"
                                        + "7340,84965,42077\n"
                                        + "35427,56803,86090\n"
                                        + "5025,35512,46912\n"
                                        + "18291,49511,99676\n"
                                        + "45776,80918,86470\n"
                                        + "79426,86913,74997\n"
                                        + "23822,92861,24410\n"
                                        + "89293,20119,91729\n"
                                        + "9142,5806,16543\n"
                                        + "24413,46504,66104\n"
                                        + "10098,8573,87034\n"
                                        + "42958,23453,40821\n"
                                        + "63734,55955,81335\n"
                                        + "12720,39389,19011\n"
                                        + "20621,18557,6057\n"
                                        + "70892,31125,84235\n"
                                        + "81101,96579,50762\n"
                                        + "4663,39893,22119\n"
                                        + "65051,93561,86772\n"
                                        + "53599,94234,51599\n"
                                        + "91482,22384,87595\n"
                                        + "81053,58114,4369\n"
                                        + "94256,85587,74429\n"
                                        + "56744,92034,17566\n"
                                        + "39349,87875,44314\n"
                                        + "80992,40280,65931\n"
                                        + "21726,81749,56089\n"
                                        + "21802,87210,87230\n"
                                        + "78873,98800,55413\n"
                                        + "21500,62709,3143\n"
                                        + "19875,69226,31213\n"
                                        + "68142,2871,89336\n"
                                        + "70781,34504,45747\n"
                                        + "77614,41821,87610\n"
                                        + "84054,54488,96887\n"
                                        + "68906,67507,60697\n"
                                        + "69774,76607,4839\n"
                                        + "98059,11971,95347\n"
                                        + "66838,66578,98047\n"
                                        + "94639,35486,91935\n"
                                        + "96339,32357,75113\n"
                                        + "60956,29336,7051\n"
                                        + "44213,46870,4573\n"
                                        + "57440,99112,3736\n"
                                        + "33175,89927,37506\n"
                                        + "90780,22756,76594\n"
                                        + "29257,85902,13965\n"
                                        + "53604,11289,4295\n"
                                        + "56853,29935,24364\n"
                                        + "27054,2413,1383\n"
                                        + "22623,97419,25490\n"
                                        + "37025,36550,73511\n"
                                        + "33957,42912,50293\n"
                                        + "58495,42998,8634\n"
                                        + "12651,17125,66876\n"
                                        + "50130,24464,44626\n"
                                        + "69340,90402,84438\n"
                                        + "75674,10081,77770\n"
                                        + "70521,11381,72314\n"
                                        + "58330,38872,37212\n"
                                        + "76009,70109,30293\n"
                                        + "98794,94482,55960\n"
                                        + "41796,72717,47551\n"
                                        + "40998,95021,564\n"
                                        + "42318,48844,73719\n"
                                        + "64143,49620,45149\n"
                                        + "8780,43828,18292\n"
                                        + "73085,24704,78191\n"
                                        + "45754,55252,78478\n"
                                        + "98018,97994,71697\n"
                                        + "86888,40137,38049\n"
                                        + "21693,57153,13023\n"
                                        + "13834,44992,77814\n"
                                        + "26503,34744,19476\n"
                                        + "50934,59258,44461\n"
                                        + "89398,25445,635\n"
                                        + "63984,80407,36901\n"
                                        + "5241,24791,62845\n"
                                        + "46692,60964,54502\n"
                                        + "67702,68984,21850\n"
                                        + "85341,94268,55228\n"
                                        + "58216,74438,74846\n"
                                        + "92122,46729,1584\n"
                                        + "49786,41511,64848\n"
                                        + "18007,20902,81090\n"
                                        + "77116,84081,78778\n"
                                        + "78199,47683,56401\n"
                                        + "70405,69713,84906\n"
                                        + "68453,89316,17514\n"
                                        + "3015,24105,27574\n"
                                        + "38654,63833,70488\n"
                                        + "44346,63603,62374\n"
                                        + "94690,41742,85485\n"
                                        + "25432,56277,27491\n"
                                        + "22606,66696,11217\n"
                                        + "13806,9485,57760\n"
                                        + "39761,536,55848\n"
                                        + "36815,75509,11882\n"
                                        + "5395,48901,60876\n"
                                        + "63373,87497,39012\n"
                                        + "67875,88479,75313\n"
                                        + "55828,16269,31634\n"
                                        + "46999,55750,64227\n"
                                        + "41209,35997,68490\n"
                                        + "11581,67208,58758\n"
                                        + "23804,41128,74343\n"
                                        + "19978,78822,79347\n"
                                        + "32533,26755,94660\n"
                                        + "10907,99545,43282\n"
                                        + "14874,59827,90766\n"
                                        + "201,5351,8815\n"
                                        + "60643,39936,41371\n"
                                        + "73382,40894,47820\n"
                                        + "21833,62075,79513\n"
                                        + "44019,59749,22541\n"
                                        + "59302,12964,31559\n"
                                        + "6723,98027,33737\n"
                                        + "69555,17062,82285\n"
                                        + "34400,38764,14294\n"
                                        + "40074,59595,49693\n"
                                        + "38194,26664,81418\n"
                                        + "52094,19662,10694\n"
                                        + "51932,67790,87056\n"
                                        + "13946,48711,80658\n"
                                        + "63885,33479,63521\n"
                                        + "23218,56740,26454\n"
                                        + "91548,15200,57806\n"
                                        + "58988,95035,23702\n"
                                        + "82643,28966,74630\n"
                                        + "99174,25402,70850\n"
                                        + "51597,35095,73459\n"
                                        + "17842,90892,28928\n"
                                        + "22755,64671,45912\n"
                                        + "29634,47832,50713\n"
                                        + "92579,22928,38458\n"
                                        + "77536,25966,74438\n"
                                        + "32236,23383,94655\n"
                                        + "56550,72276,7097\n"
                                        + "44622,74765,55825\n"
                                        + "49810,79080,70716\n"
                                        + "26862,49964,27271\n"
                                        + "62390,98769,18278\n"
                                        + "62564,27629,75947\n"
                                        + "57975,48001,98506\n"
                                        + "12051,42277,90132\n"
                                        + "4919,91667,57849\n"
                                        + "94866,42662,28717\n"
                                        + "98201,82130,90705\n"
                                        + "23544,4886,90400\n"
                                        + "24510,29297,43541\n"
                                        + "93299,66390,22117\n"
                                        + "44555,34829,43502\n"
                                        + "7342,39126,39105\n"
                                        + "41439,91372,37176\n"
                                        + "56332,13205,5026\n"
                                        + "56823,6709,34997\n"
                                        + "35811,60371,85207\n"
                                        + "61502,53256,40153\n"
                                        + "95830,82829,40371\n"
                                        + "41556,16943,95725\n"
                                        + "55941,99434,28174\n"
                                        + "84943,84448,88475\n"
                                        + "92978,42630,3843\n"
                                        + "65384,23186,99165\n"
                                        + "77134,89897,95464\n"
                                        + "62637,29005,86439\n"
                                        + "48335,42160,60868\n"
                                        + "24910,25834,56819\n"
                                        + "50348,75380,44568\n"
                                        + "46487,21834,20213\n"
                                        + "88418,81132,70836\n"
                                        + "72741,86330,97521\n"
                                        + "19862,12191,67394\n"
                                        + "73400,18210,85642\n"
                                        + "19425,27241,59044\n"
                                        + "52485,52281,69484\n"
                                        + "9481,57228,88351\n"
                                        + "53362,27960,77241\n"
                                        + "55894,7562,61493\n"
                                        + "75406,83962,27480\n"
                                        + "71256,98966,4553\n"
                                        + "49930,65219,67944\n"
                                        + "74143,1798,22042\n"
                                        + "35315,75231,55253\n"
                                        + "61115,30138,42644\n"
                                        + "20272,53530,595\n"
                                        + "49749,83880,20905\n"
                                        + "539,58155,60014\n"
                                        + "40521,37811,79626\n"
                                        + "34210,62356,60052\n"
                                        + "70832,84442,56548\n"
                                        + "61743,6902,89013\n"
                                        + "97928,80243,86673\n"
                                        + "20943,70911,16858\n"
                                        + "65990,97227,45629\n"
                                        + "87782,1531,42689\n"
                                        + "51300,27781,99556\n"
                                        + "28916,10944,43691\n"
                                        + "85985,16804,22359\n"
                                        + "34609,57439,18961\n"
                                        + "82452,58445,99921\n"
                                        + "79170,78296,60507\n"
                                        + "11799,58459,70499\n"
                                        + "98509,54846,13957\n"
                                        + "1936,58278,70923\n"
                                        + "97974,13523,69205\n"
                                        + "91557,38813,33128\n"
                                        + "27723,70937,71609\n"
                                        + "50667,71131,79444\n"
                                        + "11233,72492,68811\n"
                                        + "54202,86377,33256\n"
                                        + "53787,58834,85499\n"
                                        + "15495,80187,80979\n"
                                        + "68940,65748,79845\n"
                                        + "17300,53678,62346\n"
                                        + "21462,37580,86068\n"
                                        + "11485,90040,56066\n"
                                        + "91652,37052,83110\n"
                                        + "1137,38987,68368\n"
                                        + "8398,78285,12655\n"
                                        + "96481,98574,88591\n"
                                        + "46631,61944,80432\n"
                                        + "50554,87230,98594\n"
                                        + "35016,90324,645\n"
                                        + "2634,12828,9808\n"
                                        + "5910,33084,64064\n"
                                        + "17458,43811,8242\n"
                                        + "62107,49196,6220\n"
                                        + "17365,32017,11136\n"
                                        + "70577,62909,1940\n"
                                        + "18562,59252,26196\n"
                                        + "20115,71903,73430\n"
                                        + "69310,83972,17852\n"
                                        + "12621,54158,9833\n"
                                        + "67838,62106,52159\n"
                                        + "6819,45571,71165\n"
                                        + "63958,88001,8541\n"
                                        + "84155,17054,78593\n"
                                        + "17712,54851,73280\n"
                                        + "68777,10339,83407\n"
                                        + "88511,3162,72664\n"
                                        + "53017,55005,54774\n"
                                        + "1433,78812,87528\n"
                                        + "55758,93379,52022\n"
                                        + "23864,36383,50359\n"
                                        + "64244,57964,45721\n"
                                        + "83717,32642,14010\n"
                                        + "3445,96409,95499\n"
                                        + "82858,62411,33154\n"
                                        + "28055,26029,16005\n"
                                        + "99830,42863,79794\n"
                                        + "27922,34466,97178\n"
                                        + "88376,80932,48855\n"
                                        + "74422,62262,65978\n"
                                        + "76385,38386,98514\n"
                                        + "65132,46375,60639\n"
                                        + "44430,18002,35637\n"
                                        + "84776,15340,17972\n"
                                        + "15570,39609,49662\n"
                                        + "24507,48337,28865\n"
                                        + "59006,33070,83416\n"
                                        + "72032,94152,42855\n"
                                        + "49432,21974,36807\n"
                                        + "52728,23788,45032\n"
                                        + "81545,54518,7061\n"
                                        + "67700,54826,8838\n"
                                        + "89529,82537,18243\n"
                                        + "91464,84284,17295\n"
                                        + "9622,89378,29035\n"
                                        + "53655,63934,14524\n"
                                        + "48620,32242,46190\n"
                                        + "2048,95087,82328\n"
                                        + "41515,81389,57941\n"
                                        + "92546,46257,2705\n"
                                        + "76688,29264,68010\n"
                                        + "36630,84540,80079\n"
                                        + "72116,93506,20527\n"
                                        + "67884,23529,35454\n"
                                        + "9293,62669,14816\n"
                                        + "63741,10640,69276\n"
                                        + "50349,39522,42023\n"
                                        + "9247,62842,48953\n"
                                        + "29474,52466,68817\n"
                                        + "16777,19016,12241\n"
                                        + "54346,44685,99965\n"
                                        + "57543,9685,42981\n"
                                        + "42376,44341,71809\n"
                                        + "3406,17341,39103\n"
                                        + "66169,46483,55351\n"
                                        + "30741,74455,63641\n"
                                        + "54063,70542,63224\n"
                                        + "59719,92749,75073\n"
                                        + "40743,8846,61661\n"
                                        + "95910,26389,41056\n"
                                        + "6203,37558,10990\n"
                                        + "30201,99143,65381\n"
                                        + "8064,8797,40348\n"
                                        + "27203,78444,72336\n"
                                        + "89295,42800,95187\n"
                                        + "85521,27825,36447\n"
                                        + "76073,73853,41329\n"
                                        + "79370,79007,85405\n"
                                        + "75592,81226,6209\n"
                                        + "15023,89757,62045\n"
                                        + "62325,57595,58721\n"
                                        + "99557,10319,39142\n"
                                        + "46756,19590,59320\n"
                                        + "64990,92019,60622\n"
                                        + "13151,16500,71686\n"
                                        + "64481,98867,72641\n"
                                        + "45597,94284,42229\n"
                                        + "34900,3630,90784\n"
                                        + "64010,87178,45829\n"
                                        + "9004,27666,80679\n"
                                        + "41742,9013,93991\n"
                                        + "54062,87465,75861\n"
                                        + "8937,68621,18195\n"
                                        + "18021,50858,61473\n"
                                        + "73462,89273,25014\n"
                                        + "82133,18119,39855\n"
                                        + "82923,212,2831\n"
                                        + "37469,73899,16666\n"
                                        + "29361,36000,76086\n"
                                        + "30181,15729,8194\n"
                                        + "92889,74664,54821\n"
                                        + "29967,511,49935\n"
                                        + "12795,58533,16903\n"
                                        + "61049,92502,28634\n"
                                        + "37157,17262,74326\n"
                                        + "28722,60371,92344\n"
                                        + "34018,77090,89591\n"
                                        + "23711,49559,82474\n"
                                        + "4768,71269,48374\n"
                                        + "75481,13044,68576\n"
                                        + "15572,37519,59626\n"
                                        + "13254,39146,30569\n"
                                        + "49594,14480,20966\n"
                                        + "56597,92877,23225\n"
                                        + "10699,90728,70657\n"
                                        + "18790,28477,85016\n"
                                        + "14875,74675,77161\n"
                                        + "62435,75236,49681\n"
                                        + "94818,9252,20598\n"
                                        + "42798,11266,2422\n"
                                        + "37583,53172,87584\n"
                                        + "51063,40581,57905\n"
                                        + "31708,97189,46730\n"
                                        + "73611,36554,5822\n"
                                        + "52156,45567,24018\n"
                                        + "50061,66525,18143\n"
                                        + "25432,61377,12284\n"
                                        + "78060,21722,19312\n"
                                        + "83396,38287,72171\n"
                                        + "24642,41943,94267\n"
                                        + "4875,64039,35843\n"
                                        + "49090,32903,87225\n"
                                        + "68839,72596,14143\n"
                                        + "85796,86578,47824\n"
                                        + "38482,69339,47396\n"
                                        + "22050,10359,63473\n"
                                        + "80725,38820,87148\n"
                                        + "31834,66508,31645\n"
                                        + "18784,72021,93807\n"
                                        + "89424,74368,14707\n"
                                        + "97249,89734,27825\n"
                                        + "17915,93419,62769\n"
                                        + "59597,45212,57108\n"
                                        + "78921,25435,38424\n"
                                        + "34207,39272,5423\n"
                                        + "6990,53145,30614\n"
                                        + "7768,1237,27378\n"
                                        + "58039,42929,71438\n"
                                        + "61810,5498,42834\n"
                                        + "7343,1529,65032\n"
                                        + "48285,54571,44785\n"
                                        + "69838,63618,48090\n"
                                        + "63841,11530,8665\n"
                                        + "29982,68231,84874\n"
                                        + "25594,2972,13222\n"
                                        + "96017,2852,44235\n"
                                        + "11203,75340,4789\n"
                                        + "80571,81427,31433\n"
                                        + "77359,28389,61604\n"
                                        + "66392,85249,85280\n"
                                        + "67402,88184,10770\n"
                                        + "37308,88770,16882\n"
                                        + "60695,13190,47306\n"
                                        + "97431,23898,77089\n"
                                        + "50619,31403,54101\n"
                                        + "42004,88166,98812\n"
                                        + "11469,104,40269\n"
                                        + "3508,41111,81839\n"
                                        + "66570,82155,42198\n"
                                        + "57067,2156,28129\n"
                                        + "48431,96497,95521\n"
                                        + "3654,98446,96020\n"
                                        + "50848,22558,86715\n"
                                        + "88043,92346,53570\n"
                                        + "4112,89212,7173\n"
                                        + "12173,68982,61510\n"
                                        + "78438,14743,19939\n"
                                        + "50619,25665,69661\n"
                                        + "60222,51037,87682\n"
                                        + "79006,69156,79206\n"
                                        + "25027,44623,1588\n"
                                        + "93974,74559,82073\n"
                                        + "84188,53485,85270\n"
                                        + "55197,76539,26731\n"
                                        + "36740,78476,24715\n"
                                        + "5841,30870,85067\n"
                                        + "87349,26040,65862\n"
                                        + "89240,29608,10964\n"
                                        + "45919,75545,84414\n"
                                        + "77440,92916,96638\n"
                                        + "58993,4708,11262\n"
                                        + "78229,63014,66185\n"
                                        + "97407,60669,83197\n"
                                        + "94944,9960,20674\n"
                                        + "44218,85190,64650\n"
                                        + "28176,93934,12957\n"
                                        + "14574,60134,94744\n"
                                        + "20258,1703,74854\n"
                                        + "24564,42902,85410\n"
                                        + "39907,71962,63981\n"
                                        + "67306,70185,16146\n"
                                        + "90646,13845,88528\n"
                                        + "43377,37429,92408\n"
                                        + "66302,85939,88636\n"
                                        + "29859,82588,97501\n"
                                        + "31939,46176,18417\n"
                                        + "51570,25312,85403\n"
                                        + "37243,15490,64126\n"
                                        + "73951,75958,68505\n"
                                        + "3317,78281,80920\n"
                                        + "52368,23692,91934\n"
                                        + "28005,85072,91979\n"
                                        + "33614,89898,60842\n"
                                        + "57164,73920,62477\n"
                                        + "88146,78925,84191\n"
                                        + "73541,123,73348\n"
                                        + "32013,58075,80274\n"
                                        + "64844,68796,36914\n"
                                        + "85522,29367,87600\n"
                                        + "6666,52451,14030\n"
                                        + "70560,47676,91640\n"
                                        + "29013,66590,95658\n"
                                        + "99850,89670,9071\n"
                                        + "29316,34107,73353\n"
                                        + "58964,12004,39705\n"
                                        + "94440,51073,38090\n"
                                        + "31112,84591,13573\n"
                                        + "47006,58442,70451\n"
                                        + "57825,47821,11866\n"
                                        + "93157,71900,80278\n"
                                        + "57064,5676,48977\n"
                                        + "5447,31119,65780\n"
                                        + "93869,21809,98295\n"
                                        + "47609,57379,87293\n"
                                        + "96597,64356,80118\n"
                                        + "61343,40103,2682\n"
                                        + "92949,75809,59637\n"
                                        + "47598,29639,81788\n"
                                        + "9860,39478,94798\n"
                                        + "84269,16472,46137\n"
                                        + "71707,8677,2259\n"
                                        + "68896,11032,95959\n"
                                        + "94132,76718,57577\n"
                                        + "44319,71956,67982\n"
                                        + "54888,96716,36153\n"
                                        + "22160,66347,7512\n"
                                        + "23679,1852,97458\n"
                                        + "81110,59623,54082\n"
                                        + "17334,79367,22869\n"
                                        + "58808,74760,88627\n"
                                        + "59064,31700,49962\n"
                                        + "1606,30918,5481\n"
                                        + "89271,52248,35922\n"
                                        + "21118,88942,9510\n"
                                        + "1339,48962,92639\n"
                                        + "87424,18583,67598\n"
                                        + "50399,20848,38484\n"
                                        + "62299,24660,28148\n"
                                        + "76318,68416,79978\n"
                                        + "81493,83564,853\n"
                                        + "47484,50782,31450\n"
                                        + "8477,792,75665\n"
                                        + "63908,34994,92010\n"
                                        + "38881,8603,91777\n"
                                        + "30395,93829,7587\n"
                                        + "26009,36187,37271\n"
                                        + "51769,23128,59852\n"
                                        + "86589,75074,24327\n"
                                        + "67190,65292,99472\n"
                                        + "32611,25889,33435\n"
                                        + "34457,44341,84778\n"
                                        + "79876,6342,69568\n"
                                        + "93829,60408,78579\n"
                                        + "3254,67324,97396\n"
                                        + "15178,61942,61590\n"
                                        + "84341,90489,29459\n"
                                        + "71565,7623,43575\n"
                                        + "43095,87709,48385\n"
                                        + "32908,28386,23473\n"
                                        + "57959,77160,95038\n"
                                        + "2789,17679,27244\n"
                                        + "54620,28003,36308\n"
                                        + "84616,66367,99158\n"
                                        + "44883,65356,83425\n"
                                        + "75536,8899,17148\n"
                                        + "8710,66897,22114\n"
                                        + "92235,47907,42289\n"
                                        + "81099,7796,74232\n"
                                        + "61836,71664,94509\n"
                                        + "44054,27503,60982\n"
                                        + "77055,37050,56929\n"
                                        + "75545,7474,46883\n"
                                        + "75047,72272,72752\n"
                                        + "81044,13161,78627\n"
                                        + "6810,39672,80359\n"
                                        + "54444,70798,87528\n"
                                        + "90506,28701,74899\n"
                                        + "7917,84876,85892\n"
                                        + "76215,24480,23520\n"
                                        + "14395,21565,51258\n"
                                        + "2090,64032,26292\n"
                                        + "41382,9386,8639\n"
                                        + "73346,61779,69586\n"
                                        + "21437,48799,94498\n"
                                        + "9034,66561,32828\n"
                                        + "6838,74092,4405\n"
                                        + "60282,2094,79059";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT), 10));
        Util.time(() -> a(Input.parse(INPUT), 1000));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
