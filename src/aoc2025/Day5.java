package aoc2025;

import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.stream.LongStream;

public class Day5 {
    private static void a(Input input) {
        System.out.println(LongStream.of(input.ingredients)
                                     .filter(i -> input.fresh.stream().anyMatch(f -> f.contains(i)))
                                     .count());
    }

    private static void b(Input input) {
        List<Range> disjointRanges = new ArrayList<>();
        input.fresh.stream().sorted(Comparator.<Range>comparingLong(o -> o.start).thenComparingLong(o -> -o.end))
                   .forEach(current -> {
                       for (Range locked : disjointRanges) {
                           if (locked.contains(current.start)) {
                               current = new Range(Math.min(locked.end + 1, current.end + 1), current.end);
                           }
                       }
                       if (current.start <= current.end) {
                           disjointRanges.add(current);
                       }
                   });

        System.out.println(disjointRanges.stream().mapToLong(range -> range.end - range.start + 1).sum());
    }

    record Range(long start, long end) {
        boolean contains(long value) {
            return start <= value && value <= end;
        }
    }

    record Input(List<Range> fresh, long[] ingredients) {
        static Input parse(String input) {
            List<Range> fresh = input.lines()
                                     .map(Util::extractLongs)
                                     .filter(l -> l.length == 2)
                                     .map(l -> new Range(l[0], -l[1]))
                                     .toList();
            long[] ingredients = input.lines()
                                      .map(Util::extractLongs)
                                      .filter(l -> l.length == 1)
                                      .mapToLong(l -> l[0])
                                      .toArray();
            return new Input(fresh, ingredients);
        }
    }

    private static final String TEST_INPUT = "3-5\n"
                                             + "10-14\n"
                                             + "16-20\n"
                                             + "12-18\n"
                                             + "\n"
                                             + "1\n"
                                             + "5\n"
                                             + "8\n"
                                             + "11\n"
                                             + "17\n"
                                             + "32";

    private static final String INPUT = "169486974574545-170251643963353\n"
                                        + "350457710225863-350888576149828\n"
                                        + "412668022187283-420338049796469\n"
                                        + "83592398782322-86848354888786\n"
                                        + "543631433070278-550047239522393\n"
                                        + "54642106271472-55339277279689\n"
                                        + "53411401957158-54202606041934\n"
                                        + "161774338930928-162461408006849\n"
                                        + "230409669398989-230409669398989\n"
                                        + "11394209724752-16043466617348\n"
                                        + "265838296793488-267797579010038\n"
                                        + "333958375901986-340440511082582\n"
                                        + "365878561655587-367060734788885\n"
                                        + "206173623518495-208892725730242\n"
                                        + "283627389269124-287511159291116\n"
                                        + "153365292360184-156019673771099\n"
                                        + "75536984781079-77165727327975\n"
                                        + "1619411001861-7121891284565\n"
                                        + "481329981942543-482000629244722\n"
                                        + "464553468357734-471131581665134\n"
                                        + "432458385573270-435515334151023\n"
                                        + "70448752368732-72110305170811\n"
                                        + "347882670820002-348212468442938\n"
                                        + "72545735761667-73944254348695\n"
                                        + "25337145734852-27963159368492\n"
                                        + "350677402162432-351380994452023\n"
                                        + "546416799583850-550851120598346\n"
                                        + "272929947013386-280747977038405\n"
                                        + "200502607169613-200502607169613\n"
                                        + "475873361991877-476277337247539\n"
                                        + "342101939844008-342852058158447\n"
                                        + "486239490794954-490237517599172\n"
                                        + "222455214858287-230409669398988\n"
                                        + "474010097524065-474827654040207\n"
                                        + "53411401957158-54202606041934\n"
                                        + "360113865157894-360113865157894\n"
                                        + "480910238254220-481329981942543\n"
                                        + "516174197223468-518816402892832\n"
                                        + "201659428112760-204121615094505\n"
                                        + "57717408554543-58122407961906\n"
                                        + "395911803566308-399327053790244\n"
                                        + "508868788402312-508868788402312\n"
                                        + "368405259282444-370023111163741\n"
                                        + "314516326843655-317549268809184\n"
                                        + "162232350328601-162461408006849\n"
                                        + "559686803138542-559686803138542\n"
                                        + "103338608596923-107554094171651\n"
                                        + "32913975686374-39732989816222\n"
                                        + "523901130815537-530703460706557\n"
                                        + "32913975686374-35290859827001\n"
                                        + "364003029454290-365324584461110\n"
                                        + "477889387261903-478118316872151\n"
                                        + "20806909809692-27963159368492\n"
                                        + "345837526507522-346164565414866\n"
                                        + "51740513080594-52409085527159\n"
                                        + "303484971907692-308412681226401\n"
                                        + "183906237377184-187976347273481\n"
                                        + "384706908852909-390346194454490\n"
                                        + "57852974455319-58122407961906\n"
                                        + "168689784685610-169356995569703\n"
                                        + "54886545352890-55257966550262\n"
                                        + "349114039096987-349487320391028\n"
                                        + "146788372377156-149108300248003\n"
                                        + "362928567972307-364510430479176\n"
                                        + "427408359544251-430040269311236\n"
                                        + "167568672967860-168207345342844\n"
                                        + "348440577989652-348894196644023\n"
                                        + "43208227708230-49758804908205\n"
                                        + "367769727274544-369109029982678\n"
                                        + "516174197223467-516174197223467\n"
                                        + "405856375959476-408496944374436\n"
                                        + "347882670820002-348440577989652\n"
                                        + "274598539023818-276871897377653\n"
                                        + "235424258744543-238506621244425\n"
                                        + "172630392640057-172630392640057\n"
                                        + "208050863272740-210361053323478\n"
                                        + "192237219410593-200502607169613\n"
                                        + "134729473420702-139983892386141\n"
                                        + "474010097524065-474305905223759\n"
                                        + "73508267403983-75291144718480\n"
                                        + "477087245968109-477889387261903\n"
                                        + "345837526507522-346478567624106\n"
                                        + "62613903146308-62613903146308\n"
                                        + "86848354888786-86848354888786\n"
                                        + "126394728062228-129522049716478\n"
                                        + "412668022187283-420338049796469\n"
                                        + "283627389269124-289921833430318\n"
                                        + "342401173107874-343162908583358\n"
                                        + "241750786712108-250182753568904\n"
                                        + "247240895255314-250182753568904\n"
                                        + "476651753875225-476960040171256\n"
                                        + "345148890039103-345455454180186\n"
                                        + "167772840329548-167985941724660\n"
                                        + "494234352071136-497303892670947\n"
                                        + "473347411356836-474010097524065\n"
                                        + "59397707463417-59966343820842\n"
                                        + "153365292360184-157936077085284\n"
                                        + "324686108322897-329753102093113\n"
                                        + "52946002321587-53411401957158\n"
                                        + "533445638590445-540186367605755\n"
                                        + "292298385683753-295792444429555\n"
                                        + "57717408554543-58122407961906\n"
                                        + "314516326843654-314516326843654\n"
                                        + "55849580681255-56357141651164\n"
                                        + "231698593106163-235424258744542\n"
                                        + "434256671568972-436538941154228\n"
                                        + "439104555586761-441593495703514\n"
                                        + "384706908852909-384706908852909\n"
                                        + "164762330697985-164969667575089\n"
                                        + "362276900056335-363670143941921\n"
                                        + "366541882302880-368122635566150\n"
                                        + "11394209724752-16043466617348\n"
                                        + "343999514461259-344509033218459\n"
                                        + "203436319276917-205640943197084\n"
                                        + "349637919178361-350026632310006\n"
                                        + "52640081604997-53117523372446\n"
                                        + "503203389229978-508868788402311\n"
                                        + "92989145845687-96524214733722\n"
                                        + "163044740996218-163240511195133\n"
                                        + "76752836650791-78123362707607\n"
                                        + "123455758474555-126394728062227\n"
                                        + "101424352095858-110086771279740\n"
                                        + "525619552424679-528959977856256\n"
                                        + "183906237377183-183906237377183\n"
                                        + "554074836948068-559686803138542\n"
                                        + "77779604315574-79158148059598\n"
                                        + "141205463388944-146788372377154\n"
                                        + "370452833833991-371897898223566\n"
                                        + "49758804908206-49758804908206\n"
                                        + "374114511950407-377644029616368\n"
                                        + "494234352071136-501863783760968\n"
                                        + "478600117928393-478824710671111\n"
                                        + "172630392640057-179520209905481\n"
                                        + "423465253017527-427408359544249\n"
                                        + "78635312190451-80232475910069\n"
                                        + "377644029616369-379811872274849\n"
                                        + "355131858666440-360113865157894\n"
                                        + "475033176088839-475649812150129\n"
                                        + "254798182447389-259910083230244\n"
                                        + "58995278820687-59397707463417\n"
                                        + "112810316106639-116323918708015\n"
                                        + "345737380640930-345837526507522\n"
                                        + "116323918708017-119144923116978\n"
                                        + "212623125402992-220123949658034\n"
                                        + "348440577989652-349114039096987\n"
                                        + "484679585430218-486239490794953\n"
                                        + "538678075001302-540186367605755\n"
                                        + "130987447947074-137332783042981\n"
                                        + "62613903146308-65939644438015\n"
                                        + "403504575059351-410013419146208\n"
                                        + "364943267837974-366372560110142\n"
                                        + "481108061072351-481329981942543\n"
                                        + "437720846119634-440454991965740\n"
                                        + "71584582295120-72963896717108\n"
                                        + "472513591299362-472918717631593\n"
                                        + "464553468357734-464553468357734\n"
                                        + "392482661906061-399327053790244\n"
                                        + "74524649575795-76267967421178\n"
                                        + "168207345342844-168583893783486\n"
                                        + "477087245968109-477279401948376\n"
                                        + "55849580681255-56751399357064\n"
                                        + "436347159101619-438410653267442\n"
                                        + "51298814197636-52196252110091\n"
                                        + "163044740996218-163633550337293\n"
                                        + "342770680395427-342852058158447\n"
                                        + "1619411001860-1619411001860\n"
                                        + "454830743926318-461227564607971\n"
                                        + "204512289107481-207201836850737\n"
                                        + "295792444429557-300642043871836\n"
                                        + "167985941724660-168583893783486\n"
                                        + "480910238254220-481695161883099\n"
                                        + "265838296793488-267797579010038\n"
                                        + "478600117928393-479038689890985\n"
                                        + "454830743926318-461227564607971\n"
                                        + "51298814197636-51740513080594\n"
                                        + "369404546102670-370868390469186\n"
                                        + "345837526507522-346164565414866\n"
                                        + "304645312705932-310580105808502\n"
                                        + "251935678435015-257633285751739\n"
                                        + "329753102093114-329753102093114\n"
                                        + "443500959989085-451450465997509\n"
                                        + "51298814197636-52196252110091\n"
                                        + "\n"
                                        + "166774327825644\n"
                                        + "91047458369966\n"
                                        + "404952508284339\n"
                                        + "378520907949428\n"
                                        + "325621911145521\n"
                                        + "268242101107817\n"
                                        + "546085944803731\n"
                                        + "454899401278924\n"
                                        + "88862938669386\n"
                                        + "496100464432050\n"
                                        + "289057181519769\n"
                                        + "90727792836649\n"
                                        + "337288198669145\n"
                                        + "429094156122272\n"
                                        + "343633512916410\n"
                                        + "92886236123125\n"
                                        + "378139567233455\n"
                                        + "439641576767616\n"
                                        + "247301227994645\n"
                                        + "68713748805875\n"
                                        + "208716676008021\n"
                                        + "497074374734370\n"
                                        + "559885823894181\n"
                                        + "492095693832264\n"
                                        + "554963120377769\n"
                                        + "443896984163009\n"
                                        + "206006923989321\n"
                                        + "483032749206065\n"
                                        + "47577646102574\n"
                                        + "292521463036307\n"
                                        + "216230717404539\n"
                                        + "448739194445012\n"
                                        + "442035479231881\n"
                                        + "519714926322577\n"
                                        + "403713656861498\n"
                                        + "374756451523046\n"
                                        + "478314416927106\n"
                                        + "377836316243415\n"
                                        + "498772052463351\n"
                                        + "333022116865348\n"
                                        + "135692758943211\n"
                                        + "294037907597476\n"
                                        + "263323517435128\n"
                                        + "440825739263296\n"
                                        + "434995455366622\n"
                                        + "337212881252755\n"
                                        + "146153984473380\n"
                                        + "448601868945693\n"
                                        + "408100845362893\n"
                                        + "35583521113278\n"
                                        + "225403433549332\n"
                                        + "317696241596672\n"
                                        + "312014019668924\n"
                                        + "362115200307652\n"
                                        + "554760333330106\n"
                                        + "154282704810251\n"
                                        + "438959797352439\n"
                                        + "319452260444851\n"
                                        + "473156766088282\n"
                                        + "198403531998350\n"
                                        + "504423873956916\n"
                                        + "429367609375118\n"
                                        + "126266607271906\n"
                                        + "26674090809762\n"
                                        + "530017595777797\n"
                                        + "77956466007652\n"
                                        + "143490545051443\n"
                                        + "250510694180056\n"
                                        + "326130853845873\n"
                                        + "205070489620183\n"
                                        + "147090705023854\n"
                                        + "204182443095809\n"
                                        + "288679101880747\n"
                                        + "243801389965051\n"
                                        + "182008355369256\n"
                                        + "45128892324888\n"
                                        + "476607297358048\n"
                                        + "531771182080436\n"
                                        + "73516497016098\n"
                                        + "316726833468449\n"
                                        + "362906532335825\n"
                                        + "435314854551601\n"
                                        + "290974906905504\n"
                                        + "157230439564388\n"
                                        + "86563221570145\n"
                                        + "24063423156372\n"
                                        + "43581070629947\n"
                                        + "427217170097429\n"
                                        + "395299379557797\n"
                                        + "544551981061231\n"
                                        + "15205854665320\n"
                                        + "53234016286885\n"
                                        + "399136093173212\n"
                                        + "292094746756200\n"
                                        + "491175189160611\n"
                                        + "199251817787429\n"
                                        + "111086427066885\n"
                                        + "471998625163919\n"
                                        + "273174678462782\n"
                                        + "490995373871544\n"
                                        + "34898033068500\n"
                                        + "229275663034833\n"
                                        + "419334245035424\n"
                                        + "41965901830193\n"
                                        + "407830580606630\n"
                                        + "27502544185036\n"
                                        + "156565938081564\n"
                                        + "514048184413057\n"
                                        + "521744695790109\n"
                                        + "141491285324069\n"
                                        + "392325069875868\n"
                                        + "510980130947114\n"
                                        + "174723942867829\n"
                                        + "556352074108761\n"
                                        + "43427842503161\n"
                                        + "146696161286344\n"
                                        + "104746357885859\n"
                                        + "15275765849861\n"
                                        + "281559681026688\n"
                                        + "429139225151741\n"
                                        + "396910615804192\n"
                                        + "442408317235005\n"
                                        + "132772453136679\n"
                                        + "155135334989459\n"
                                        + "200470713530827\n"
                                        + "220689700977119\n"
                                        + "168334134153744\n"
                                        + "157503332651641\n"
                                        + "149663209145269\n"
                                        + "343632254653643\n"
                                        + "497528664863277\n"
                                        + "106690107773611\n"
                                        + "34099564590700\n"
                                        + "448413992513436\n"
                                        + "475520911454283\n"
                                        + "301687971625084\n"
                                        + "9980454276181\n"
                                        + "240111072470395\n"
                                        + "37340591261478\n"
                                        + "288852137211212\n"
                                        + "475298931312112\n"
                                        + "214515170796338\n"
                                        + "500110784985138\n"
                                        + "515633106108978\n"
                                        + "544761044008642\n"
                                        + "112006257449342\n"
                                        + "342516445985685\n"
                                        + "73401353536885\n"
                                        + "123678078844082\n"
                                        + "206016682334723\n"
                                        + "485144331084789\n"
                                        + "90165056085394\n"
                                        + "77579052160686\n"
                                        + "499840743815185\n"
                                        + "237563103284284\n"
                                        + "139759202638467\n"
                                        + "162227122680255\n"
                                        + "113057027572568\n"
                                        + "438666695332958\n"
                                        + "158470826981849\n"
                                        + "535518691265400\n"
                                        + "254227700432454\n"
                                        + "253825750937685\n"
                                        + "560330325476428\n"
                                        + "154600147802843\n"
                                        + "549790739569034\n"
                                        + "289873164396695\n"
                                        + "539498241340336\n"
                                        + "547087343925695\n"
                                        + "426793043068177\n"
                                        + "69406275853236\n"
                                        + "14173153440243\n"
                                        + "306613204257181\n"
                                        + "335628041490725\n"
                                        + "77668534832095\n"
                                        + "408856705538595\n"
                                        + "52257595224282\n"
                                        + "378047409571086\n"
                                        + "139108263947637\n"
                                        + "484991719095291\n"
                                        + "493284067026758\n"
                                        + "142677908005147\n"
                                        + "63970767087445\n"
                                        + "546284579954929\n"
                                        + "336645727455680\n"
                                        + "92019100262899\n"
                                        + "13529714907659\n"
                                        + "222144029068424\n"
                                        + "545536837640330\n"
                                        + "428432432029515\n"
                                        + "459840949966208\n"
                                        + "447710485749632\n"
                                        + "498615999177888\n"
                                        + "130650784933857\n"
                                        + "33555847493984\n"
                                        + "449331183743590\n"
                                        + "488515663620787\n"
                                        + "553075138140193\n"
                                        + "61441497652823\n"
                                        + "153914238077790\n"
                                        + "496362331734422\n"
                                        + "314346491893291\n"
                                        + "440155676882947\n"
                                        + "379905912125002\n"
                                        + "99554008377065\n"
                                        + "45081920765806\n"
                                        + "505235190993142\n"
                                        + "306393771255886\n"
                                        + "319907372816476\n"
                                        + "277228163816061\n"
                                        + "400768808830359\n"
                                        + "510582755621519\n"
                                        + "4194290219194\n"
                                        + "481101819993467\n"
                                        + "523353832646727\n"
                                        + "205765537357831\n"
                                        + "343468690986522\n"
                                        + "131578423633226\n"
                                        + "434673084239015\n"
                                        + "371766027051303\n"
                                        + "144329935374669\n"
                                        + "139437541951224\n"
                                        + "465802130555913\n"
                                        + "167902011625254\n"
                                        + "72057652886449\n"
                                        + "347437328991353\n"
                                        + "263451819863886\n"
                                        + "192977391964026\n"
                                        + "492929013900137\n"
                                        + "154794338298037\n"
                                        + "522652226020058\n"
                                        + "554923432030486\n"
                                        + "519919555270186\n"
                                        + "249518239643285\n"
                                        + "358970107775753\n"
                                        + "80413199256712\n"
                                        + "275594334714499\n"
                                        + "553421607746393\n"
                                        + "98275619718110\n"
                                        + "302825984544905\n"
                                        + "174717141496020\n"
                                        + "230288973137562\n"
                                        + "292589182404411\n"
                                        + "505687418573659\n"
                                        + "349247528804259\n"
                                        + "20293692905023\n"
                                        + "240453445858027\n"
                                        + "224257842516546\n"
                                        + "304130767608387\n"
                                        + "304907136037024\n"
                                        + "408166394354772\n"
                                        + "103523839764491\n"
                                        + "73232136461566\n"
                                        + "140468463705508\n"
                                        + "311772003245493\n"
                                        + "331790724794140\n"
                                        + "93708199162906\n"
                                        + "162580150832440\n"
                                        + "449460000094559\n"
                                        + "277197897984645\n"
                                        + "205763891375110\n"
                                        + "19084635772736\n"
                                        + "496419186274794\n"
                                        + "470727201928223\n"
                                        + "485281849665196\n"
                                        + "552053076054079\n"
                                        + "431468704048245\n"
                                        + "76281897291\n"
                                        + "349523959877693\n"
                                        + "270456878893079\n"
                                        + "111101684122584\n"
                                        + "465800898958960\n"
                                        + "322283852128561\n"
                                        + "455213177508997\n"
                                        + "247665311665579\n"
                                        + "500922881756589\n"
                                        + "219524289499707\n"
                                        + "115323986356921\n"
                                        + "37301704048791\n"
                                        + "377657381382923\n"
                                        + "399245034825861\n"
                                        + "399137551109704\n"
                                        + "285052077702242\n"
                                        + "175745328787311\n"
                                        + "245041458958184\n"
                                        + "35936598644078\n"
                                        + "547099513362520\n"
                                        + "359611859652486\n"
                                        + "204033001215851\n"
                                        + "29342247975471\n"
                                        + "39126462245283\n"
                                        + "443969245402798\n"
                                        + "347385388155441\n"
                                        + "109989290386312\n"
                                        + "153901115627129\n"
                                        + "402919114061017\n"
                                        + "286247392087343\n"
                                        + "328624943744608\n"
                                        + "236904877535583\n"
                                        + "523236113372747\n"
                                        + "434675877307776\n"
                                        + "27674435121456\n"
                                        + "378216883223033\n"
                                        + "282898606567911\n"
                                        + "56026201149263\n"
                                        + "464544460566619\n"
                                        + "248276994486089\n"
                                        + "273492366150243\n"
                                        + "171087374795861\n"
                                        + "405435698757553\n"
                                        + "468944442788875\n"
                                        + "7049732367352\n"
                                        + "376735622849138\n"
                                        + "465012318485387\n"
                                        + "198100033101471\n"
                                        + "285562486089743\n"
                                        + "386344157741757\n"
                                        + "211071073318516\n"
                                        + "271557956243230\n"
                                        + "316094793010015\n"
                                        + "526573252229373\n"
                                        + "150383520289242\n"
                                        + "353008308480241\n"
                                        + "33123570103319\n"
                                        + "453952884356644\n"
                                        + "366157930303720\n"
                                        + "397812086863838\n"
                                        + "124217788847844\n"
                                        + "105934191361195\n"
                                        + "49745618863657\n"
                                        + "122008798112999\n"
                                        + "285249575332918\n"
                                        + "239025960707951\n"
                                        + "191925873999393\n"
                                        + "511321770610334\n"
                                        + "198592227375691\n"
                                        + "172719309600276\n"
                                        + "303636693797816\n"
                                        + "400470943462252\n"
                                        + "525625440685246\n"
                                        + "202232306722844\n"
                                        + "304151285095384\n"
                                        + "358632108681359\n"
                                        + "32705945457149\n"
                                        + "429740280260146\n"
                                        + "130138390342090\n"
                                        + "206605674498611\n"
                                        + "483121948365376\n"
                                        + "250510040752339\n"
                                        + "351921064694049\n"
                                        + "535953664899745\n"
                                        + "158982805815737\n"
                                        + "266481019547471\n"
                                        + "231185500366155\n"
                                        + "375457642508105\n"
                                        + "379254716521887\n"
                                        + "522704569941592\n"
                                        + "253921764244290\n"
                                        + "376581066623112\n"
                                        + "482448004328873\n"
                                        + "92897693882413\n"
                                        + "308082658112356\n"
                                        + "134926238563825\n"
                                        + "552017602142312\n"
                                        + "499186706253637\n"
                                        + "228968019568939\n"
                                        + "552698362888668\n"
                                        + "413972746049689\n"
                                        + "184067938318774\n"
                                        + "235837199222396\n"
                                        + "496246484173299\n"
                                        + "531756589501261\n"
                                        + "480286521324801\n"
                                        + "376794227331873\n"
                                        + "526362702872444\n"
                                        + "252465295891886\n"
                                        + "66438065687693\n"
                                        + "523692313003135\n"
                                        + "75474495675861\n"
                                        + "407087658568321\n"
                                        + "299103592741349\n"
                                        + "489933891930451\n"
                                        + "469566832122542\n"
                                        + "236585411136668\n"
                                        + "385792759141446\n"
                                        + "199862910462477\n"
                                        + "204234857664791\n"
                                        + "436025855142507\n"
                                        + "447086196413929\n"
                                        + "474562365525964\n"
                                        + "104199028836605\n"
                                        + "559091073788308\n"
                                        + "550823053762154\n"
                                        + "12554729643032\n"
                                        + "458024648847184\n"
                                        + "529809193948024\n"
                                        + "230755709261846\n"
                                        + "515708781882909\n"
                                        + "430686836417890\n"
                                        + "427022962074744\n"
                                        + "10344169433954\n"
                                        + "529600667662099\n"
                                        + "314031716058590\n"
                                        + "380415441188599\n"
                                        + "80735780063370\n"
                                        + "147995713700406\n"
                                        + "300154675727708\n"
                                        + "254100597066464\n"
                                        + "419430042425209\n"
                                        + "347898083694759\n"
                                        + "249982748292502\n"
                                        + "131591948140352\n"
                                        + "198961066256750\n"
                                        + "254064651718220\n"
                                        + "294549907082315\n"
                                        + "355855335549975\n"
                                        + "39095550579264\n"
                                        + "215057752113540\n"
                                        + "198911085823360\n"
                                        + "105315096195198\n"
                                        + "96911775053522\n"
                                        + "9752114023042\n"
                                        + "119608753327095\n"
                                        + "352109210076272\n"
                                        + "299660081952358\n"
                                        + "221342243195663\n"
                                        + "449827754968231\n"
                                        + "93161124128574\n"
                                        + "90560460067988\n"
                                        + "496820623206224\n"
                                        + "399035515487329\n"
                                        + "467039225296969\n"
                                        + "226205475803100\n"
                                        + "406250706063702\n"
                                        + "161376090137496\n"
                                        + "466642236986406\n"
                                        + "87720858451453\n"
                                        + "539998160378913\n"
                                        + "474240741925151\n"
                                        + "277488291971913\n"
                                        + "450850530532280\n"
                                        + "482580184705728\n"
                                        + "15178409260792\n"
                                        + "369966906873577\n"
                                        + "400180173996328\n"
                                        + "545520527368074\n"
                                        + "554039014929435\n"
                                        + "120288590508287\n"
                                        + "480499899695046\n"
                                        + "30680680513644\n"
                                        + "395953882351651\n"
                                        + "331163443172107\n"
                                        + "538320803328506\n"
                                        + "133848213353087\n"
                                        + "145447720285170\n"
                                        + "530096349236746\n"
                                        + "135712192178712\n"
                                        + "172660263989807\n"
                                        + "310646583405735\n"
                                        + "150976892032270\n"
                                        + "80303563356605\n"
                                        + "72150987366375\n"
                                        + "109574604058464\n"
                                        + "332565509676132\n"
                                        + "157262606965695\n"
                                        + "536137192446697\n"
                                        + "142574755052471\n"
                                        + "547002315544389\n"
                                        + "325580540545510\n"
                                        + "511807714132532\n"
                                        + "63170811304147\n"
                                        + "238171943106505\n"
                                        + "32278044680851\n"
                                        + "179196591322316\n"
                                        + "60476845998806\n"
                                        + "284676411075326\n"
                                        + "389916634471871\n"
                                        + "283424058473505\n"
                                        + "35677745835226\n"
                                        + "159735707193319\n"
                                        + "165751606408001\n"
                                        + "495282293549472\n"
                                        + "236887629497311\n"
                                        + "357049330901689\n"
                                        + "446024442218974\n"
                                        + "330289464969167\n"
                                        + "261767824871893\n"
                                        + "547134171577378\n"
                                        + "271894738315108\n"
                                        + "464445794485769\n"
                                        + "283707594225371\n"
                                        + "253194669396361\n"
                                        + "325228375230067\n"
                                        + "100167990043675\n"
                                        + "327074956674009\n"
                                        + "347177664977676\n"
                                        + "372780048698071\n"
                                        + "219800585406824\n"
                                        + "498885421047630\n"
                                        + "512193212681227\n"
                                        + "136278702175098\n"
                                        + "465930952499220\n"
                                        + "494968478723722\n"
                                        + "518730224649751\n"
                                        + "341718847619297\n"
                                        + "369179893782034\n"
                                        + "18121280125790\n"
                                        + "502047998998948\n"
                                        + "484247612508853\n"
                                        + "243685163913354\n"
                                        + "173885282196723\n"
                                        + "454559310285359\n"
                                        + "222481381853756\n"
                                        + "36481973632734\n"
                                        + "116568229233070\n"
                                        + "200682472235708\n"
                                        + "367381773923936\n"
                                        + "318140580419192\n"
                                        + "112746752748157\n"
                                        + "194425586115078\n"
                                        + "139920342874717\n"
                                        + "477854212858029\n"
                                        + "212782546089078\n"
                                        + "411702881636276\n"
                                        + "54614831725181\n"
                                        + "119613230049112\n"
                                        + "107957548533008\n"
                                        + "306551673436599\n"
                                        + "549081498723393\n"
                                        + "548626856154576\n"
                                        + "160349494359209\n"
                                        + "324318282735730\n"
                                        + "386448067125454\n"
                                        + "27300210555086\n"
                                        + "514902811407797\n"
                                        + "108516545097433\n"
                                        + "533882495640448\n"
                                        + "12389113182564\n"
                                        + "196435848198080\n"
                                        + "200386570578615\n"
                                        + "327994991203546\n"
                                        + "224990930591296\n"
                                        + "207258895819722\n"
                                        + "468283840902024\n"
                                        + "465322974978643\n"
                                        + "417331553592809\n"
                                        + "267062196670485\n"
                                        + "534882878531783\n"
                                        + "485795748442565\n"
                                        + "124686049206296\n"
                                        + "122417371941044\n"
                                        + "179677582114325\n"
                                        + "355648713774809\n"
                                        + "456775682757418\n"
                                        + "455875269976321\n"
                                        + "201520187565331\n"
                                        + "313468690853343\n"
                                        + "388607312186246\n"
                                        + "407880900356278\n"
                                        + "505910380417316\n"
                                        + "521668910461157\n"
                                        + "302438493660595\n"
                                        + "68632453018008\n"
                                        + "216516287566682\n"
                                        + "220153010370991\n"
                                        + "170743111358423\n"
                                        + "476602833583011\n"
                                        + "136714925539866\n"
                                        + "138542773800608\n"
                                        + "247937496976447\n"
                                        + "544572691111046\n"
                                        + "422461680747741\n"
                                        + "495972631659052\n"
                                        + "396257346899195\n"
                                        + "165858869725569\n"
                                        + "184036350334348\n"
                                        + "114816205868801\n"
                                        + "468919534915319\n"
                                        + "359698785498507\n"
                                        + "132331751780775\n"
                                        + "239718654581434\n"
                                        + "50834178782395\n"
                                        + "161964306160464\n"
                                        + "31349446995438\n"
                                        + "169847193913893\n"
                                        + "554036884459619\n"
                                        + "70888025693166\n"
                                        + "467980930193560\n"
                                        + "87169550705955\n"
                                        + "352889260590027\n"
                                        + "207006180941867\n"
                                        + "101192316051676\n"
                                        + "418316979509841\n"
                                        + "275255999278932\n"
                                        + "500211864880517\n"
                                        + "247683565035233\n"
                                        + "358000736149919\n"
                                        + "179092401762171\n"
                                        + "262295061294554\n"
                                        + "462291069839473\n"
                                        + "362219924628579\n"
                                        + "35584727855687\n"
                                        + "495689617672703\n"
                                        + "321096712807163\n"
                                        + "156364174620707\n"
                                        + "437031146558623\n"
                                        + "446679647768106\n"
                                        + "184440728802140\n"
                                        + "179356086860912\n"
                                        + "306891786124622\n"
                                        + "268358471924233\n"
                                        + "365713738595080\n"
                                        + "252110336879163\n"
                                        + "521753426679053\n"
                                        + "142089571248901\n"
                                        + "233364018812935\n"
                                        + "370243133281741\n"
                                        + "432653663089468\n"
                                        + "532163582734910\n"
                                        + "245359058488424\n"
                                        + "298473508335275\n"
                                        + "14031841956723\n"
                                        + "57758508231202\n"
                                        + "276785474301686\n"
                                        + "387031828270953\n"
                                        + "418561042543787\n"
                                        + "226025352024472\n"
                                        + "168616632323375\n"
                                        + "311324670253932\n"
                                        + "547033628524340\n"
                                        + "337858669245797\n"
                                        + "378941433166064\n"
                                        + "434546414339480\n"
                                        + "78370809294330\n"
                                        + "102398932025390\n"
                                        + "27462225362802\n"
                                        + "271644860641047\n"
                                        + "59211680553870\n"
                                        + "374355924515856\n"
                                        + "494149562346856\n"
                                        + "213796833170602\n"
                                        + "128135299204247\n"
                                        + "84211937157469\n"
                                        + "107789712965090\n"
                                        + "315004087428381\n"
                                        + "178674310012579\n"
                                        + "94222198781966\n"
                                        + "501454541701207\n"
                                        + "365333830515032\n"
                                        + "16161431876644\n"
                                        + "224979397972164\n"
                                        + "421498139560827\n"
                                        + "412437440049979\n"
                                        + "209121212751838\n"
                                        + "293402144169905\n"
                                        + "58518948754701\n"
                                        + "61064684714537\n"
                                        + "263104024059027\n"
                                        + "415830606177897\n"
                                        + "116101661231073\n"
                                        + "287296300703319\n"
                                        + "493171466545647\n"
                                        + "384809141661398\n"
                                        + "366268084709017\n"
                                        + "5818563609451\n"
                                        + "120385781854262\n"
                                        + "205173946461332\n"
                                        + "54227022193045\n"
                                        + "113669352148263\n"
                                        + "104280079340054\n"
                                        + "238631636388913\n"
                                        + "515441396296070\n"
                                        + "159206962175763\n"
                                        + "302525814386414\n"
                                        + "339164299598453\n"
                                        + "409578249037337\n"
                                        + "70028767566230\n"
                                        + "551246401580664\n"
                                        + "90986719623993\n"
                                        + "239400067544876\n"
                                        + "443230144976513\n"
                                        + "186795213046561\n"
                                        + "140231198077831\n"
                                        + "368739361751067\n"
                                        + "452456527289621\n"
                                        + "171671532434000\n"
                                        + "30931652757817\n"
                                        + "416957992048482\n"
                                        + "463069395875833\n"
                                        + "253755350992279\n"
                                        + "349965935700429\n"
                                        + "133749783233188\n"
                                        + "180340731313778\n"
                                        + "33363980680018\n"
                                        + "374134294864507\n"
                                        + "428936219872049\n"
                                        + "206504381518276\n"
                                        + "242106673977763\n"
                                        + "78473546271018\n"
                                        + "406533910239398\n"
                                        + "348365497824643\n"
                                        + "422545173570195\n"
                                        + "385468965921062\n"
                                        + "389459883982367\n"
                                        + "274101373507453\n"
                                        + "459134086881060\n"
                                        + "260614137764036\n"
                                        + "432619487732863\n"
                                        + "75943978969609\n"
                                        + "505570839641777\n"
                                        + "444169632072478\n"
                                        + "312730304789069\n"
                                        + "197557319636041\n"
                                        + "543647435965560\n"
                                        + "408265085050905\n"
                                        + "281586696861111\n"
                                        + "171123135278775\n"
                                        + "169177863584715\n"
                                        + "135874101403130\n"
                                        + "209377109419580\n"
                                        + "256271393941940\n"
                                        + "70452063565247\n"
                                        + "250769496553007\n"
                                        + "223944217959492\n"
                                        + "108632638730605\n"
                                        + "451964402873132\n"
                                        + "339383738439337\n"
                                        + "314755936046586\n"
                                        + "251717159170970\n"
                                        + "414342097829544\n"
                                        + "49274921382019\n"
                                        + "440343085052918\n"
                                        + "272517019507874\n"
                                        + "503487049856713\n"
                                        + "304083032446976\n"
                                        + "9836321621803\n"
                                        + "557853443983096\n"
                                        + "386806299514432\n"
                                        + "230379467150045\n"
                                        + "232023573717795\n"
                                        + "274489679300692\n"
                                        + "401325353109711\n"
                                        + "344716266688317\n"
                                        + "479400650716478\n"
                                        + "123206571735690\n"
                                        + "384655568576539\n"
                                        + "219773398158939\n"
                                        + "31295584853941\n"
                                        + "143433803077974\n"
                                        + "7561633804086\n"
                                        + "85756695376827\n"
                                        + "398284723132607\n"
                                        + "26623728524409\n"
                                        + "83183595817576\n"
                                        + "286957840183868\n"
                                        + "120636608165605\n"
                                        + "357724055042151\n"
                                        + "469680621960771\n"
                                        + "384067541851018\n"
                                        + "405289416687099\n"
                                        + "410808664927062\n"
                                        + "238794187284823\n"
                                        + "414890307360090\n"
                                        + "196104637822439\n"
                                        + "127544444499349\n"
                                        + "221984070862241\n"
                                        + "132518041974535\n"
                                        + "112940565231543\n"
                                        + "265275705436390\n"
                                        + "479025893934810\n"
                                        + "314505867497367\n"
                                        + "496263702544464\n"
                                        + "148143576830654\n"
                                        + "115376626359323\n"
                                        + "557691219367239\n"
                                        + "45905454760957\n"
                                        + "524675720827548\n"
                                        + "22064684741843\n"
                                        + "252994432278803\n"
                                        + "517397261955144\n"
                                        + "452871657432505\n"
                                        + "337201911451932\n"
                                        + "88763534103445\n"
                                        + "173676858500472\n"
                                        + "348768711387613\n"
                                        + "138471044229711\n"
                                        + "95399248614045\n"
                                        + "68285619776492\n"
                                        + "318457822556018\n"
                                        + "525105694589579\n"
                                        + "517805457516633\n"
                                        + "378989018882559\n"
                                        + "368298292538616\n"
                                        + "458658561435518\n"
                                        + "207422464400509\n"
                                        + "181866569133454\n"
                                        + "525640297406461\n"
                                        + "129229881420908\n"
                                        + "51717759679443\n"
                                        + "166092571951220\n"
                                        + "256408042663479\n"
                                        + "275292791989704\n"
                                        + "118319831731504\n"
                                        + "5633133708006\n"
                                        + "194395191717822\n"
                                        + "310435849658461\n"
                                        + "463025478328394\n"
                                        + "527077985492674\n"
                                        + "21106581449621\n"
                                        + "523549300613533\n"
                                        + "398214390451437\n"
                                        + "171025532583124\n"
                                        + "213138707290654\n"
                                        + "326653422501064\n"
                                        + "477914754170203\n"
                                        + "267571570824864\n"
                                        + "46626246940772\n"
                                        + "476735477541776\n"
                                        + "145035252872093\n"
                                        + "187916186413891\n"
                                        + "371693525502994\n"
                                        + "168673863508163\n"
                                        + "346959319988017\n"
                                        + "454491121936793\n"
                                        + "217885984189970\n"
                                        + "299221157582395\n"
                                        + "164810512090946\n"
                                        + "212519092200144\n"
                                        + "189755604591660\n"
                                        + "86785344019253\n"
                                        + "123692871131037\n"
                                        + "275273479722087\n"
                                        + "172201699513478\n"
                                        + "307100655626988\n"
                                        + "8429324160009\n"
                                        + "11688874902984\n"
                                        + "93429701044828\n"
                                        + "87505554320007\n"
                                        + "192547267337156\n"
                                        + "424980042713196\n"
                                        + "232232355674129\n"
                                        + "120882770297477\n"
                                        + "400642598192429\n"
                                        + "112474076477861\n"
                                        + "10340906762331\n"
                                        + "468185262885354\n"
                                        + "473115146434914\n"
                                        + "546220244501277\n"
                                        + "230746941039487\n"
                                        + "474003157713676\n"
                                        + "44868234288982\n"
                                        + "134879528193057\n"
                                        + "423906683473633\n"
                                        + "212063817695168\n"
                                        + "271695045483699\n"
                                        + "409441138399226\n"
                                        + "476263702459672\n"
                                        + "516238652632498\n"
                                        + "352219807950940\n"
                                        + "428243297944988\n"
                                        + "141935371043504\n"
                                        + "365325692257606\n"
                                        + "221266910655110\n"
                                        + "3169796195887\n"
                                        + "367133246977675\n"
                                        + "458638914268606\n"
                                        + "381166588589841\n"
                                        + "334196333309437\n"
                                        + "249709703265767\n"
                                        + "366808681147270\n"
                                        + "140601356365909\n"
                                        + "490426342099955\n"
                                        + "319540267637888\n"
                                        + "372354531067299\n"
                                        + "108558567973915\n"
                                        + "219216361647628\n"
                                        + "490413942590716\n"
                                        + "546169226369143\n"
                                        + "267961218722974\n"
                                        + "316709186119253\n"
                                        + "330318122561515\n"
                                        + "7914554630956\n"
                                        + "214248574179445\n"
                                        + "225217158276800\n"
                                        + "266018543894708\n"
                                        + "76916781182273\n"
                                        + "61938963784429\n"
                                        + "290159525874705\n"
                                        + "31456612431862\n"
                                        + "84679786180184\n"
                                        + "172374064863107\n"
                                        + "37353984479663\n"
                                        + "340133489894036\n"
                                        + "280746496541083\n"
                                        + "60142024461394\n"
                                        + "8862582481952\n"
                                        + "234025965023325\n"
                                        + "93054503232686\n"
                                        + "539882817169577\n"
                                        + "536566109891024\n"
                                        + "144011267061452\n"
                                        + "451312569796552\n"
                                        + "350329972823014\n"
                                        + "476257951614801\n"
                                        + "45590639642899\n"
                                        + "451351680776874\n"
                                        + "425164577202709\n"
                                        + "226607172134288\n"
                                        + "227902543752441\n"
                                        + "326465979074352\n"
                                        + "181342541666891\n"
                                        + "462660700607043\n"
                                        + "150224259144078\n"
                                        + "488630331998626\n"
                                        + "54860468478369\n"
                                        + "101914026619125\n"
                                        + "294756653101713\n"
                                        + "202272597191959\n"
                                        + "76050673612329\n"
                                        + "238860757008309\n"
                                        + "48621264302279\n"
                                        + "14319569575066\n"
                                        + "560780594889128\n"
                                        + "144584257609115\n"
                                        + "7002261598710\n"
                                        + "251737669455207\n"
                                        + "102490965796155\n"
                                        + "254089228645909\n"
                                        + "458850237935972\n"
                                        + "444494162113316\n"
                                        + "342612583612144\n"
                                        + "203261620323802\n"
                                        + "130739573902267\n"
                                        + "556503818068118\n"
                                        + "558892062105595\n"
                                        + "36094704072154\n"
                                        + "95593696940294\n"
                                        + "244216036056071\n"
                                        + "263649852755312\n"
                                        + "125782927760917\n"
                                        + "318698954414381\n"
                                        + "163405285563569\n"
                                        + "62989351003745\n"
                                        + "483851364863882\n"
                                        + "85875561472613\n"
                                        + "258960741690709\n"
                                        + "407576336377045\n"
                                        + "448360245242560\n"
                                        + "249577485109234\n"
                                        + "433669489426532\n"
                                        + "219916919792675\n"
                                        + "148832385339069\n"
                                        + "32205722322915\n"
                                        + "32897635016190\n"
                                        + "177545108774500\n"
                                        + "91884027353209\n"
                                        + "89540680416542\n"
                                        + "141028982943171\n"
                                        + "242867991040476\n"
                                        + "200955710974663\n"
                                        + "259952079512445\n"
                                        + "426148978382011\n"
                                        + "524766003835077\n"
                                        + "75783352497314\n"
                                        + "279339636090366\n"
                                        + "374415735625254\n"
                                        + "280956513062478\n"
                                        + "494710165439429\n"
                                        + "508379047536234\n"
                                        + "280690636971471\n"
                                        + "396012124017689\n"
                                        + "248444391158398\n"
                                        + "329249791188540\n"
                                        + "216762541147551\n"
                                        + "259537664996523\n"
                                        + "113005729648331\n"
                                        + "460214823752344\n"
                                        + "30372390699746\n"
                                        + "383470652629746\n"
                                        + "56469028751500\n"
                                        + "235911537030805\n"
                                        + "395352178290627\n"
                                        + "145022639218919\n"
                                        + "36303214253904\n"
                                        + "77113739462114\n"
                                        + "332613040134789\n"
                                        + "368179871295577\n"
                                        + "54500507778458\n"
                                        + "559819181914339\n"
                                        + "359024060500704\n"
                                        + "142775441258314\n"
                                        + "555929172898758\n"
                                        + "234335170287736\n"
                                        + "432996614204002\n"
                                        + "265211936254785\n"
                                        + "219076815767968\n"
                                        + "470376747245611\n"
                                        + "195650968848679\n"
                                        + "186443234315411\n"
                                        + "531724905067097";

    public static void main(String[] args) {
        Util.time(() -> a(Input.parse(TEST_INPUT)));
        Util.time(() -> a(Input.parse(INPUT)));
        Util.time(() -> b(Input.parse(TEST_INPUT)));
        Util.time(() -> b(Input.parse(INPUT)));
    }
}
